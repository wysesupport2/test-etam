(self.webpackChunketam_prime=self.webpackChunketam_prime||[]).push([[733],{51634:(t,e,a)=>{"use strict";var i=a(54630);e.IH=function(t){for(var e=Array.isArray(t)?t:[t],a=e.length,n=i.DATETIME.slice(0),o=0;o<a;o++)for(var s=i.splitDateTime(e[o],i.TIME_SEPARATOR),l=0;l<i.DATETIME_LEN;l++)n[l]+=s[l];var r=n[0],d=n[1],h=n[2];if(h>=60){var g=h/60<<0;d+=g,h-=60*g}if(d>=60){var p=d/60<<0;r+=p,d-=60*p}return[r,d,h]},e.Bd=function(t){return i.formatDateTime(t,i.TIME_SEPARATOR)}},54630:(t,e)=>{"use strict";function a(t,e){void 0===t&&(t=""),void 0===e&&(e=2);var a=t.toString();return a.length<e&&(a=("0"+a.toString()).slice(-e)),a}Object.defineProperty(e,"__esModule",{value:!0}),e.DATETIME=[0,0,0],e.DATETIME_LEN=e.DATETIME.length,e.TIME_SEPARATOR=":",e.DATE_SEPARATOR="-",e.zeroPad=a,e.splitDateTime=function(t,a){for(var i=t.split(a),n=[],o=0;o<e.DATETIME_LEN;o++)n[o]=isNaN(parseInt(i[o],10))?0:parseInt(i[o],10);return n},e.formatDateTime=function(t,i){for(var n,o=Array.isArray(t)?t:[t],s=o.length,l=[],r=e.DATETIME.slice(0),d=0;d<s;d++)r[d]=isNaN(o[d])?0:o[d];for(d=0;d<e.DATETIME_LEN;d++)n=i===e.DATE_SEPARATOR&&0===d?4:2,l[d]=a(r[d].toString(),n);return l.join(i)},e.getDaysInMonth=function(t,e){var a=new Date(0);return a.setFullYear(t,e,0),a.setHours(0,0,0,0),a.getDate()}},53733:(t,e,a)=>{"use strict";a.r(e),a.d(e,{ReportModule:()=>Ta});var i=a(97368),n=a(39313),o=a(7436),s=a(80712),l=a(74855),r=a(37160),d=a(61116),h=a(68003),g=a(81888),p=a(35366),m=a(9017),c=a(31041),u=a(37456),Z=a(2619),T=a(16304),f=a(23651),A=a(52279),y=a.n(A),D=a(22501),x=a.n(D);let b=(()=>{class t{constructor(t,e){this.report=t,this.datepipe=e}ngOnInit(){}deptReport(){var t=this;return(0,T.Z)(function*(){var e=yield t.report.getDepartmentList().toPromise();if(null==e.data)return t.downloaddata=[],void t.downloadPDF("nodata","head");e=e.data,t.downloaddata=[];for(let a=0;a<e.length;a++)t.downloaddata.push([a+1,e[a].DeptId,e[a].DeptName]);t.downloadPDF("department-list",[["Sr.No","Department Id","Department Name"]])})()}subdeptReport(){var t=this;return(0,T.Z)(function*(){var e=yield t.report.getSubDepartmentList().toPromise();if(null==e.data)return t.downloaddata=[],void t.downloadPDF("nodata","head");e=e.data,t.downloaddata=[];for(let a=0;a<e.length;a++)t.downloaddata.push([a+1,e[a].SubDeptId,e[a].SubDeptName]);t.downloadPDF("sub_department-list",[["Sr.No","Sub-Department Id","Sub-Department Name"]])})()}desgReport(){var t=this;return(0,T.Z)(function*(){var e=yield t.report.getDesignationList().toPromise();if(null==e.data)return t.downloaddata=[],void t.downloadPDF("nodata","head");e=e.data,t.downloaddata=[];for(let a=0;a<e.length;a++)t.downloaddata.push([a+1,e[a].DesignId,e[a].DesignName]);t.downloadPDF("designation-list",[["Sr.No","Designation Id","Designation Name"]])})()}emptypeReport(){var t=this;return(0,T.Z)(function*(){var e=yield t.report.getEmployeeTypeList().toPromise();if(null==e.data)return t.downloaddata=[],void t.downloadPDF("nodata","head");e=e.data,t.downloaddata=[];for(let a=0;a<e.length;a++)t.downloaddata.push([a+1,e[a].EmpTypeId,e[a].EmpType]);t.downloadPDF("employeetype-list",[["Sr.No","Employee Type Id","Employee Type"]])})()}shiftReport(){var t=this;return(0,T.Z)(function*(){var e=yield t.report.getShiftList().toPromise();if(null==e.data)return t.downloaddata=[],void t.downloadPDF("nodata","head");e=e.data,t.downloaddata=[];for(let a=0;a<e.length;a++)t.downloaddata.push([a+1,e[a].ShiftId,e[a].ShiftDesc]);t.downloadPDF("shift-list",[["Sr.No","Shift Id","Shift Description"]])})()}policyReport(){var t=this;this.report.getOffPolicyList().subscribe(function(){var e=(0,T.Z)(function*(e){let a=yield e;if(null==a.data||0==a.data.length)return t.downloaddata=[],void t.downloadPDF("nodata","head");a=a.data,t.downloaddata=[];for(let i=0;i<a.length;i++)t.downloaddata.push([i+1,a[i].PolicyId,a[i].PolicyDesc]);t.downloadPDF("policy-list",[["Sr.No","Policy Id","Policy Description"]])});return function(t){return e.apply(this,arguments)}}())}downloadPDF(t,e){if("nodata"==t)return void x().fire({title:"Message!",text:"There is no data to download",icon:"info",confirmButtonText:"OK"});var a=new f.jsPDF("p","pt","a4");const i=this.datepipe.transform(new Date,"d MMM y, h:mm:ss a");this.datepipe.transform(new Date,"dd/MM/yyyy-h:mm:ss a");var n=a.internal.pageSize.width||a.internal.pageSize.getWidth();a.setFontSize(10),a.text(t.split("-")[0].toUpperCase()+" REPORT",n/2,20,{align:"center"}),a.text(this.report.getLocalStorage().ClientName,n/2,30,{align:"center"}),a.text("Client ID : "+this.report.getCid(),20,30,{align:"left"}),a.text(""+i,n-20,30,{align:"right"});const o=this.downloaddata;y()(a,{startY:50,styles:{cellPadding:2,fontSize:10,valign:"middle",halign:"center"},theme:"striped",head:e,body:o,headStyles:{fillColor:[255,0,0],textColor:[0,0,0],fontSize:11,cellPadding:5}}),a.save(t+".pdf"),this.report.insertLog("Report/Master-"+t)}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(m.v),p.Y36(d.uU))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-master-reports"]],decls:68,vars:0,consts:[[1,"card-deck"],["mdbWavesEffect","",1,"view","overlay","waves-light"],[1,"mask","rgba-white-slight"],["mdbBtn","","appHeading","","mdbWavesEffect","",3,"click"],["fas","","icon","download"],["mdbWavesEffect","",1,"view","rgba-white-slight","waves-light"],[1,"mask"],[1,"card-deck","mt-2"]],template:function(t,e){1&t&&(p.TgZ(0,"div",0),p.TgZ(1,"mdb-card"),p.TgZ(2,"div",1),p.TgZ(3,"a"),p._UZ(4,"div",2),p.qZA(),p.qZA(),p.TgZ(5,"mdb-card-body"),p.TgZ(6,"mdb-card-title"),p.TgZ(7,"h4"),p._uU(8,"Department List"),p.qZA(),p.qZA(),p.TgZ(9,"a",3),p.NdJ("click",function(){return e.deptReport()}),p._uU(10,"Download Report "),p._UZ(11,"mdb-icon",4),p.qZA(),p.qZA(),p.qZA(),p.TgZ(12,"mdb-card"),p.TgZ(13,"div",5),p.TgZ(14,"a"),p._UZ(15,"div",6),p.qZA(),p.qZA(),p.TgZ(16,"mdb-card-body"),p.TgZ(17,"mdb-card-title"),p.TgZ(18,"h4"),p._uU(19,"Sub-Department List"),p.qZA(),p.qZA(),p.TgZ(20,"a",3),p.NdJ("click",function(){return e.subdeptReport()}),p._uU(21,"Download Report "),p._UZ(22,"mdb-icon",4),p.qZA(),p.qZA(),p.qZA(),p.TgZ(23,"mdb-card"),p.TgZ(24,"div",5),p.TgZ(25,"a"),p._UZ(26,"div",6),p.qZA(),p.qZA(),p.TgZ(27,"mdb-card-body"),p.TgZ(28,"mdb-card-title"),p.TgZ(29,"h4"),p._uU(30,"Designation List"),p.qZA(),p.qZA(),p.TgZ(31,"a",3),p.NdJ("click",function(){return e.desgReport()}),p._uU(32,"Download Report "),p._UZ(33,"mdb-icon",4),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(34,"div",7),p.TgZ(35,"mdb-card"),p.TgZ(36,"div",1),p.TgZ(37,"a"),p._UZ(38,"div",2),p.qZA(),p.qZA(),p.TgZ(39,"mdb-card-body"),p.TgZ(40,"mdb-card-title"),p.TgZ(41,"h4"),p._uU(42,"Employee Type List"),p.qZA(),p.qZA(),p.TgZ(43,"a",3),p.NdJ("click",function(){return e.emptypeReport()}),p._uU(44,"Download Report "),p._UZ(45,"mdb-icon",4),p.qZA(),p.qZA(),p.qZA(),p.TgZ(46,"mdb-card"),p.TgZ(47,"div",5),p.TgZ(48,"a"),p._UZ(49,"div",6),p.qZA(),p.qZA(),p.TgZ(50,"mdb-card-body"),p.TgZ(51,"mdb-card-title"),p.TgZ(52,"h4"),p._uU(53,"Shift List"),p.qZA(),p.qZA(),p.TgZ(54,"a",3),p.NdJ("click",function(){return e.shiftReport()}),p._uU(55,"Download Report "),p._UZ(56,"mdb-icon",4),p.qZA(),p.qZA(),p.qZA(),p.TgZ(57,"mdb-card"),p.TgZ(58,"div",5),p.TgZ(59,"a"),p._UZ(60,"div",6),p.qZA(),p.qZA(),p.TgZ(61,"mdb-card-body"),p.TgZ(62,"mdb-card-title"),p.TgZ(63,"h4"),p._uU(64,"Policy List"),p.qZA(),p.qZA(),p.TgZ(65,"a",3),p.NdJ("click",function(){return e.policyReport()}),p._uU(66,"Download Report "),p._UZ(67,"mdb-icon",4),p.qZA(),p.qZA(),p.qZA(),p.qZA())},directives:[Z.n3,Z.b6,Z.KS,Z.gR,Z.mT,u.d,Z.Ui,Z.XI],styles:[""]}),t})();var q=a(62707),w=a(82051),v=a(3492),_=a(82608),M=a(91709),R=a(92871),E=a(58150),C=a(95193),S=a(7627);const I=["component1"];function N(t,e){if(1&t&&(p.TgZ(0,"option",19),p._uU(1),p.qZA()),2&t){const t=e.$implicit;p.Q6J("value",t),p.xp6(1),p.Oqu(t)}}function U(t,e){1&t&&(p.TgZ(0,"small",20),p._uU(1,"Please select Report "),p.qZA())}function F(t,e){1&t&&(p.TgZ(0,"small",20),p._uU(1,"Please select date range "),p.qZA())}function P(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div",3),p.TgZ(1,"label",21),p._uU(2,"Select Date Range"),p.TgZ(3,"sup",5),p._uU(4,"*"),p.qZA(),p.qZA(),p.TgZ(5,"div",6),p.TgZ(6,"input",22),p.NdJ("ngModelChange",function(e){return p.CHM(t),p.oxw().daterange=e})("bsValueChange",function(e){return p.CHM(t),p.oxw().onValueChange(e)}),p.qZA(),p.YNc(7,F,2,0,"small",10),p.qZA(),p.qZA()}if(2&t){const t=p.oxw();p.xp6(6),p.Q6J("ngModel",t.daterange)("maxDate",t.maxDateValue)("bsConfig",t.daterangeConfig),p.xp6(1),p.Q6J("ngIf",t.dateerror)}}function O(t,e){1&t&&(p.TgZ(0,"small",20),p._uU(1,"Please select date "),p.qZA())}function L(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div",3),p.TgZ(1,"label",23),p._uU(2," Date "),p.TgZ(3,"sup",5),p._uU(4,"*"),p.qZA(),p.qZA(),p.TgZ(5,"div",6),p.TgZ(6,"input",24),p.NdJ("ngModelChange",function(e){return p.CHM(t),p.oxw()._date=e}),p.qZA(),p.YNc(7,O,2,0,"small",10),p.qZA(),p.qZA()}if(2&t){const t=p.oxw();p.xp6(6),p.Q6J("ngModel",t._date),p.xp6(1),p.Q6J("ngIf",t.date1error)}}function J(t,e){1&t&&(p.TgZ(0,"small",20),p._uU(1,"Please select date "),p.qZA())}function z(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div",3),p.TgZ(1,"label",23),p._uU(2," Time "),p.TgZ(3,"sup",5),p._uU(4,"*"),p.qZA(),p.qZA(),p.TgZ(5,"div",6),p.TgZ(6,"p-calendar",25),p.NdJ("ngModelChange",function(e){return p.CHM(t),p.oxw().time=e}),p.qZA(),p.YNc(7,J,2,0,"small",10),p.qZA(),p.qZA()}if(2&t){const t=p.oxw();p.xp6(6),p.Q6J("ngModel",t.time)("timeOnly",!0),p.xp6(1),p.Q6J("ngIf",t.date1error)}}function Y(t,e){1&t&&(p.TgZ(0,"div",3),p.TgZ(1,"label",26),p._uU(2,"Select Time for Head Count"),p.qZA(),p.TgZ(3,"div",27),p._UZ(4,"input",28),p.qZA(),p.qZA())}function Q(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div",3),p.TgZ(1,"label",29),p._uU(2,"Contractor Name "),p.qZA(),p.TgZ(3,"div",6),p.TgZ(4,"p-multiSelect",30),p.NdJ("ngModelChange",function(e){return p.CHM(t),p.oxw().contractorname=e})("onChange",function(){return p.CHM(t),p.oxw().contractorSelection()}),p.qZA(),p.qZA(),p.qZA()}if(2&t){const t=p.oxw();p.xp6(4),p.Q6J("options",t.contractor_list)("ngModel",t.contractorname)}}function H(t,e){1&t&&(p.TgZ(0,"small",20),p._uU(1,"Please select Department "),p.qZA())}function k(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div",3),p.TgZ(1,"label",31),p._uU(2,"Department "),p.TgZ(3,"sup",5),p._uU(4,"*"),p.qZA(),p.qZA(),p.TgZ(5,"div",6),p.TgZ(6,"p-multiSelect",32),p.NdJ("ngModelChange",function(e){return p.CHM(t),p.oxw().deptname=e})("onChange",function(){return p.CHM(t),p.oxw().showEmployeeByDept()}),p.qZA(),p.YNc(7,H,2,0,"small",10),p.qZA(),p.qZA()}if(2&t){const t=p.oxw();p.xp6(6),p.Q6J("options",t.dept_list)("ngModel",t.deptname),p.xp6(1),p.Q6J("ngIf",t.nameerror)}}function W(t,e){if(1&t&&(p.TgZ(0,"option",19),p._uU(1),p.qZA()),2&t){const t=e.$implicit;p.Q6J("value",t.DesignName),p.xp6(1),p.hij("",t.DesignName," ")}}function j(t,e){1&t&&(p.TgZ(0,"small",20),p._uU(1,"Please select Designation "),p.qZA())}function $(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div",3),p.TgZ(1,"label",33),p._uU(2,"Designation"),p.qZA(),p.TgZ(3,"div",6),p.TgZ(4,"select",34),p.NdJ("ngModelChange",function(e){return p.CHM(t),p.oxw().designname=e})("change",function(){return p.CHM(t),p.oxw().showEmployeeByDesg()}),p.TgZ(5,"option",35),p._uU(6,"--Select Designation--"),p.qZA(),p.YNc(7,W,2,2,"option",9),p.qZA(),p.YNc(8,j,2,0,"small",10),p.qZA(),p.qZA()}if(2&t){const t=p.oxw();p.xp6(4),p.Q6J("ngModel",t.designname),p.xp6(3),p.Q6J("ngForOf",t.desig_list),p.xp6(1),p.Q6J("ngIf",t.name1error)}}function B(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div",3),p.TgZ(1,"label",36),p._uU(2,"Include Hanging In/Out Punches "),p.qZA(),p.TgZ(3,"div",6),p.TgZ(4,"div",37),p.TgZ(5,"p-checkbox",38),p.NdJ("ngModelChange",function(e){return p.CHM(t),p.oxw().hangingPunch=e}),p.qZA(),p.qZA(),p.qZA(),p.qZA()}if(2&t){const t=p.oxw();p.xp6(5),p.Q6J("ngModel",t.hangingPunch)("binary",!0)}}function V(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",62),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).$implicit;p.xp6(2),p.Oqu(t.Type)}}function G(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",63),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).$implicit;p.xp6(2),p.Oqu(t.Type)}}function X(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",64),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).$implicit;p.xp6(2),p.Oqu(t.Type)}}function K(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",65),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).$implicit;p.xp6(2),p.Oqu(t.Type)}}function tt(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",66),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).$implicit;p.xp6(2),p.Oqu(t.Type)}}function et(t,e){if(1&t&&(p.TgZ(0,"mdb-card",54),p.TgZ(1,"mdb-card-body",55),p.TgZ(2,"mdb-card-title",56),p.TgZ(3,"b"),p._uU(4),p.qZA(),p.qZA(),p.TgZ(5,"mdb-card-text"),p.TgZ(6,"div",57),p._uU(7),p.qZA(),p.TgZ(8,"div",58),p._uU(9),p.qZA(),p.TgZ(10,"div",59),p._uU(11),p.qZA(),p.TgZ(12,"div",60),p.TgZ(13,"div",44),p.YNc(14,V,3,1,"div",45),p.YNc(15,G,3,1,"div",45),p.YNc(16,X,3,1,"div",45),p.YNc(17,K,3,1,"div",45),p.YNc(18,tt,3,1,"div",61),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&t){const t=p.oxw().$implicit;p.Q6J("mdbTooltip",t.InPunchDay),p.xp6(4),p.Oqu(t.InPunchDate),p.xp6(3),p.Oqu(t.InPunchTime),p.xp6(2),p.hij(" ",t.OutPunchTime,""),p.xp6(2),p.hij(" ",t.DayTotal,""),p.xp6(2),p.Q6J("ngSwitch",t.Type),p.xp6(1),p.Q6J("ngSwitchCase","A"),p.xp6(1),p.Q6J("ngSwitchCase","P"),p.xp6(1),p.Q6J("ngSwitchCase","P*"),p.xp6(1),p.Q6J("ngSwitchCase","L")}}function at(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",62),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).$implicit;p.xp6(2),p.Oqu(t.Type)}}function it(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",63),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).$implicit;p.xp6(2),p.Oqu(t.Type)}}function nt(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",64),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).$implicit;p.xp6(2),p.Oqu(t.Type)}}function ot(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",65),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).$implicit;p.xp6(2),p.Oqu(t.Type)}}function st(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",66),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).$implicit;p.xp6(2),p.Oqu(t.Type)}}function lt(t,e){if(1&t&&(p.TgZ(0,"mdb-card",67),p.TgZ(1,"mdb-card-body",55),p.TgZ(2,"mdb-card-title",56),p.TgZ(3,"b"),p._uU(4),p.qZA(),p.qZA(),p.TgZ(5,"mdb-card-text"),p.TgZ(6,"div",57),p._uU(7),p.qZA(),p.TgZ(8,"div",58),p._uU(9),p.qZA(),p.TgZ(10,"div",59),p._uU(11),p.qZA(),p.TgZ(12,"div",60),p.TgZ(13,"div",44),p.YNc(14,at,3,1,"div",45),p.YNc(15,it,3,1,"div",45),p.YNc(16,nt,3,1,"div",45),p.YNc(17,ot,3,1,"div",45),p.YNc(18,st,3,1,"div",61),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&t){const t=p.oxw().$implicit;p.Q6J("mdbTooltip",t.InPunchDay),p.xp6(4),p.Oqu(t.InPunchDate),p.xp6(3),p.Oqu(t.InPunchTime),p.xp6(2),p.hij(" ",t.OutPunchTime,""),p.xp6(2),p.hij(" ",t.DayTotal," "),p.xp6(2),p.Q6J("ngSwitch",t.Type),p.xp6(1),p.Q6J("ngSwitchCase","A"),p.xp6(1),p.Q6J("ngSwitchCase","P"),p.xp6(1),p.Q6J("ngSwitchCase","P*"),p.xp6(1),p.Q6J("ngSwitchCase","L")}}function rt(t,e){if(1&t&&(p.TgZ(0,"div",51),p.YNc(1,et,19,10,"mdb-card",52),p.YNc(2,lt,19,10,"ng-template",null,53,p.W1O),p.qZA()),2&t){const t=e.$implicit,a=p.MAs(3);p.xp6(1),p.Q6J("ngIf","W"==t.Type)("ngIfElse",a)}}function dt(t,e){if(1&t&&(p.TgZ(0,"div"),p._UZ(1,"hr",48),p.TgZ(2,"div",1),p.TgZ(3,"div",40),p.TgZ(4,"b"),p._uU(5,"ID : "),p.qZA(),p._uU(6),p.qZA(),p.TgZ(7,"div",40),p.TgZ(8,"b"),p._uU(9,"NAME : "),p.qZA(),p._uU(10),p.qZA(),p.TgZ(11,"div",40),p.TgZ(12,"b"),p._uU(13,"DEPARTMENT : "),p.qZA(),p._uU(14),p.qZA(),p.TgZ(15,"div",40),p.TgZ(16,"b"),p._uU(17,"DESIGNATION : "),p.qZA(),p._uU(18),p.qZA(),p.qZA(),p._UZ(19,"hr"),p.TgZ(20,"div",49),p.YNc(21,rt,4,2,"div",50),p.qZA(),p.qZA()),2&t){const t=e.$implicit;p.xp6(6),p.Oqu(t.Id),p.xp6(4),p.Oqu(t.name),p.xp6(4),p.Oqu(t.Dept),p.xp6(4),p.Oqu(t.Desig),p.xp6(3),p.Q6J("ngForOf",t.info)}}const ht=function(){return[25,50]};function gt(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div"),p.YNc(1,dt,22,5,"div",46),p.TgZ(2,"div"),p.TgZ(3,"mat-paginator",47),p.NdJ("page",function(e){p.CHM(t);const a=p.oxw(2);return a.OnPageChange(e,a.attendanceData)}),p.qZA(),p.qZA(),p.qZA()}if(2&t){const t=p.oxw(2);p.xp6(1),p.Q6J("ngForOf",t.pageSlice),p.xp6(2),p.Q6J("length",t.attendanceData.length)("pageSize",50)("pageSizeOptions",p.DdM(4,ht))}}function pt(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",62),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).index,e=p.oxw().$implicit;p.xp6(2),p.Oqu(e.status[t])}}function mt(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",63),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).index,e=p.oxw().$implicit;p.xp6(2),p.hij("",e.status[t]," ")}}function ct(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",64),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).index,e=p.oxw().$implicit;p.xp6(2),p.hij("",e.status[t]," ")}}function ut(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",65),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).index,e=p.oxw().$implicit;p.xp6(2),p.hij("",e.status[t]," ")}}function Zt(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",66),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).index,e=p.oxw().$implicit;p.xp6(2),p.hij("",e.status[t]," ")}}function Tt(t,e){if(1&t&&(p.TgZ(0,"mdb-card",54),p.TgZ(1,"mdb-card-body",55),p.TgZ(2,"mdb-card-title",56),p.TgZ(3,"b"),p._uU(4),p.qZA(),p.qZA(),p.TgZ(5,"mdb-card-text"),p.TgZ(6,"div",57),p._uU(7),p.qZA(),p.TgZ(8,"div",58),p._uU(9),p.qZA(),p.TgZ(10,"div",59),p._uU(11),p.qZA(),p.TgZ(12,"div",60),p.TgZ(13,"div",44),p.YNc(14,pt,3,1,"div",45),p.YNc(15,mt,3,1,"div",45),p.YNc(16,ct,3,1,"div",45),p.YNc(17,ut,3,1,"div",45),p.YNc(18,Zt,3,1,"div",61),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&t){const t=p.oxw().index,e=p.oxw().$implicit,a=p.oxw(3);p.Q6J("mdbTooltip",e.weekday[t]),p.xp6(4),p.Oqu(a.summaryDateArray[t]),p.xp6(3),p.Oqu(""==e.intime[t]?"?":e.intime[t]),p.xp6(2),p.hij(" ",e.outtime[t],""),p.xp6(2),p.hij(" ",e.total[t]," "),p.xp6(2),p.Q6J("ngSwitch",e.status[t]),p.xp6(1),p.Q6J("ngSwitchCase","A"),p.xp6(1),p.Q6J("ngSwitchCase","P"),p.xp6(1),p.Q6J("ngSwitchCase","P*"),p.xp6(1),p.Q6J("ngSwitchCase","L")}}function ft(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",62),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).index,e=p.oxw().$implicit;p.xp6(2),p.hij("",e.status[t]," ")}}function At(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",63),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).index,e=p.oxw().$implicit;p.xp6(2),p.hij("",e.status[t]," ")}}function yt(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",64),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).index,e=p.oxw().$implicit;p.xp6(2),p.hij("",e.status[t]," ")}}function Dt(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",65),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).index,e=p.oxw().$implicit;p.xp6(2),p.hij("",e.status[t]," ")}}function xt(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",66),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).index,e=p.oxw().$implicit;p.xp6(2),p.hij("",e.status[t]," ")}}function bt(t,e){if(1&t&&(p.TgZ(0,"mdb-card",67),p.TgZ(1,"mdb-card-body",55),p.TgZ(2,"mdb-card-title",56),p.TgZ(3,"b"),p._uU(4),p.qZA(),p.qZA(),p.TgZ(5,"mdb-card-text"),p.TgZ(6,"div",57),p._uU(7),p.qZA(),p.TgZ(8,"div",58),p._uU(9),p.qZA(),p.TgZ(10,"div",59),p._uU(11),p.qZA(),p.TgZ(12,"div",60),p.TgZ(13,"div",44),p.YNc(14,ft,3,1,"div",45),p.YNc(15,At,3,1,"div",45),p.YNc(16,yt,3,1,"div",45),p.YNc(17,Dt,3,1,"div",45),p.YNc(18,xt,3,1,"div",61),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&t){const t=p.oxw().index,e=p.oxw().$implicit,a=p.oxw(3);p.Q6J("mdbTooltip",e.weekday[t]),p.xp6(4),p.Oqu(a.summaryDateArray[t]),p.xp6(3),p.Oqu(e.intime[t]),p.xp6(2),p.hij(" ",e.outtime[t],""),p.xp6(2),p.hij(" ",e.total[t]," "),p.xp6(2),p.Q6J("ngSwitch",e.status[t]),p.xp6(1),p.Q6J("ngSwitchCase","A"),p.xp6(1),p.Q6J("ngSwitchCase","P"),p.xp6(1),p.Q6J("ngSwitchCase","P*"),p.xp6(1),p.Q6J("ngSwitchCase","L")}}function qt(t,e){if(1&t&&(p.TgZ(0,"div",51),p.YNc(1,Tt,19,10,"mdb-card",52),p.YNc(2,bt,19,10,"ng-template",null,53,p.W1O),p.qZA()),2&t){const t=e.index,a=p.MAs(3),i=p.oxw().$implicit;p.xp6(1),p.Q6J("ngIf","W"==i.status[t])("ngIfElse",a)}}function wt(t,e){if(1&t&&(p.TgZ(0,"div"),p._UZ(1,"hr",48),p.TgZ(2,"div",1),p.TgZ(3,"div",40),p.TgZ(4,"b"),p._uU(5,"ID : "),p.qZA(),p._uU(6),p.qZA(),p.TgZ(7,"div",40),p.TgZ(8,"b"),p._uU(9,"NAME : "),p.qZA(),p._uU(10),p.qZA(),p.TgZ(11,"div",40),p.TgZ(12,"b"),p._uU(13,"DEPARTMENT : "),p.qZA(),p._uU(14),p.qZA(),p.TgZ(15,"div",40),p.TgZ(16,"b"),p._uU(17,"DESIGNATION : "),p.qZA(),p._uU(18),p.qZA(),p.qZA(),p._UZ(19,"hr"),p.TgZ(20,"div",49),p.YNc(21,qt,4,2,"div",50),p.qZA(),p._UZ(22,"hr"),p.TgZ(23,"div",68),p.TgZ(24,"div",69),p._UZ(25,"p-badge",70),p.TgZ(26,"b"),p._uU(27),p.qZA(),p._uU(28," Hrs "),p.qZA(),p.TgZ(29,"div",69),p._UZ(30,"p-badge",71),p.TgZ(31,"b"),p._uU(32),p.qZA(),p.qZA(),p.TgZ(33,"div",69),p._UZ(34,"p-badge",72),p.TgZ(35,"b"),p._uU(36),p.qZA(),p.qZA(),p.TgZ(37,"div",69),p._UZ(38,"p-badge",73),p.TgZ(39,"b"),p._uU(40),p.qZA(),p.qZA(),p.TgZ(41,"div",69),p._UZ(42,"p-badge",74),p.TgZ(43,"b"),p._uU(44),p.qZA(),p.qZA(),p.TgZ(45,"div",69),p._UZ(46,"p-badge",75),p.TgZ(47,"b"),p._uU(48),p.qZA(),p.qZA(),p.TgZ(49,"div",69),p._UZ(50,"p-badge",76),p.TgZ(51,"b"),p._uU(52),p.qZA(),p.qZA(),p.TgZ(53,"div",69),p._UZ(54,"p-badge",77),p.TgZ(55,"b"),p._uU(56),p.qZA(),p.qZA(),p.TgZ(57,"div",69),p._UZ(58,"p-badge",78),p.TgZ(59,"b"),p._uU(60),p.qZA(),p.qZA(),p.TgZ(61,"div",69),p._UZ(62,"p-badge",79),p.TgZ(63,"b"),p._uU(64),p.qZA(),p.qZA(),p.TgZ(65,"div",69),p._UZ(66,"p-badge",80),p.TgZ(67,"b"),p._uU(68),p.qZA(),p.qZA(),p.TgZ(69,"div",69),p._UZ(70,"p-badge",81),p.TgZ(71,"b"),p._uU(72),p.qZA(),p.qZA(),p.TgZ(73,"div",69),p._UZ(74,"p-badge",82),p.TgZ(75,"b"),p._uU(76),p.qZA(),p.qZA(),p.TgZ(77,"div",69),p._UZ(78,"p-badge",83),p.TgZ(79,"b"),p._uU(80),p.qZA(),p.qZA(),p.TgZ(81,"div",69),p._UZ(82,"p-badge",84),p.TgZ(83,"b"),p._uU(84),p.qZA(),p.qZA(),p.TgZ(85,"div",69),p._UZ(86,"p-badge",85),p.TgZ(87,"b"),p._uU(88),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&t){const t=e.$implicit,a=p.oxw(3);p.xp6(6),p.Oqu(t.id),p.xp6(4),p.Oqu(t.name),p.xp6(4),p.Oqu(t.dept),p.xp6(4),p.Oqu(t.desig),p.xp6(3),p.Q6J("ngForOf",a.counter(a.selectedDays+1)),p.xp6(6),p.hij(" : ",t.totalmformonth,""),p.xp6(5),p.hij(" : ",t.present,""),p.xp6(4),p.hij(" : ",t.absent,""),p.xp6(4),p.hij(" : ",t.holiday,""),p.xp6(4),p.hij(" : ",t.weeklyof,""),p.xp6(4),p.hij(" : ",t.Pendingoff,""),p.xp6(4),p.hij(" : ",t.Nightoff,""),p.xp6(4),p.hij(" : ",t.Valleyoff,""),p.xp6(4),p.hij(" : ",t.leave,""),p.xp6(4),p.hij(" : ",t.LWP,""),p.xp6(4),p.hij(" : ",t.tour,""),p.xp6(4),p.hij(" : ",t.halfDay,""),p.xp6(4),p.hij(" : ",t.late,""),p.xp6(4),p.hij(" : ",t.early,""),p.xp6(4),p.hij(" : ",t.erdays,""),p.xp6(4),p.hij(" : ",t.ltdays,"")}}function vt(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div"),p.YNc(1,wt,89,21,"div",46),p.TgZ(2,"div"),p.TgZ(3,"mat-paginator",47),p.NdJ("page",function(e){p.CHM(t);const a=p.oxw(2);return a.OnPageChange(e,a.summarydata)}),p.qZA(),p.qZA(),p.qZA()}if(2&t){const t=p.oxw(2);p.xp6(1),p.Q6J("ngForOf",t.pageSlice),p.xp6(2),p.Q6J("length",t.summarydata.length)("pageSize",50)("pageSizeOptions",p.DdM(4,ht))}}function _t(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",62),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).index,e=p.oxw().$implicit;p.xp6(2),p.Oqu(e.status[t])}}function Mt(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",63),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).index,e=p.oxw().$implicit;p.xp6(2),p.hij("",e.status[t]," ")}}function Rt(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",64),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).index,e=p.oxw().$implicit;p.xp6(2),p.hij("",e.status[t]," ")}}function Et(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",65),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).index,e=p.oxw().$implicit;p.xp6(2),p.hij("",e.status[t]," ")}}function Ct(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",66),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).index,e=p.oxw().$implicit;p.xp6(2),p.hij("",e.status[t]," ")}}function St(t,e){if(1&t&&(p.TgZ(0,"mdb-card",87),p.TgZ(1,"mdb-card-body",88),p.TgZ(2,"mdb-card-title",56),p.TgZ(3,"b"),p._uU(4),p.qZA(),p.qZA(),p.TgZ(5,"mdb-card-text"),p.TgZ(6,"div",60),p.TgZ(7,"div",44),p.YNc(8,_t,3,1,"div",45),p.YNc(9,Mt,3,1,"div",45),p.YNc(10,Rt,3,1,"div",45),p.YNc(11,Et,3,1,"div",45),p.YNc(12,Ct,3,1,"div",61),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&t){const t=p.oxw().index,e=p.oxw().$implicit,a=p.oxw(3);p.xp6(4),p.Oqu(a.summaryDateArray[t]),p.xp6(3),p.Q6J("ngSwitch",e.status[t]),p.xp6(1),p.Q6J("ngSwitchCase","A"),p.xp6(1),p.Q6J("ngSwitchCase","P"),p.xp6(1),p.Q6J("ngSwitchCase","P*"),p.xp6(1),p.Q6J("ngSwitchCase","L")}}function It(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",62),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).index,e=p.oxw().$implicit;p.xp6(2),p.hij("",e.status[t]," ")}}function Nt(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",63),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).index,e=p.oxw().$implicit;p.xp6(2),p.hij("",e.status[t]," ")}}function Ut(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",64),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).index,e=p.oxw().$implicit;p.xp6(2),p.hij("",e.status[t]," ")}}function Ft(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",65),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).index,e=p.oxw().$implicit;p.xp6(2),p.hij("",e.status[t]," ")}}function Pt(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",66),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).index,e=p.oxw().$implicit;p.xp6(2),p.hij("",e.status[t]," ")}}function Ot(t,e){if(1&t&&(p.TgZ(0,"mdb-card"),p.TgZ(1,"mdb-card-body",88),p.TgZ(2,"mdb-card-title",56),p.TgZ(3,"b"),p._uU(4),p.qZA(),p.qZA(),p.TgZ(5,"mdb-card-text"),p.TgZ(6,"div",60),p.TgZ(7,"div",44),p.YNc(8,It,3,1,"div",45),p.YNc(9,Nt,3,1,"div",45),p.YNc(10,Ut,3,1,"div",45),p.YNc(11,Ft,3,1,"div",45),p.YNc(12,Pt,3,1,"div",61),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&t){const t=p.oxw().index,e=p.oxw().$implicit,a=p.oxw(3);p.xp6(4),p.Oqu(a.summaryDateArray[t]),p.xp6(3),p.Q6J("ngSwitch",e.status[t]),p.xp6(1),p.Q6J("ngSwitchCase","A"),p.xp6(1),p.Q6J("ngSwitchCase","P"),p.xp6(1),p.Q6J("ngSwitchCase","P*"),p.xp6(1),p.Q6J("ngSwitchCase","L")}}function Lt(t,e){if(1&t&&(p.TgZ(0,"div",51),p.YNc(1,St,13,6,"mdb-card",86),p.YNc(2,Ot,13,6,"ng-template",null,53,p.W1O),p.qZA()),2&t){const t=e.index,a=p.MAs(3),i=p.oxw().$implicit;p.xp6(1),p.Q6J("ngIf","W"==i.status[t])("ngIfElse",a)}}function Jt(t,e){if(1&t&&(p.TgZ(0,"div"),p._UZ(1,"hr",48),p.TgZ(2,"div",1),p.TgZ(3,"div",40),p.TgZ(4,"b"),p._uU(5,"ID : "),p.qZA(),p._uU(6),p.qZA(),p.TgZ(7,"div",40),p.TgZ(8,"b"),p._uU(9,"NAME : "),p.qZA(),p._uU(10),p.qZA(),p.TgZ(11,"div",40),p.TgZ(12,"b"),p._uU(13,"DEPARTMENT : "),p.qZA(),p._uU(14),p.qZA(),p.TgZ(15,"div",40),p.TgZ(16,"b"),p._uU(17,"DESIGNATION : "),p.qZA(),p._uU(18),p.qZA(),p.qZA(),p._UZ(19,"hr"),p.TgZ(20,"div",49),p.YNc(21,Lt,4,2,"div",50),p.qZA(),p._UZ(22,"hr"),p.TgZ(23,"div",68),p.TgZ(24,"div",69),p._UZ(25,"p-badge",71),p.TgZ(26,"b"),p._uU(27),p.qZA(),p.qZA(),p.TgZ(28,"div",69),p._UZ(29,"p-badge",72),p.TgZ(30,"b"),p._uU(31),p.qZA(),p.qZA(),p.TgZ(32,"div",69),p._UZ(33,"p-badge",73),p.TgZ(34,"b"),p._uU(35),p.qZA(),p.qZA(),p.TgZ(36,"div",69),p._UZ(37,"p-badge",74),p.TgZ(38,"b"),p._uU(39),p.qZA(),p.qZA(),p.TgZ(40,"div",69),p._UZ(41,"p-badge",75),p.TgZ(42,"b"),p._uU(43),p.qZA(),p.qZA(),p.TgZ(44,"div",69),p._UZ(45,"p-badge",76),p.TgZ(46,"b"),p._uU(47),p.qZA(),p.qZA(),p.TgZ(48,"div",69),p._UZ(49,"p-badge",77),p.TgZ(50,"b"),p._uU(51),p.qZA(),p.qZA(),p.TgZ(52,"div",69),p._UZ(53,"p-badge",78),p.TgZ(54,"b"),p._uU(55),p.qZA(),p.qZA(),p.TgZ(56,"div",69),p._UZ(57,"p-badge",79),p.TgZ(58,"b"),p._uU(59),p.qZA(),p.qZA(),p.TgZ(60,"div",69),p._UZ(61,"p-badge",80),p.TgZ(62,"b"),p._uU(63),p.qZA(),p.qZA(),p.TgZ(64,"div",69),p._UZ(65,"p-badge",81),p.TgZ(66,"b"),p._uU(67),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&t){const t=e.$implicit,a=p.oxw(3);p.xp6(6),p.Oqu(t.id),p.xp6(4),p.Oqu(t.name),p.xp6(4),p.Oqu(t.dept),p.xp6(4),p.Oqu(t.desig),p.xp6(3),p.Q6J("ngForOf",a.counter(a.selectedDays+1)),p.xp6(6),p.hij(" : ",t.present,""),p.xp6(4),p.hij(" : ",t.absent,""),p.xp6(4),p.hij(" : ",t.holiday,""),p.xp6(4),p.hij(" : ",t.weeklyof,""),p.xp6(4),p.hij(" : ",t.Pendingoff,""),p.xp6(4),p.hij(" : ",t.Nightoff,""),p.xp6(4),p.hij(" : ",t.Valleyoff,""),p.xp6(4),p.hij(" : ",t.leave,""),p.xp6(4),p.hij(" : ",t.LWP,""),p.xp6(4),p.hij(" : ",t.tour,""),p.xp6(4),p.hij(" : ",t.halfDay,"")}}function zt(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div"),p.YNc(1,Jt,68,16,"div",46),p.TgZ(2,"div"),p.TgZ(3,"mat-paginator",47),p.NdJ("page",function(e){p.CHM(t);const a=p.oxw(2);return a.OnPageChange(e,a.musterData)}),p.qZA(),p.qZA(),p.qZA()}if(2&t){const t=p.oxw(2);p.xp6(1),p.Q6J("ngForOf",t.pageSlice),p.xp6(2),p.Q6J("length",t.musterData.length)("pageSize",50)("pageSizeOptions",p.DdM(4,ht))}}function Yt(t,e){if(1&t&&(p.TgZ(0,"tr"),p.TgZ(1,"td"),p._uU(2),p.qZA(),p.TgZ(3,"td"),p._uU(4),p.qZA(),p.TgZ(5,"td"),p._uU(6),p.qZA(),p.TgZ(7,"td"),p._uU(8),p.qZA(),p.TgZ(9,"td"),p._uU(10),p.qZA(),p.TgZ(11,"td"),p._uU(12),p.qZA(),p.TgZ(13,"td"),p._uU(14,"ABSENT"),p.qZA(),p.qZA()),2&t){const t=e.$implicit;p.xp6(2),p.Oqu(t.id),p.xp6(2),p.Oqu(t.name),p.xp6(2),p.Oqu(t.Alfanumeric),p.xp6(2),p.Oqu(t.Dept),p.xp6(2),p.Oqu(t.Desig),p.xp6(2),p.Oqu(t.RealDate)}}function Qt(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div"),p.TgZ(1,"div",89),p.TgZ(2,"table",90),p.TgZ(3,"thead"),p.TgZ(4,"tr"),p.TgZ(5,"th"),p._uU(6,"ID"),p.qZA(),p.TgZ(7,"th"),p._uU(8,"NAME"),p.qZA(),p.TgZ(9,"th"),p._uU(10,"ALPHA-NUMERIC"),p.qZA(),p.TgZ(11,"th"),p._uU(12,"DEPARTMENT"),p.qZA(),p.TgZ(13,"th"),p._uU(14,"DESIGNATION"),p.qZA(),p.TgZ(15,"th"),p._uU(16,"DATE"),p.qZA(),p.TgZ(17,"th"),p._uU(18,"ABSENT"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(19,"tbody"),p.YNc(20,Yt,15,6,"tr",46),p.qZA(),p.qZA(),p.TgZ(21,"div"),p.TgZ(22,"mat-paginator",47),p.NdJ("page",function(e){p.CHM(t);const a=p.oxw(2);return a.OnPageChange(e,a.absentData)}),p.qZA(),p.qZA(),p.qZA(),p.qZA()}if(2&t){const t=p.oxw(2);p.xp6(20),p.Q6J("ngForOf",t.pageSlice),p.xp6(2),p.Q6J("length",t.absentData.length)("pageSize",50)("pageSizeOptions",p.DdM(4,ht))}}function Ht(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",62),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).$implicit;p.xp6(2),p.Oqu(t.Status)}}function kt(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",63),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).$implicit;p.xp6(2),p.Oqu(t.Status)}}function Wt(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",64),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).$implicit;p.xp6(2),p.Oqu(t.Status)}}function jt(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",66),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).$implicit,e=p.oxw(4);p.xp6(2),p.Oqu(e.getValue(t.Status))}}function $t(t,e){if(1&t&&(p.TgZ(0,"mdb-card",87),p.TgZ(1,"mdb-card-body",91),p.TgZ(2,"mdb-card-title",56),p.TgZ(3,"b"),p._uU(4),p.qZA(),p.qZA(),p.TgZ(5,"mdb-card-text"),p.TgZ(6,"div",57),p._uU(7),p.qZA(),p.TgZ(8,"div",58),p._uU(9),p.qZA(),p.TgZ(10,"div",59),p._uU(11),p.qZA(),p.TgZ(12,"div",92),p._uU(13),p.qZA(),p.TgZ(14,"div",93),p._uU(15),p.qZA(),p.TgZ(16,"div",44),p.YNc(17,Ht,3,1,"div",45),p.YNc(18,kt,3,1,"div",45),p.YNc(19,Wt,3,1,"div",45),p.YNc(20,jt,3,1,"div",61),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&t){const t=p.oxw().$implicit,e=p.oxw(4);p.xp6(1),p.Q6J("mdbTooltip",e.getDay(t.InDate)),p.xp6(3),p.Oqu(t.InDate),p.xp6(3),p.Oqu(e.getValue(t.InTime)),p.xp6(2),p.hij(" ",e.getValue(t.OutTime),""),p.xp6(2),p.hij(" ",e.getValue(t.DayTotal),""),p.xp6(2),p.hij(" ",e.getValue(t.BaseHr),""),p.xp6(2),p.hij(" ",e.getValue(t.OT),""),p.xp6(1),p.Q6J("ngSwitch",t.Status),p.xp6(1),p.Q6J("ngSwitchCase","A"),p.xp6(1),p.Q6J("ngSwitchCase","P"),p.xp6(1),p.Q6J("ngSwitchCase","HD")}}function Bt(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",62),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).$implicit;p.xp6(2),p.Oqu(t.Status)}}function Vt(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",63),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).$implicit;p.xp6(2),p.hij("",t.Status," ")}}function Gt(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",64),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).$implicit;p.xp6(2),p.hij("",t.Status," ")}}function Xt(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",66),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).$implicit,e=p.oxw(4);p.xp6(2),p.Oqu(e.getValue(t.Status))}}function Kt(t,e){if(1&t&&(p.TgZ(0,"mdb-card"),p.TgZ(1,"mdb-card-body",91),p.TgZ(2,"mdb-card-title",56),p.TgZ(3,"b"),p._uU(4),p.qZA(),p.qZA(),p.TgZ(5,"mdb-card-text"),p.TgZ(6,"div",57),p._uU(7),p.qZA(),p.TgZ(8,"div",58),p._uU(9),p.qZA(),p.TgZ(10,"div",59),p._uU(11),p.qZA(),p.TgZ(12,"div",92),p._uU(13),p.qZA(),p.TgZ(14,"div",93),p._uU(15),p.qZA(),p.TgZ(16,"div",60),p.TgZ(17,"div",44),p.YNc(18,Bt,3,1,"div",45),p.YNc(19,Vt,3,1,"div",45),p.YNc(20,Gt,3,1,"div",45),p.YNc(21,Xt,3,1,"div",61),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&t){const t=p.oxw().$implicit,e=p.oxw(4);p.xp6(1),p.Q6J("mdbTooltip",e.getDay(t.InDate)),p.xp6(3),p.Oqu(t.InDate),p.xp6(3),p.Oqu(e.getValue(t.InTime)),p.xp6(2),p.hij(" ",e.getValue(t.OutTime),""),p.xp6(2),p.hij(" ",e.getValue(t.DayTotal),""),p.xp6(2),p.hij(" ",e.getValue(t.BaseHr),""),p.xp6(2),p.hij(" ",e.getValue(t.OT),""),p.xp6(2),p.Q6J("ngSwitch",t.Status),p.xp6(1),p.Q6J("ngSwitchCase","A"),p.xp6(1),p.Q6J("ngSwitchCase","P"),p.xp6(1),p.Q6J("ngSwitchCase","HD")}}function te(t,e){if(1&t&&(p.TgZ(0,"div",51),p.YNc(1,$t,21,11,"mdb-card",86),p.YNc(2,Kt,22,11,"ng-template",null,53,p.W1O),p.qZA()),2&t){const t=e.$implicit,a=p.MAs(3);p.xp6(1),p.Q6J("ngIf","W"==t.Status)("ngIfElse",a)}}function ee(t,e){if(1&t&&(p.TgZ(0,"div"),p._UZ(1,"hr",48),p.TgZ(2,"div",1),p.TgZ(3,"div",40),p.TgZ(4,"b"),p._uU(5,"ID : "),p.qZA(),p._uU(6),p.qZA(),p.TgZ(7,"div",40),p.TgZ(8,"b"),p._uU(9,"NAME : "),p.qZA(),p._uU(10),p.qZA(),p.TgZ(11,"div",40),p.TgZ(12,"b"),p._uU(13,"DEPARTMENT : "),p.qZA(),p._uU(14),p.qZA(),p.TgZ(15,"div",40),p.TgZ(16,"b"),p._uU(17,"DESIGNATION : "),p.qZA(),p._uU(18),p.qZA(),p.qZA(),p._UZ(19,"hr"),p.TgZ(20,"div",49),p.YNc(21,te,4,2,"div",50),p.qZA(),p.qZA()),2&t){const t=e.$implicit;p.xp6(6),p.Oqu(t.id),p.xp6(4),p.Oqu(t.name),p.xp6(4),p.Oqu(t.Dept),p.xp6(4),p.Oqu(t.Desig),p.xp6(3),p.Q6J("ngForOf",t.filo)}}function ae(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div"),p.YNc(1,ee,22,5,"div",46),p.TgZ(2,"div"),p.TgZ(3,"mat-paginator",47),p.NdJ("page",function(e){p.CHM(t);const a=p.oxw(2);return a.OnPageChange(e,a.filoData)}),p.qZA(),p.qZA(),p.qZA()}if(2&t){const t=p.oxw(2);p.xp6(1),p.Q6J("ngForOf",t.pageSlice),p.xp6(2),p.Q6J("length",t.filoData.length)("pageSize",50)("pageSizeOptions",p.DdM(4,ht))}}function ie(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",62),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).$implicit;p.xp6(2),p.Oqu(t.Type)}}function ne(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",63),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).$implicit;p.xp6(2),p.Oqu(t.Type)}}function oe(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",64),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).$implicit;p.xp6(2),p.Oqu(t.Type)}}function se(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",65),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).$implicit;p.xp6(2),p.Oqu(t.Type)}}function le(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",66),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).$implicit;p.xp6(2),p.Oqu(t.Type)}}function re(t,e){if(1&t&&(p.TgZ(0,"mdb-card",54),p.TgZ(1,"mdb-card-body",55),p.TgZ(2,"mdb-card-title",56),p.TgZ(3,"b"),p._uU(4),p.qZA(),p.qZA(),p.TgZ(5,"mdb-card-text"),p.TgZ(6,"div",57),p._uU(7),p.qZA(),p.TgZ(8,"div",58),p._uU(9),p.qZA(),p.TgZ(10,"div",59),p._uU(11),p.qZA(),p.TgZ(12,"div",60),p.TgZ(13,"div",44),p.YNc(14,ie,3,1,"div",45),p.YNc(15,ne,3,1,"div",45),p.YNc(16,oe,3,1,"div",45),p.YNc(17,se,3,1,"div",45),p.YNc(18,le,3,1,"div",61),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&t){const t=p.oxw().$implicit;p.Q6J("mdbTooltip",t.InPunchDay),p.xp6(4),p.Oqu(t.RealDate),p.xp6(3),p.Oqu(t.InTime),p.xp6(2),p.hij(" ",t.OutTime,""),p.xp6(2),p.hij(" ",t.DayTotalMultiple,""),p.xp6(2),p.Q6J("ngSwitch",t.Type),p.xp6(1),p.Q6J("ngSwitchCase","A"),p.xp6(1),p.Q6J("ngSwitchCase","P"),p.xp6(1),p.Q6J("ngSwitchCase","P*"),p.xp6(1),p.Q6J("ngSwitchCase","L")}}function de(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",62),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).$implicit;p.xp6(2),p.Oqu(t.Type)}}function he(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",63),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).$implicit;p.xp6(2),p.Oqu(t.Type)}}function ge(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",64),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).$implicit;p.xp6(2),p.Oqu(t.Type)}}function pe(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",65),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).$implicit;p.xp6(2),p.Oqu(t.Type)}}function me(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"mdb-badge",66),p._uU(2),p.qZA(),p.qZA()),2&t){const t=p.oxw(2).$implicit;p.xp6(2),p.Oqu(t.Type)}}function ce(t,e){if(1&t&&(p.TgZ(0,"mdb-card",67),p.TgZ(1,"mdb-card-body",55),p.TgZ(2,"mdb-card-title",56),p.TgZ(3,"b"),p._uU(4),p.qZA(),p.qZA(),p.TgZ(5,"mdb-card-text"),p.TgZ(6,"div",57),p._uU(7),p.qZA(),p.TgZ(8,"div",58),p._uU(9),p.qZA(),p.TgZ(10,"div",59),p._uU(11),p.qZA(),p.TgZ(12,"div",60),p.TgZ(13,"div",44),p.YNc(14,de,3,1,"div",45),p.YNc(15,he,3,1,"div",45),p.YNc(16,ge,3,1,"div",45),p.YNc(17,pe,3,1,"div",45),p.YNc(18,me,3,1,"div",61),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&t){const t=p.oxw().$implicit;p.Q6J("mdbTooltip",t.InPunchDay),p.xp6(4),p.Oqu(t.RealDate),p.xp6(3),p.Oqu(t.InTime),p.xp6(2),p.hij(" ",t.OutTime,""),p.xp6(2),p.hij(" ",t.DayTotalMultiple," "),p.xp6(2),p.Q6J("ngSwitch",t.Type),p.xp6(1),p.Q6J("ngSwitchCase","A"),p.xp6(1),p.Q6J("ngSwitchCase","P"),p.xp6(1),p.Q6J("ngSwitchCase","P*"),p.xp6(1),p.Q6J("ngSwitchCase","L")}}function ue(t,e){if(1&t&&(p.TgZ(0,"div",51),p.YNc(1,re,19,10,"mdb-card",52),p.YNc(2,ce,19,10,"ng-template",null,53,p.W1O),p.qZA()),2&t){const t=e.$implicit,a=p.MAs(3);p.xp6(1),p.Q6J("ngIf","W"==t.Type)("ngIfElse",a)}}function Ze(t,e){if(1&t&&(p.TgZ(0,"div"),p._UZ(1,"hr",48),p.TgZ(2,"div",1),p.TgZ(3,"div",40),p.TgZ(4,"b"),p._uU(5,"ID : "),p.qZA(),p._uU(6),p.qZA(),p.TgZ(7,"div",40),p.TgZ(8,"b"),p._uU(9,"NAME : "),p.qZA(),p._uU(10),p.qZA(),p.TgZ(11,"div",40),p.TgZ(12,"b"),p._uU(13,"DEPARTMENT : "),p.qZA(),p._uU(14),p.qZA(),p.TgZ(15,"div",40),p.TgZ(16,"b"),p._uU(17,"DESIGNATION : "),p.qZA(),p._uU(18),p.qZA(),p.qZA(),p._UZ(19,"hr"),p.TgZ(20,"div",49),p.YNc(21,ue,4,2,"div",50),p.qZA(),p.qZA()),2&t){const t=e.$implicit;p.xp6(6),p.Oqu(t.ID),p.xp6(4),p.Oqu(t.Name),p.xp6(4),p.Oqu(t.dept),p.xp6(4),p.Oqu(t.desig),p.xp6(3),p.Q6J("ngForOf",t.mta)}}function Te(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div"),p.YNc(1,Ze,22,5,"div",46),p._UZ(2,"hr"),p.TgZ(3,"div"),p.TgZ(4,"mat-paginator",47),p.NdJ("page",function(e){p.CHM(t);const a=p.oxw(2);return a.OnPageChange(e,a.multiplePunchData)}),p.qZA(),p.qZA(),p.qZA()}if(2&t){const t=p.oxw(2);p.xp6(1),p.Q6J("ngForOf",t.pageSlice),p.xp6(3),p.Q6J("length",t.multiplePunchData.length)("pageSize",50)("pageSizeOptions",p.DdM(4,ht))}}function fe(t,e){if(1&t&&(p.TgZ(0,"option",19),p._uU(1),p.qZA()),2&t){const t=e.$implicit;p.Q6J("value",t),p.xp6(1),p.Oqu(t)}}function Ae(t,e){if(1&t&&(p.TgZ(0,"tr"),p.TgZ(1,"td"),p._uU(2),p.qZA(),p.TgZ(3,"td"),p._uU(4),p.qZA(),p.TgZ(5,"td"),p._uU(6),p.qZA(),p.TgZ(7,"td"),p._uU(8),p.qZA(),p.TgZ(9,"td"),p._uU(10),p.qZA(),p.qZA()),2&t){const t=e.$implicit;p.xp6(2),p.Oqu(t.EmpId),p.xp6(2),p.Oqu(t.Name),p.xp6(2),p.Oqu(t.Department),p.xp6(2),p.Oqu(t.Date),p.xp6(2),p.Oqu(t.Time)}}function ye(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div"),p.TgZ(1,"h3"),p._uU(2),p.qZA(),p.TgZ(3,"div",89),p.TgZ(4,"table",90),p.TgZ(5,"thead"),p.TgZ(6,"tr"),p.TgZ(7,"th",94),p._uU(8,"ID "),p.TgZ(9,"form",95),p.TgZ(10,"input",96),p.NdJ("ngModelChange",function(e){return p.CHM(t),p.oxw(2).id_emp_premises=e})("keyup",function(){return p.CHM(t),p.oxw(2).searchEmployeeInsidePremises()}),p.qZA(),p.qZA(),p.qZA(),p.TgZ(11,"th",94),p._uU(12,"NAME "),p.TgZ(13,"form",95),p.TgZ(14,"input",97),p.NdJ("ngModelChange",function(e){return p.CHM(t),p.oxw(2).name_emp_premises=e})("keyup",function(){return p.CHM(t),p.oxw(2).searchEmployeeInsidePremises()}),p.qZA(),p.qZA(),p.qZA(),p.TgZ(15,"th",94),p._uU(16,"DEPARTMENT "),p.TgZ(17,"select",98),p.NdJ("ngModelChange",function(e){return p.CHM(t),p.oxw(2).dept_emp_premises=e})("change",function(){return p.CHM(t),p.oxw(2).searchEmployeeInsidePremises()}),p.TgZ(18,"option",99),p._uU(19,"All"),p.qZA(),p.YNc(20,fe,2,2,"option",9),p.qZA(),p.qZA(),p.TgZ(21,"th",94),p._uU(22,"DATE"),p.qZA(),p.TgZ(23,"th",94),p._uU(24,"TIME"),p.TgZ(25,"span",100),p.NdJ("click",function(){return p.CHM(t),p.oxw(2).sortList()}),p._UZ(26,"mdb-icon",101),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(27,"tbody"),p.YNc(28,Ae,11,5,"tr",46),p.qZA(),p.qZA(),p.qZA(),p.qZA()}if(2&t){const t=p.oxw(2);p.xp6(2),p.hij(" Total No. Of Employees : ",t.EmployeeInsidePremisesData.length,""),p.xp6(8),p.Q6J("ngModel",t.id_emp_premises),p.xp6(4),p.Q6J("ngModel",t.name_emp_premises),p.xp6(3),p.Q6J("ngModel",t.dept_emp_premises),p.xp6(3),p.Q6J("ngForOf",t.dept_of_employee),p.xp6(8),p.Q6J("ngForOf",t.EmployeeInsidePremisesData)}}function De(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div",39),p.TgZ(1,"h1"),p._uU(2),p.qZA(),p._UZ(3,"br"),p.TgZ(4,"div",1),p.TgZ(5,"div",40),p.TgZ(6,"b"),p._uU(7,"FromDate : "),p.qZA(),p._uU(8),p.qZA(),p.TgZ(9,"div",40),p.TgZ(10,"b"),p._uU(11,"ToDate : "),p.qZA(),p._uU(12),p.qZA(),p.TgZ(13,"div",41),p.TgZ(14,"button",42),p.NdJ("click",function(){return p.CHM(t),p.oxw().genericPdfReport()}),p._UZ(15,"i",43),p._uU(16,"\xa0Download PDF"),p.qZA(),p.qZA(),p.TgZ(17,"div",41),p.TgZ(18,"button",42),p.NdJ("click",function(){return p.CHM(t),p.oxw().genericExcelReport()}),p._UZ(19,"i",43),p._uU(20,"\xa0Download Excel"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(21,"div",44),p.YNc(22,gt,4,5,"div",45),p.YNc(23,vt,4,5,"div",45),p.YNc(24,zt,4,5,"div",45),p.YNc(25,Qt,23,5,"div",45),p.YNc(26,ae,4,5,"div",45),p.YNc(27,Te,5,5,"div",45),p.YNc(28,ye,29,6,"div",45),p.qZA(),p.qZA()}if(2&t){const t=p.oxw();p.xp6(2),p.Oqu(t.reportName),p.xp6(6),p.Oqu(t.fromdatedisplay),p.xp6(4),p.hij(" ",t.todatedisplay,""),p.xp6(9),p.Q6J("ngSwitch",t.selectedReports),p.xp6(1),p.Q6J("ngSwitchCase","Attendance Report"),p.xp6(1),p.Q6J("ngSwitchCase","Summary Report"),p.xp6(1),p.Q6J("ngSwitchCase","Muster Report"),p.xp6(1),p.Q6J("ngSwitchCase","Absent Report"),p.xp6(1),p.Q6J("ngSwitchCase","Time Attendance (FILO) Report"),p.xp6(1),p.Q6J("ngSwitchCase","Multiple Punches Time Attendance Report"),p.xp6(1),p.Q6J("ngSwitchCase","Employee Inside Premises")}}let xe=(()=>{class t{constructor(t,e,a,i,n){this.reports=t,this.common=e,this.toast=a,this.datepipe=i,this.ngxuiloader=n,this.yearrange="2010:",this.nameerror=!1,this.name1error=!1,this.typeerror=!1,this.dateerror=!1,this.reporterror=!1,this.date1error=!1,this.deptname=[],this.selectedEmployee=[],this.tabledata=[],this.showtable=!1,this.selectedReports="-1",this.DateRange=!1,this.ContractorName=!0,this.DepartmentName=!0,this.SubDepartment=!0,this.Desigination=!0,this.EmployeeType=!0,this.Records=!1,this.Mode=!0,this.Date=!1,this.HeadCount=!1,this.Hanging=!1,this.PPunches=!1,this.hangingPunch=!1,this.multiplePunchData=[],this.p_star_punches=!1,this.summaryDateArray=[],this.dayarray=[],this.contractor_list=[],this.original_dept_list=[],this.showcontractor=!1,this.contractor="",this.ranges=[{value:[new Date,new Date],label:"Today"},{value:[new Date((new Date).setDate((new Date).getDate()-7)),new Date],label:"Last 7 Days"},{value:[new Date((new Date).getFullYear(),(new Date).getMonth(),1),new Date((new Date).setDate((new Date).getDate()-1))],label:"This Month"},{value:[new Date((new Date).getFullYear(),(new Date).getMonth()-1,1),new Date((new Date).getFullYear(),(new Date).getMonth(),0)],label:"Last Month"}],this.reports_list=["Employee Inside Premises","Attendance Report","Time Attendance (FILO) Report","Multiple Punches Time Attendance Report","Summary Report","Muster Report","Absent Report"],this.dept_list=[],this.desig_list=[],this.type_list=[],this.cont_list=[],this.sub_list=[],this.attendanceData=[],this.musterData=[],this.filoData=[],this._dateerror=!1,this.timeerror=!1,this._EmployeeInsidePremisesData=[],this.dept_of_employee=[],this.EmployeeInsidePremisesData=[],this.dept_emp_premises="All",this.id_emp_premises="",this.name_emp_premises="",this.absentData=[]}ngOnInit(){var t=this;this.daterangeConfig={containerClass:"theme-dark-blue",showPreviousMonth:!0,isAnimated:!0,rangeInputFormat:"DD/MM/YYYY",maxDateRange:30,showClearButton:!0,clearPosition:"right",selectWeekDateRange:!0,ranges:this.ranges},this.showcontractor="y"==this.common.getLocalStorage().Contractor.toLowerCase();try{this.common.getContractorList().subscribe(function(){var e=(0,T.Z)(function*(e){t.contractor_list=yield e,null!=t.contractor_list.data||null!=t.contractor_list.data?0!=t.contractor_list.data.length&&(t.contractor_list=t.contractor_list.data):(t.contractor_list=[],t.contractor_list.push({Contractor_Id:"-1",Contractor_Name:"No Contractor Registered"}))});return function(t){return e.apply(this,arguments)}}()),this.common.getDepartmentList().subscribe(function(){var e=(0,T.Z)(function*(e){t.dept_list=yield e,null!=t.dept_list.data||null!=t.dept_list.data?(0!=t.dept_list.data.length&&(t.dept_list=t.dept_list.data),t.original_dept_list=t.dept_list):(t.dept_list=[],t.dept_list.push({DeptId:"-1",DeptName:"No Department Registered"}))});return function(t){return e.apply(this,arguments)}}()),this.common.getDesignationList().subscribe(function(){var e=(0,T.Z)(function*(e){t.desig_list=yield e,null!=t.desig_list.data||null!=t.desig_list.data?0!=t.desig_list.data.length&&(t.desig_list=t.desig_list.data):(t.desig_list=[],t.desig_list.push({DesignId:"-1",DesignName:"No Designation Registered"}))});return function(t){return e.apply(this,arguments)}}())}catch(e){let t={Exception:e,id:this.common.getLocalStorage().LoginId,Api:"Attendance Component"};this.common.saveLog(t,"ApiException")}this.recordtype="M",this.reporttype="express",this.yearrange+=(new Date).getFullYear(),this.designname="-1",this.maxDateValue=new Date,this.maxDateValue.setMonth((new Date).getMonth()),this.maxDateValue.setFullYear((new Date).getFullYear()),this.maxDateValue.setDate((new Date).getDate()-1)}OnPageChange(t,e){const a=t.pageIndex*t.pageSize;let i=a+t.pageSize;i>e.length&&(i=e.length),this.pageSlice=e.slice(a,i)}getSelectedReportName(){if("-1"==this.selectedReports)return this.DateRange=!1,this.Date=!1,this.HeadCount=!1,this.Records=!1,this.PPunches=!1,this.Hanging=!1,void(this.reporterror=!0);if(this.reporterror=!1,"Employees Inside Premises Report"==this.selectedReports?(this.DateRange=!1,this.Date=!0,this.HeadCount=!0,this.Records=!1):(this.DateRange=!0,this.Date=!1,this.HeadCount=!1,this.Records=!0),this.PPunches="Time Attendance (FILO) Report"==this.selectedReports,"Attendance Report"==this.selectedReports?(this.maxDateValue=new Date,this.maxDateValue.setMonth((new Date).getMonth()),this.maxDateValue.setFullYear((new Date).getFullYear()),this.maxDateValue.setDate((new Date).getDate()-1),this.Records=!1):(this.maxDateValue=new Date,this.maxDateValue.setMonth((new Date).getMonth()),this.maxDateValue.setFullYear((new Date).getFullYear()),this.maxDateValue.setDate((new Date).getDate()-1)),"Edited Muster Report"==this.selectedReports?(this.ContractorName=!1,this.DepartmentName=!1,this.SubDepartment=!1,this.Desigination=!1,this.EmployeeType=!1):(this.ContractorName=!0,this.DepartmentName=!0,this.SubDepartment=!0,this.Desigination=!0,this.EmployeeType=!0),this.Hanging="Multiple Punches Time Attendance Report"==this.selectedReports,this.daterangeConfig.maxDateRange="Absent Report"==this.selectedReports?365:30,"Employee Inside Premises"==this.selectedReports){this.DateRange=!1,this.Hanging=!1,this.Date=!0,this.time=new Date;let t=this.datepipe.transform(new Date,"yyyy-MM-dd");this._date=t}this.pageSlice=[],this.showtable=!1}onValueChange(t){this.empsearch.showtable=!0,null==t&&(this.deptname=[],this.empsearch.showtable=!1)}contractorSelection(){var t=this;if(this.contractor="",this.deptname=[],this.empsearch.employees=[],0!=this.contractorname.length){this.contractor+=this.contractorname[0];for(let t=1;t<this.contractorname.length;t++)this.contractor+=","+this.contractorname[t];this.common.getDepartmentUnderContractor(this.contractor).subscribe(function(){var e=(0,T.Z)(function*(e){let a=yield e;if(null!=a.data&&0!=a.data.length){t.dept_list=[];for(let e=0;e<a.data.length;e++)for(let i=0;i<t.original_dept_list.length;i++)a.data[e]==t.original_dept_list[i].DeptId&&t.dept_list.push(t.original_dept_list[i])}else t.dept_list=[]});return function(t){return e.apply(this,arguments)}}())}else this.dept_list=this.original_dept_list}showEmployeeByDept(){this.nameerror=0==this.deptname.length,this.designname="-1";let t=this.datepipe.transform(this.daterange[0],"dd/MM/yyyy"),e=this.datepipe.transform(this.daterange[1],"dd/MM/yyyy");if(this.deptname.length==this.dept_list.length)this.empsearch.showEmployeeWithinRange(t,e,"All",this.contractor);else{let a="";for(let t=0;t<this.deptname.length;t++)this.dept_list.filter(e=>{e.DeptId==this.deptname[t]&&(a+=e.DeptId+",")});a=a.slice(0,-1),this.empsearch.showEmployeeWithinRange(t,e,a,this.contractor)}}showEmployeeByDesg(){let t=this.desig_list.filter(t=>t.DesignName==this.designname);this.empsearch.showEmployeeByDesgById(t[0].DesignId)}onCheckDate(){var t=new Date(this.daterange[0]),e=new Date(this.daterange[1]).getTime()-t.getTime();this.selectedDays=Math.floor(e/864e5)}counter(t){return new Array(t)}showReport(){if("-1"==this.selectedReports)return void(this.reporterror=!0);if(this.reporterror=!1,"Employee Inside Premises"==this.selectedReports)return this.reportName=this.selectedReports,void this.getEmployeeInsidePremisesReport();if(this.dateerror=null==this.daterange||null==this.daterange[0]||null==this.daterange[1],this.nameerror="-1"==this.deptname,this.reporterror||this.dateerror||this.nameerror)return;if(this.onCheckDate(),0==this.empsearch.selectedEmployee.length)return void this.toast.warning("Please Select atleast one employee!!!");let t=this.datepipe.transform(this.daterange[0],"dd/MM/yyyy"),e=this.datepipe.transform(this.daterange[1],"dd/MM/yyyy");this.fromdatedisplay=t,this.todatedisplay=e,this.reportName=this.selectedReports,"Attendance Report"==this.selectedReports?this.getAttendanceReport(t,e):"Multiple Punches Time Attendance Report"==this.selectedReports?this.getMultiplePunchesReport(t,e):"Summary Report"==this.selectedReports?this.getSummaryReport(t,e):"Muster Report"==this.selectedReports?this.getMusterReport(t,e):"Time Attendance (FILO) Report"==this.selectedReports?this.getTimeAttendanceFILOReport(t,e):"Absent Report"==this.selectedReports&&this.getAbsentReport(t,e),this.common.insertLog("Report/Attendance/seen-"+this.reportName)}getEmployeeInsidePremisesReport(){var t=this;if(this._dateerror=null==this._date,this.timeerror=null==this.time||""==this.time,this._dateerror||this.timeerror)return;let e=this._date.split("-"),a={Location:this.common.getCid(),Date:e[2]+"/"+e[1]+"/"+e[0],Time:this.datepipe.transform(this.time,"HH:mm"),Dept:[],Contractor:[]};this.reports.getEmployeeInsidePremises(a).subscribe(function(){var e=(0,T.Z)(function*(e){let a=yield e;null!=a.data&&0!=a.data.length?(t._EmployeeInsidePremisesData=a.data,t._EmployeeInsidePremisesData=t._EmployeeInsidePremisesData.sort((t,e)=>t.Time>e.Time?-1:t.Time<e.Time?1:0),t.EmployeeInsidePremisesData=t._EmployeeInsidePremisesData,t.dept_of_employee=[...new Set(t._EmployeeInsidePremisesData.map(t=>t.Department))],t.showtable=!0):(t.EmployeeInsidePremisesData=[],t.toast.warning(a.errormessage))});return function(t){return e.apply(this,arguments)}}(),t=>{let e={Exception:t.message,id:this.common.getLocalStorage().LoginId,Api:"Employee Inside Premises Report"};this.common.saveLog(e,"ApiException")})}searchEmployeeInsidePremises(){if(""==this.id_emp_premises&&""==this.name_emp_premises&&"All"==this.dept_emp_premises)return void(this.EmployeeInsidePremisesData=this._EmployeeInsidePremisesData);let t=[];for(let e=0;e<this._EmployeeInsidePremisesData.length;e++)this._EmployeeInsidePremisesData[e].EmpId.includes(this.id_emp_premises)&&this._EmployeeInsidePremisesData[e].Name.toLowerCase().includes(this.name_emp_premises.toLowerCase())&&("All"==this.dept_emp_premises||this.dept_emp_premises==this._EmployeeInsidePremisesData[e].Department)&&t.push(this._EmployeeInsidePremisesData[e]);this.EmployeeInsidePremisesData=t}getSummaryReport(t,e){var a=this;return(0,T.Z)(function*(){a.summarydata=[],a.summaryDateArray=[],a.summaryDateArray.push(new Date(a.daterange[0]).getDate());let i=new Date(a.daterange[0]);for(let t=1;t<=a.selectedDays;t++)a.summaryDateArray.push(new Date(i.setDate(i.getDate()+1)).getDate());a.selectedEmployee=a.empsearch.selectedEmployee;let n=[];for(let t=0;t<a.selectedEmployee.length;t++)n.push(a.selectedEmployee[t].EmployeeId);let o={CID:a.common.getCid(),EmpId:n,FromDate:t,ToDate:e,ReportType:"summary",ReportMode:"express",RecordType:"M",isTaj:a.common.getLocalStorage().TAJ,LeaveDeduct:a.common.getLocalStorage().LeaveDeduct,LateMarks:a.common.getLocalStorage().LateMarks,ConsiderVIP:a.common.getLocalStorage().VIP},s=yield a.reports.getSummaryReport(o).toPromise();1==s.errorcode&&(0!=s.data.length||null!=s.data?(a.summarydata=s.data,a.showtable=!0,a.pageSlice=a.summarydata.slice(0,50)):(a.tabledata=[],a.showtable=!1))})()}getAttendanceReport(t,e){var a=this;this.attendanceData=[],this.selectedEmployee=this.empsearch.selectedEmployee;let i=[];for(let s=0;s<this.selectedEmployee.length;s++)i.push(this.selectedEmployee[s].EmployeeId);let n=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],o={CID:this.common.getCid(),EmpId:i,FromDate:t,ToDate:e,ReportType:"express",ReportMode:"M"};this.reports.getAttendanceReport(o).subscribe(function(){var t=(0,T.Z)(function*(t){let e,i,o=yield t;if(1==o.errorcode)if(0!=o.data.length||null!=o.data){a.tabledata=o.data;for(let t=0;t<a.tabledata.length;t++){let o=a.tabledata[t].InPunchDate.split("/"),s=new Date(o[2],o[1]-1,o[0]),l=n[s.getDay()];0==t?(e={name:a.tabledata[t].name,Id:a.tabledata[t].Id,Dept:a.tabledata[t].Dept,Desig:a.tabledata[t].Desig,Alfanumeric:a.tabledata[t].Alfanumeric,info:[{InPunchDate:a.datepipe.transform(s,"dd"),InPunchDay:l,InPunchTime:""==a.tabledata[t].InPunchTime?"?":a.tabledata[t].InPunchTime,OutPunchTime:""==a.tabledata[t].OutPunchTime?"?":a.tabledata[t].OutPunchTime,DayTotal:a.tabledata[t].DayTotal,Type:a.tabledata[t].Type}]},1==a.tabledata.length?a.attendanceData.push(e):a.tabledata[t].Id!=a.tabledata[t+1].Id&&(a.attendanceData.push(e),e={name:a.tabledata[t+1].name,Id:a.tabledata[t+1].Id,Dept:a.tabledata[t+1].Dept,Desig:a.tabledata[t+1].Desig,Alfanumeric:a.tabledata[t+1].Alfanumeric,info:[]})):t==a.tabledata.length-1?(e.Id==a.tabledata[t].Id?(i={InPunchDate:a.datepipe.transform(s,"dd"),InPunchDay:l,InPunchTime:""==a.tabledata[t].InPunchTime?"?":a.tabledata[t].InPunchTime,OutPunchTime:""==a.tabledata[t].OutPunchTime?"?":a.tabledata[t].OutPunchTime,DayTotal:a.tabledata[t].DayTotal,Type:a.tabledata[t].Type},e.info.push(i)):e={name:a.tabledata[t].name,Id:a.tabledata[t].Id,Dept:a.tabledata[t].Dept,Desig:a.tabledata[t].Desig,Alfanumeric:a.tabledata[t].Alfanumeric,info:[{InPunchDate:a.datepipe.transform(s,"dd"),InPunchDay:l,InPunchTime:""==a.tabledata[t].InPunchTime?"?":a.tabledata[t].InPunchTime,OutPunchTime:""==a.tabledata[t].OutPunchTime?"?":a.tabledata[t].OutPunchTime,DayTotal:a.tabledata[t].DayTotal,Type:a.tabledata[t].Type}]},a.attendanceData.push(e)):a.tabledata[t].Id==a.tabledata[t+1].Id?(i={InPunchDate:a.datepipe.transform(s,"dd"),InPunchDay:l,InPunchTime:""==a.tabledata[t].InPunchTime?"?":a.tabledata[t].InPunchTime,OutPunchTime:""==a.tabledata[t].OutPunchTime?"?":a.tabledata[t].OutPunchTime,DayTotal:a.tabledata[t].DayTotal,Type:a.tabledata[t].Type},e.info.push(i)):(i={InPunchDate:a.datepipe.transform(s,"dd"),InPunchDay:l,InPunchTime:""==a.tabledata[t].InPunchTime?"?":a.tabledata[t].InPunchTime,OutPunchTime:""==a.tabledata[t].OutPunchTime?"?":a.tabledata[t].OutPunchTime,DayTotal:a.tabledata[t].DayTotal,Type:a.tabledata[t].Type},e.info.push(i),a.attendanceData.push(e),e={name:a.tabledata[t+1].name,Id:a.tabledata[t+1].Id,Dept:a.tabledata[t+1].Dept,Desig:a.tabledata[t+1].Desig,Alfanumeric:a.tabledata[t+1].Alfanumeric,info:[]})}a.showtable=!0,a.pageSlice=a.attendanceData.slice(0,50)}else a.tabledata=[],a.showtable=!1});return function(e){return t.apply(this,arguments)}}(),t=>{let e={Exception:t.message,id:this.common.getLocalStorage().LoginId,Api:"Attendance Report"};this.common.saveLog(e,"ApiException")})}getMusterReport(t,e){var a=this;this.musterData=[],this.summaryDateArray=[],this.dayarray=[];let i=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];this.summaryDateArray.push(new Date(this.daterange[0]).getDate()),this.dayarray.push(i[new Date(this.daterange[0]).getDay()]);let n=new Date(this.daterange[0]);for(let l=1;l<=this.selectedDays;l++)this.summaryDateArray.push(new Date(n.setDate(n.getDate()+1)).getDate()),this.dayarray.push(i[new Date(n).getDay()]);this.selectedEmployee=this.empsearch.selectedEmployee;let o=[];for(let l=0;l<this.selectedEmployee.length;l++)o.push(this.selectedEmployee[l].EmployeeId);let s={CID:this.common.getCid(),EmpId:o,FromDate:t,ToDate:e,ReportType:"muster",ReportMode:"express",RecordType:"M",isTaj:this.common.getLocalStorage().TAJ,LeaveDeduct:this.common.getLocalStorage().LeaveDeduct,LateMarks:this.common.getLocalStorage().LateMarks,ConsiderVIP:this.common.getLocalStorage().VIP};this.reports.getMusterReport(s).subscribe(function(){var t=(0,T.Z)(function*(t){let e=yield t;1==e.errorcode&&(0!=e.data.length||null!=e.data?(a.musterData=e.data,a.showtable=!0,a.pageSlice=a.musterData.slice(0,50)):(a.musterData=[],a.showtable=!1))});return function(e){return t.apply(this,arguments)}}(),t=>{let e={Exception:t.message,id:this.common.getLocalStorage().LoginId,Api:"Muster Report"};this.common.saveLog(e,"ApiException")})}getMultiplePunchesReport(t,e){var a=this;this.multiplePunchData=[],this.selectedEmployee=this.empsearch.selectedEmployee;let i=[];for(let o=0;o<this.selectedEmployee.length;o++)i.push(this.selectedEmployee[o].EmployeeId);let n={CID:this.common.getCid(),EmpId:i,FromDate:t,ToDate:e,ReportType:"MTA_RPT",ReportMode:"express",WithHanging:this.hangingPunch?"Y":"N"};this.reports.getMultiplePunchesReport(n).subscribe(function(){var t=(0,T.Z)(function*(t){let e=yield t;1==e.errorcode&&(0!=e.data.length||null!=e.data?(a.multiplePunchData=e.data,a.showtable=!0,a.pageSlice=a.multiplePunchData.slice(0,50)):(a.multiplePunchData=[],a.showtable=!1))});return function(e){return t.apply(this,arguments)}}(),t=>{let e={Exception:t.message,id:this.common.getLocalStorage().LoginId,Api:"MTA Report"};this.common.saveLog(e,"ApiException")})}getTimeAttendanceFILOReport(t,e){var a=this;return(0,T.Z)(function*(){a.summarydata=[],a.summaryDateArray=[],a.summaryDateArray.push(new Date(a.daterange[0]).getDate());for(let t=1;t<=a.selectedDays;t++)a.summaryDateArray.push(new Date(a.daterange[0]).getDate()+t);a.selectedEmployee=a.empsearch.selectedEmployee;let i=[];for(let t=0;t<a.selectedEmployee.length;t++)i.push(a.selectedEmployee[t].EmployeeId);let n={CID:a.common.getCid(),EmpId:i,FromDate:t,ToDate:e,ReportType:"filo",ReportMode:"express",RecordType:"M"},o=yield a.reports.getFiloReport(n).toPromise();1==o.errorcode&&(0!=o.data.length||null!=o.data?(a.filoData=o.data,a.showtable=!0,a.pageSlice=a.filoData.slice(0,50)):(a.filoData=[],a.showtable=!1))})()}resetValue(){this.showtable=!1,this.empsearch.selectedEmployee=[],this.empsearch.showtable=!1,this.attendanceData=[],this.contractorname=[],this.empsearch.employees=[],this.selectedReports="-1",this.DateRange=!1,this.Date=!1,this.HeadCount=!1,this.Records=!1,this.PPunches=!1,this.Hanging=!1,this.daterange=void 0,this.deptname=[],this.designname="-1",this.reporttype="express",this.contractor=""}getAbsentReport(t,e){var a=this;this.summaryDateArray=[],this.summaryDateArray.push(new Date(this.daterange[0]).getDate());let i=new Date(this.daterange[0]);for(let s=1;s<=this.selectedDays;s++)this.summaryDateArray.push(new Date(i.setDate(i.getDate()+1)).getDate());this.selectedEmployee=this.empsearch.selectedEmployee;let n=[];for(let s=0;s<this.selectedEmployee.length;s++)n.push(this.selectedEmployee[s].EmployeeId);let o={CID:this.common.getCid(),EmpId:n,FromDate:t,ToDate:e,ReportType:"Absent Report",ReportMode:"express",Records:"M"};this.reports.getAbsentReport(o).subscribe(function(){var t=(0,T.Z)(function*(t){let e=yield t;1==e.errorcode?null!=e.data&&0!=e.data.length?(a.absentData=e.data,a.showtable=!0,a.pageSlice=a.absentData.slice(0,50)):(a.absentData=[],a.showtable=!1):(a.absentData=[],a.showtable=!1,a.toast.info(e.errormessage))});return function(e){return t.apply(this,arguments)}}(),t=>{let e={Exception:t.message,id:this.common.getLocalStorage().LoginId,Api:"Absent Report"};this.common.saveLog(e,"ApiException")})}getValue(t){return""==t?"?":t}getDay(t){let e=t.split("/");return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][new Date(e[2],e[1]-1,e[0]).getDay()]}genericExcelReport(){"Attendance Report"==this.selectedReports?this.attendanceExcelReport():"Summary Report"==this.selectedReports?this.summaryExcelReport():"Muster Report"==this.selectedReports?this.musterExcelReport():"Absent Report"==this.selectedReports?this.absentExcelReport():"Time Attendance (FILO) Report"==this.selectedReports?this.timeAttendanceFILOExcelReport():"Multiple Punches Time Attendance Report"==this.selectedReports?this.multiplePunchesExcelReport():"Employee Inside Premises"==this.selectedReports&&this.employeeInsidePremisesExcelReport()}genericPdfReport(){"Attendance Report"==this.selectedReports?this.attendancePdfReport():"Summary Report"==this.selectedReports?this.summaryPdfReport():"Muster Report"==this.selectedReports?this.musterPdfReport():"Absent Report"==this.selectedReports?this.absentPdfReport():"Time Attendance (FILO) Report"==this.selectedReports?this.timeAttendanceFILOPDFReport():"Multiple Punches Time Attendance Report"==this.selectedReports?this.multiplePunchesPDFReport():"Employee Inside Premises"==this.selectedReports&&this.employeeInsidePremisesPDFReport()}timeAttendanceFILOPDFReport(){var t=new f.jsPDF("l","pt","a4");const e=this.datepipe.transform(new Date,"d MMM y, h:mm:ss a"),a=this.datepipe.transform(new Date,"dd/MM/yyyy-h:mm:ss a");var i=t.internal.pageSize.width||t.internal.pageSize.getWidth(),n=t.internal.pageSize.height||t.internal.pageSize.getHeight();t.setFontSize(8),t.text("Time Attendance Report (FILO)",i/2,20,{align:"center"}),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center"}),t.text(""+e,i-20,30,{align:"right"}),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.line(20,40,i-20,40);let o=["Date","Shift","Shift Start Time","Shift End Time","LunchOut","LunchIn","TimeIn","TimeOut","DayTotal","Attendance","Edit Status","Late","Early Go","Base Hour","OT"],s=20;t.setFontSize(8);for(let g of o)t.text(g,s,60,{maxWidth:40}),s+=50;t.line(20,85,i-20,85),t.setFontSize(7);let l=1,r=100;s=30;let d=i/4,h=10;for(let g=0;g<this.filoData.length;g++){if(0==l){s=20,t.setFontSize(8);for(let e of o)t.text(e,s,60,{maxWidth:40}),s+=50;t.line(20,85,i-20,85),t.setFontSize(8),t.text("Time Attendance Report (FILO)",i/2,20,{align:"center",renderingMode:"fill"}).setFillColor("#FFFFFF"),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center",renderingMode:"fill"}),t.text(""+e,i-20,30,{align:"right"}),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.line(20,40,i-20,40),r=100,s=30,d=i/4,h=10}h=10,t.setFontSize(8),t.text("ID : "+this.filoData[g].id,s,r,{align:"left"}),t.text("NAME : "+this.filoData[g].name,s+100,r,{align:"left"}),t.text("DEPARTMENT : "+this.filoData[g].Dept,s+250,r,{align:"left"}),t.text("DESIGNATION : "+this.filoData[g].Desig,s+400,r,{align:"left"}),t.text("ALPHANUMERIC : "+this.filoData[g].filo[0].alfanumeric,s+600,r,{align:"left"}),t.setFontSize(8),t.line(20,r+10,i-20,r+10);let a=20;r+=20;for(let l=0;l<this.filoData[g].filo.length;l++)if(t.text(this.filoData[g].filo[l].InDate.substring(0,5),a,r,{renderingMode:"fill"}),t.text(this.filoData[g].filo[l].ShiftDesc,a+40,r,{renderingMode:"fill",maxWidth:50}),t.text(this.filoData[g].filo[l].ShiftStart.substring(0,5),a+100,r),t.text(this.filoData[g].filo[l].ShiftEnd.substring(0,5),a+150,r),t.text(this.filoData[g].filo[l].LunchOut.substring(0,5),a+200,r),t.text(this.filoData[g].filo[l].LunchIn.substring(0,5),a+250,r),t.text(this.filoData[g].filo[l].InTime,a+300,r),t.text(this.filoData[g].filo[l].OutTime,a+350,r),t.text(this.filoData[g].filo[l].DayTotal,a+400,r),t.text(this.filoData[g].filo[l].Status,a+450,r),t.text("",a+500,r),t.text(this.filoData[g].filo[l].Late,a+550,r),t.text(this.filoData[g].filo[l].Early,a+600,r),t.text(this.filoData[g].filo[l].BaseHr,a+650,r),t.text(this.filoData[g].filo[l].OT,a+700,r),r+=20,r+30>n){t.addPage("a4","l"),s=20,t.setFontSize(8);for(let e of o)t.text(e,s,60,{maxWidth:40}),s+=50;t.line(20,85,i-20,85),t.setFontSize(8),t.text("Time Attendance Report (FILO)",i/2,20,{align:"center",renderingMode:"fill"}).setFillColor("#FFFFFF"),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center",renderingMode:"fill"}),t.text(""+e,i-20,30,{align:"right"}),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.line(20,40,i-20,40),r=100,s=30,d=i/4,h=10}t.line(20,r,i-20,r),r+=10,l+=1,r+100>n&&(t.addPage("a4","l"),l=0)}t.save("Time_Attendance_Report (FILO)-"+a+".pdf")}timeAttendanceFILOExcelReport(){this.ngxuiloader.start();const t=this.common.getLocalStorage().ClientName,e=this.datepipe.transform(new Date,"dd/MM/yyyy");let a=new q.Workbook,i=a.addWorksheet("Time Attendance Filo Report"),n=i.addRow(["Time Attendance Filo Report"]);i.addRow([t]),n.font={name:"Comic Sans MS",family:4,size:16,underline:"double",bold:!0},i.addRow(["Report Generation Date : "+this.datepipe.transform(new Date,"dd MMM yyyy")]);let o="From : "+this.datepipe.transform(this.daterange[0],"dd MMM yyyy"),s="To : "+this.datepipe.transform(this.daterange[1],"dd MMM yyyy");i.addRow([o]),i.addRow([s]),i.addRow([]);let l=i.addRow(["ID","NAME","DEPARTMENT","DESIGNATION","INDATE","SHIFT-ID","SHIFT_DESC","SHIFT_START","SHIFT_END","LUNCHOUT","LUNCHIN","INTIME","INSTATUS","OUT","OUTTIME","OUTSTATUS","TOTAL","STATUS","MANUALEDIT","INGRACE","OUTGRACE","LATEUPTO","EARLYGO","LATE","EARLY","BASEHR","OT","DAYTOTALMULTIPLE","TIMEDIFF","LOCATION_CID","LOCATION_NAME","ALPHANUMERIC","VIP","GRADE","SUB-DEPT-NAME","CONTRACTOR_NAME","TYPE_DESC"]);l.font={size:12,bold:!0},l.eachCell((t,e)=>{t.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"},bgColor:{argb:"FF0000FF"}},t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}});let r=[];for(let d=0;d<this.filoData.length;d++){r=[],r[1]=Number(this.filoData[d].id),r[2]=this.filoData[d].name,r[3]=this.filoData[d].Dept,r[4]=this.filoData[d].Desig;let t=5;for(let e of this.filoData[d].filo){t=5,r[t]=e.InDate,t++,r[t]="",t++,r[t]=e.ShiftDesc,t++,r[t]=e.ShiftStart,t++,r[t]=e.ShiftEnd,t++,r[t]=e.LunchOut,t++,r[t]=e.LunchIn,t++,r[t]=e.InTime,t++,r[t]=e.InStatus,t++,r[t]=e.OutDate,t++,r[t]=e.OutTime,t++,r[t]=e.OutStatus,t++,r[t]=e.Total,t++,r[t]=e.Status,t++,r[t]="",t++,r[t]="",t++,r[t]="",t++,r[t]="",t++,r[t]="",t++,r[t]="",t++,r[t]=e.Late,t++,r[t]=e.Early,t++,r[t]=e.BaseHr,t++,r[t]=e.OT,t++,r[t]=e.TimeDiff,t++,r[t]=e.Location_Cid,t++,r[t]="",t++,r[t]=e.alfanumeric,t++,r[t]=e.vip,t++,r[t]=e.Grade,t++,r[t]=this.filoData[d].Sub_Dept,t++,r[t]=this.filoData[d].ContractorName,t++,r[t]=this.filoData[d].TypeDesc,t++;let a=i.addRow(r);a.alignment={vertical:"middle",horizontal:"center"},a.eachCell(t=>{t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}}i.getColumn(1).width=15,i.getColumn(2).width=20,i.getColumn(3).width=25,i.getColumn(4).width=25,i.getColumn(5).width=12,i.getColumn(14).width=12,i.getColumn(32).width=15,a.xlsx.writeBuffer().then(t=>{let a=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});w.saveAs(a,"TimeAttendance_FILO_Report_"+e+".xlsx")}),this.ngxuiloader.stop()}multiplePunchesPDFReport(){var t=new f.jsPDF("l","pt","a4");const e=this.datepipe.transform(new Date,"d MMM y, h:mm:ss a"),a=this.datepipe.transform(new Date,"dd/MM/yyyy-h:mm:ss a");var i=t.internal.pageSize.width||t.internal.pageSize.getWidth(),n=t.internal.pageSize.height||t.internal.pageSize.getHeight();t.setFontSize(8),t.text("Multiple Punches Time Attendance Report",i/2,20,{align:"center"}),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center"}),t.text(""+e,i-20,30,{align:"right"}),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.line(20,40,i-20,40);let o=["Date","Shift","Shift Start Time","Shift End Time","LunchIn","LunchOut","TimeIn","TimeOut","Total","DayTotal","Attendance","Edit Status","Late","Early Go","Base Hour","OT"],s=20;t.setFontSize(8);for(let g of o)t.text(g,s,60,{maxWidth:45}),s+=50;t.line(20,85,i-20,85),t.setFontSize(8);let l=1,r=100;s=30;let d=i/4,h=10;for(let g=0;g<this.multiplePunchData.length;g++){if(0==l){s=20,t.setFontSize(8);for(let e of o)t.text(e,s,60,{maxWidth:45}),s+=50;t.line(20,85,i-20,85),t.setFontSize(8),t.text("Multiple Punches Time Attendance Report",i/2,20,{align:"center",renderingMode:"stroke"}),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center",renderingMode:"stroke"}),t.text(""+e,i-20,30,{align:"right"}),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.line(20,40,i-20,40),r=100,s=30,d=i/4,h=10}h=10,t.setFontSize(8),t.text("ID : "+this.multiplePunchData[g].ID,s,r,{align:"left"}),t.text("NAME : "+this.multiplePunchData[g].Name,s+100,r,{align:"left"}),t.text("DEPARTMENT : "+this.multiplePunchData[g].dept,s+250,r,{align:"left"}),t.text("DESIGNATION : "+this.multiplePunchData[g].desig,s+400,r,{align:"left"}),t.text("ALPHANUMERIC : "+this.multiplePunchData[g].Alfanumeric,s+600,r,{align:"left"}),t.setFontSize(8),t.line(20,r+10,i-20,r+10);let a=20;r+=20;for(let l=0;l<this.multiplePunchData[g].mta.length;l++)if(t.setTextColor(0,0,255),t.text(this.multiplePunchData[g].mta[l].RealDate.substring(0,5),a,r,{renderingMode:"fill"}),t.text(this.multiplePunchData[g].mta[l].InTime,a+300,r),t.text(this.multiplePunchData[g].mta[l].OutTime,a+350,r),t.text(this.multiplePunchData[g].mta[l].Type,a+500,r),t.setTextColor(0,0,0),t.text(this.multiplePunchData[g].mta[l].Shift,a+50,r,{renderingMode:"fill",maxWidth:50}),t.text(this.multiplePunchData[g].mta[l].ShiftStart.substring(0,5),a+100,r),t.text(this.multiplePunchData[g].mta[l].ShiftEnd.substring(0,5),a+150,r),t.text(this.multiplePunchData[g].mta[l].LunchOut.substring(0,5),a+200,r),t.text(this.multiplePunchData[g].mta[l].LunchIn.substring(0,5),a+250,r),t.text(this.multiplePunchData[g].mta[l].DayTotalMultiple,a+400,r),t.text(this.multiplePunchData[g].mta[l].DayTotalRecurrence,a+450,r),t.text("",a+550,r),t.text(this.multiplePunchData[g].mta[l].Late,a+600,r),t.text(this.multiplePunchData[g].mta[l].Early,a+650,r),t.text(this.multiplePunchData[g].mta[l].BaseHr,a+700,r),t.text(this.multiplePunchData[g].mta[l].OT_MTA,a+750,r),r+=20,r+30>n){t.addPage("a4","l"),s=20,t.setFontSize(8);for(let e of o)t.text(e,s,60,{maxWidth:45}),s+=50;t.line(20,85,i-20,85),t.setFontSize(8),t.text("Multiple Punches Time Attendance Report",i/2,20,{align:"center",renderingMode:"fill"}).setFillColor("#FFFFFF"),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center",renderingMode:"fill"}),t.text(""+e,i-20,30,{align:"right"}),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.line(20,40,i-20,40),r=100,s=30,d=i/4,h=10}t.line(20,r,i-20,r),r+=10,l+=1,r+100>n&&(t.addPage("a4","l"),l=0)}t.save("Multiple Punches Time Attendance Report-"+a+".pdf")}multiplePunchesExcelReport(){this.ngxuiloader.start();const t=this.common.getLocalStorage().ClientName,e=this.datepipe.transform(new Date,"dd/MM/yyyy");let a=new q.Workbook,i=a.addWorksheet("Multiple Punches Time Attendance Report"),n=i.addRow(["Multiple Punches Time Attendance Report"]);i.addRow([t]),n.font={name:"Comic Sans MS",family:4,size:16,underline:"double",bold:!0},i.addRow(["Report Generation Date : "+this.datepipe.transform(new Date,"dd MMM yyyy")]);let o="From : "+this.datepipe.transform(this.daterange[0],"dd MMM yyyy"),s="To : "+this.datepipe.transform(this.daterange[1],"dd MMM yyyy");i.addRow([o]),i.addRow([s]),i.addRow([]);let l=i.addRow(["ID","NAME","DEPARTMENT","DESIGNATION","INDATE","SHIFT-ID","SHIFT_DESC","SHIFT_START","SHIFT_END","LUNCHOUT","LUNCHIN","INTIME","INSTATUS","OUTDATE","OUTTIME","OUTSTATUS","TOTAL","STATUS","MANUALEDIT","INGRACE","OUTGRACE","LATEUPTO","EARLYGO","LATE","EARLY","BASEHR","OT","DAYTOTALMULTIPLE","TIMEDIFF","LOCATION_CID","LOCATION_NAME","ALPHANUMERIC","VIP","GRADE","SUB-DEPT-NAME","CONTRACTOR_NAME","TYPE_DESC"]);l.font={size:12,bold:!0},l.eachCell((t,e)=>{t.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"},bgColor:{argb:"FF0000FF"}},t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}});let r=[];for(let d=0;d<this.multiplePunchData.length;d++){r=[],r[1]=Number(this.multiplePunchData[d].ID),r[2]=this.multiplePunchData[d].Name,r[3]=this.multiplePunchData[d].dept,r[4]=this.multiplePunchData[d].desig;let t=5;for(let e of this.multiplePunchData[d].mta){t=5,r[t]=e.RealDate,t++,r[t]=null==e.ShiftId?"":Number(e.ShiftId),t++,r[t]=e.Shift,t++,r[t]=e.ShiftStart,t++,r[t]=e.ShiftEnd,t++,r[t]=e.LunchOut,t++,r[t]=e.LunchIn,t++,r[t]=e.InTime,t++,r[t]="",t++,r[t]=e.OutDate,t++,r[t]=e.OutTime,t++,r[t]="",t++,r[t]=e.DayTotal,t++,r[t]=e.Type,t++,r[t]=e.ManualEdit,t++,r[t]=null==e.Ingrace?"":Number(e.Ingrace),t++,r[t]=null==e.Outgrace?"":Number(e.Outgrace),t++,r[t]=e.LateUpto,t++,r[t]=e.Earlygo,t++,r[t]=e.Late,t++,r[t]=e.Early,t++,r[t]=e.BaseHr,t++,r[t]=e.OT_MTA,t++,r[t]=e.DayTotalMultiple,t++,r[t]="",t++,r[t]=null==e.Location_Cid?"":Number(e.Location_Cid),t++,r[t]=e.In_Location_Cname,t++,r[t]=this.multiplePunchData[d].Alfanumeric,t++,r[t]=e.Vip,t++,r[t]="",t++,r[t]=this.multiplePunchData[d].Sub_Dept,t++,r[t]=this.multiplePunchData[d].ContractorName,t++,r[t]=this.multiplePunchData[d].TypeDesc,t++;let a=i.addRow(r);a.alignment={vertical:"middle",horizontal:"center"},a.eachCell(t=>{t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}}i.getColumn(1).width=15,i.getColumn(2).width=20,i.getColumn(3).width=25,i.getColumn(4).width=25,i.getColumn(5).width=12,i.getColumn(14).width=12,i.getColumn(32).width=15,a.xlsx.writeBuffer().then(t=>{let a=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});w.saveAs(a,"Multiple Punches Time Attendance Report_"+e+".xlsx")}),this.ngxuiloader.stop()}attendanceExcelReport(){let t=[];for(let e=0;e<this.tabledata.length;e++)t.push([Number(this.tabledata[e].Id),this.tabledata[e].name,this.tabledata[e].Dept,this.tabledata[e].Sub_Dept,this.tabledata[e].Desig,this.tabledata[e].InPunchDate,this.tabledata[e].InPunchTime,this.tabledata[e].InPunchStatus,this.tabledata[e].OutPunchDate,this.tabledata[e].OutPunchTime,this.tabledata[e].OutPunchStatus,this.tabledata[e].DayTotal,this.tabledata[e].Type,this.tabledata[e].ContractorName,this.tabledata[e].TypeDesc]);this.generateExcelReport("Attendance_Report","Attendance Report",["ID","NAME","DEPARTMENT","SUB-DEPARTMENT","DESIGNATION","INDATE","INTIME","INSTATUS","OUTDATE","OUTTIME","OUTSTATUS","DAYTOTAL","DAYSTATUS","CONTRACTOR NAME","TYPE_DESC"],t)}attendancePdfReport(){var t=new f.jsPDF("l","pt","a4");const e=this.datepipe.transform(new Date,"d MMM y, h:mm:ss a"),a=this.datepipe.transform(new Date,"dd/MM/yyyy-h:mm:ss a");var i=t.internal.pageSize.width||t.internal.pageSize.getWidth(),n=t.internal.pageSize.height||t.internal.pageSize.getHeight();t.setFontSize(8),t.text("ATTENDANCE REPORT",i/2,20,{align:"center"}),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center"}),t.text(""+e,i-20,30,{align:"right"}),t.line(20,40,i-20,40),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"});let o=1,s=60,l=30,r=i/4,d=10;for(let h=0;h<this.attendanceData.length;h++){0==o&&(t.setFontSize(8),t.text("ATTENDANCE REPORT",i/2,20,{align:"center",renderingMode:"fill"}).setFillColor("#FFFFFF"),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center",renderingMode:"fill"}),t.text(""+e,i-20,30,{align:"right"}),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.line(20,40,i-20,40),s=60,l=30,r=i/4,d=10),d=10,t.setFontSize(8),t.text("ID : "+this.attendanceData[h].Id,l,s,{align:"left"}),t.text("NAME : "+this.attendanceData[h].name,l+100,s,{align:"left"}),t.text("DEPARTMENT : "+this.attendanceData[h].Dept,l+250,s,{align:"left"}),t.text("DESIGNATION : "+this.attendanceData[h].Desig,l+400,s,{align:"left"}),t.text("ALPHANUMERIC : "+this.attendanceData[h].Alfanumeric,l+600,s,{align:"left"}),console.log(this.attendanceData[h]),t.line(20,s+10,i-20,s+10),t.setFontSize(7),t.text("Date",20,s+20),t.text("Day",20,s+d+25),d+=15,t.text("IN",20,s+d+30),d+=15,t.text("OUT",20,s+d+30),d+=15,t.text("TOTAL",20,s+d+30),d+=15,t.text("STATUS",20,s+d+30),d+=15,t.line(20,s+d+20,i-20,s+d+20),t.line(20,s+23,i-20,s+23);let a=60;t.setFontSize(7);for(let e=0;e<this.attendanceData[h].info.length;e++)t.text(this.attendanceData[h].info[e].InPunchDate,a,s+20,{renderingMode:"fill"}),t.text(this.attendanceData[h].info[e].InPunchDay.substring(0,3),a,s+35,{renderingMode:"fill"}),t.text(this.attendanceData[h].info[e].InPunchTime.substring(0,5),a,s+50),t.text(this.attendanceData[h].info[e].OutPunchTime.substring(0,5),a,s+65),t.text(this.attendanceData[h].info[e].DayTotal.substring(0,5),a,s+80),t.text(this.attendanceData[h].info[e].Type,a,s+95),a+=25;s+=120,o+=1,s+100>n&&(t.addPage("a4","l"),o=0)}t.save("Attendance_report-"+a+".pdf")}summaryExcelReport(){this.ngxuiloader.start();let t=["CID","ID","NAME","DEPARTMENT","DESIGNATION","DATE"];for(let p=0;p<this.summaryDateArray.length;p++)t[p+6]=this.summaryDateArray[p];let e=["TotalFilo","Present","Absent","Holiday","Weekly Off","Pending Off","Night Off","Valley Off","Half Day","Policy","Leaves","Tour","Late","Early Go","Late Days","EarlyGo Days","LWP","TotalMTA","ParentCID","Parent Name","Location Name","Effective Date","Alphanumeric Id","Leave Late","LWP Late","Grade","SubDepartment","Contractor Name","Type Desc"],a=t.length;for(let p of e)t[a]=p,a++;const i=this.common.getLocalStorage().ClientName,n=this.datepipe.transform(new Date,"dd/MM/yyyy");let o=new q.Workbook,s=o.addWorksheet("Summary Report"),l=s.addRow(["Summary Report"]);s.addRow([i]),l.font={name:"Comic Sans MS",family:4,size:16,underline:"double",bold:!0},s.addRow(["Report Generation Date : "+this.datepipe.transform(new Date,"dd MMM yyyy")]);let r="From : "+this.datepipe.transform(this.daterange[0],"dd MMM yyyy"),d="To : "+this.datepipe.transform(this.daterange[1],"dd MMM yyyy");s.addRow([r]),s.addRow([d]),s.addRow([]);let h=s.addRow(t);h.font={size:12,bold:!0},h.eachCell((t,e)=>{t.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"},bgColor:{argb:"FF0000FF"}},t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}});let g=[];for(let p=0;p<this.summarydata.length;p++){g[1]=Number(this.summarydata[p].cid),g[2]=Number(this.summarydata[p].id),g[3]=this.summarydata[p].name,g[4]=this.summarydata[p].dept,g[5]=this.summarydata[p].desig,g[6]="Day";let t=7;for(let i of this.summarydata[p].weekday)null!=i&&(g[t]=i,t++);g[t]=this.summarydata[p].totalmformonth,t++,g[t]=this.summarydata[p].present,t++,g[t]=this.summarydata[p].absent,t++,g[t]=this.summarydata[p].holiday,t++,g[t]=this.summarydata[p].weeklyof,t++,g[t]=this.summarydata[p].Pendingoff,t++,g[t]=this.summarydata[p].Nightoff,t++,g[t]=this.summarydata[p].Valleyoff,t++,g[t]=this.summarydata[p].halfDay,t++,g[t]=this.summarydata[p].policy,t++,g[t]=this.summarydata[p].leave,t++,g[t]=this.summarydata[p].tour,t++,g[t]=this.summarydata[p].late,t++,g[t]=this.summarydata[p].early,t++,g[t]=this.summarydata[p].ltdays,t++,g[t]=this.summarydata[p].erdays,t++,g[t]=this.summarydata[p].LWP,t++,g[t]="",t++,g[t]=null==this.summarydata[p].ParentCid?"":this.summarydata[p].ParentCid,t++,g[t]=null==this.summarydata[p].ParentName?"":this.summarydata[p].ParentName,t++,g[t]=null==this.summarydata[p].LocationName?"":this.summarydata[p].LocationName,t++,g[t]=null==this.summarydata[p].EffectiveDate?"":this.summarydata[p].EffectiveDate,t++,g[t]=this.summarydata[p].alfanumeric,t++,g[t]=this.summarydata[p].Leave_Late,t++,g[t]=this.summarydata[p].LWP_Late,t++,g[t]=this.summarydata[p].Grade,t++,g[t]=this.summarydata[p].Subdept,t++,g[t]=this.summarydata[p].ContractorName,t++,g[t]=this.summarydata[p].TypeDesc,t++;let e=s.addRow(g);e.alignment={vertical:"middle",horizontal:"center"},e.eachCell(t=>{t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}});let a=[];a[6]="IN",t=7;for(let i of this.summarydata[p].intime)null!=i&&(a[t]=i,t++);e=s.addRow(a),e.alignment={vertical:"middle",horizontal:"center"},e.eachCell(t=>{t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),a=[],a[6]="OUT",t=7;for(let i of this.summarydata[p].outtime)null!=i&&(a[t]=i,t++);e=s.addRow(a),e.alignment={vertical:"middle",horizontal:"center"},e.eachCell(t=>{t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),a=[],a[6]="TOTAL",t=7;for(let i of this.summarydata[p].total)null!=i&&(a[t]=i,t++);e=s.addRow(a),e.alignment={vertical:"middle",horizontal:"center"},e.eachCell(t=>{t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),a=[],a[6]="STATUS",t=7;for(let i of this.summarydata[p].status)null!=i&&(a[t]=i,t++);e=s.addRow(a),e.alignment={vertical:"middle",horizontal:"center"},e.eachCell(t=>{t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}s.getColumn(2).width=15,s.getColumn(3).width=25,s.getColumn(4).width=25,s.getColumn(5).width=25,o.xlsx.writeBuffer().then(t=>{let e=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});w.saveAs(e,"Summary_Report_"+n+".xlsx")}),this.ngxuiloader.stop()}summaryPdfReport(){var t=new f.jsPDF("l","pt","a4");const e=this.datepipe.transform(new Date,"d MMM y, h:mm:ss a"),a=this.datepipe.transform(new Date,"dd/MM/yyyy-h:mm:ss a");var i=t.internal.pageSize.width||t.internal.pageSize.getWidth(),n=t.internal.pageSize.height||t.internal.pageSize.getHeight();t.setFontSize(8),t.text("SUMMARY REPORT",i/2,20,{align:"center"}),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center"}),t.text(""+e,i-20,30,{align:"right"}),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.line(20,40,i-20,40);let o=1,s=60,l=30,r=i/4,d=10;for(let h=0;h<this.summarydata.length;h++){0==o&&(t.setFontSize(8),t.text("SUMMARY REPORT",i/2,20,{align:"center",renderingMode:"fill"}).setFillColor("#FFFFFF"),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center",renderingMode:"fill"}),t.text(""+e,i-20,30,{align:"right"}),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.line(20,40,i-20,40),s=60,l=30,r=i/4,d=10),d=10,t.setFontSize(8),t.text("ID : "+this.summarydata[h].id,l,s,{align:"left"}),t.text("NAME : "+this.summarydata[h].name,l+100,s,{align:"left"}),t.text("DEPARTMENT : "+this.summarydata[h].dept,l+250,s,{align:"left"}),t.text("DESIGNATION : "+this.summarydata[h].desig,l+400,s,{align:"left"}),t.text("ALPHANUMERIC : "+this.summarydata[h].alfanumeric,l+600,s,{align:"left"}),t.line(20,s+10,i-20,s+10),t.setFontSize(7),t.text("Date",20,s+20),t.text("Day",20,s+d+25),d+=12,t.text("IN",20,s+d+30),d+=13,t.text("OUT",20,s+d+30),d+=13,t.text("TOTAL",20,s+d+30),d+=17,t.text("STATUS",20,s+d+30),d+=15,t.line(20,s+d+20,i-20,s+d+20),t.setFontSize(8),t.text("FILO Total : "+this.summarydata[h].totalmformonth+"     Present : "+this.summarydata[h].present+"     Absent : "+this.summarydata[h].absent+"     Holidays : "+this.summarydata[h].holiday+"     WeeklyOff : "+this.summarydata[h].weeklyof+"     Leaves : "+this.summarydata[h].leave+"     LWP : "+this.summarydata[h].LWP+"     Tour : "+this.summarydata[h].tour+"     HalfDays : "+this.summarydata[h].halfDay+"     Late : "+this.summarydata[h].late+"     Early : "+this.summarydata[h].early+"     LateDay : "+this.summarydata[h].ltdays+"     Early Days : "+this.summarydata[h].erdays,20,s+115),t.setFontSize(7),t.line(20,s+120,i-20,s+120);let a=60;for(let e=0;e<this.summarydata[h].intime.length&&null!=this.summarydata[h].intime[e];e++)t.text(this.summaryDateArray[e].toString(),a,s+20,{renderingMode:"fill"}),t.text(this.summarydata[h].weekday[e],a,s+35,{renderingMode:"fill"}),t.text(this.summarydata[h].intime[e].substring(0,5),a,s+50),t.text(this.summarydata[h].outtime[e].substring(0,5),a,s+65),t.text(this.summarydata[h].total[e].substring(0,5),a,s+80),t.text(this.summarydata[h].status[e],a,s+95),a+=25;s+=135,o+=1,s+100>n&&(t.addPage("a4","l"),o=0)}t.save("Summary_report-"+a+".pdf")}musterExcelReport(){this.ngxuiloader.start();let t=["CID","ID","NAME","DEPARTMENT","DESIGNATION","DATE"];for(let c=0;c<this.summaryDateArray.length;c++)t[c+6]=this.summaryDateArray[c];let e=["TotalFilo","Present","Absent","Holiday","Weekly Off","Pending Off","Night Off","Valley Off","Half Day","Policy","Leaves","Tour","Late","Early Go","Late Days","EarlyGo Days","LWP","TotalMTA","ParentCID","Parent Name","Location Name","Effective Date","Alphanumeric Id","Leave Late","LWP Late","Grade","SubDepartment","Contractor Name","Type Desc"],a=t.length;for(let c of e)t[a]=c,a++;const i=this.common.getLocalStorage().ClientName,n=this.datepipe.transform(new Date,"dd/MM/yyyy");let o=new q.Workbook,s=o.addWorksheet("Muster Report"),l=s.addRow(["Muster Report"]);s.addRow([i]),l.font={name:"Comic Sans MS",family:4,size:16,underline:"double",bold:!0},s.addRow(["Report Generation Date : "+this.datepipe.transform(new Date,"dd MMM yyyy")]);let r="From : "+this.datepipe.transform(this.daterange[0],"dd MMM yyyy"),d="To : "+this.datepipe.transform(this.daterange[1],"dd MMM yyyy");s.addRow([r]),s.addRow([d]),s.addRow([]);let h=s.addRow(t);h.font={size:12,bold:!0},h.eachCell((t,e)=>{t.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"},bgColor:{argb:"FF0000FF"}},t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}});let g=[];g[6]="Day";let p=7;for(let c of this.dayarray)g[p]=c,p++;let m=s.addRow(g);m.font={size:12,bold:!0},m.alignment={vertical:"middle",horizontal:"center"},m.eachCell(t=>{t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),g=[];for(let c=0;c<this.musterData.length;c++){g[1]=Number(this.musterData[c].cid),g[2]=Number(this.musterData[c].id),g[3]=this.musterData[c].name,g[4]=this.musterData[c].dept,g[5]=this.musterData[c].desig,g[6]="Status";let t=7;for(let a of this.musterData[c].status)null!=a&&(g[t]=a,t++);g[t]=this.musterData[c].totalmformonth,t++,g[t]=this.musterData[c].present,t++,g[t]=this.musterData[c].absent,t++,g[t]=this.musterData[c].holiday,t++,g[t]=this.musterData[c].weeklyof,t++,g[t]=this.musterData[c].Pendingoff,t++,g[t]=this.musterData[c].Nightoff,t++,g[t]=this.musterData[c].Valleyoff,t++,g[t]=this.musterData[c].halfDay,t++,g[t]=this.musterData[c].policy,t++,g[t]=this.musterData[c].leave,t++,g[t]=this.musterData[c].tour,t++,g[t]=this.musterData[c].late,t++,g[t]=this.musterData[c].early,t++,g[t]=this.musterData[c].ltdays,t++,g[t]=this.musterData[c].erdays,t++,g[t]=this.musterData[c].LWP,t++,g[t]="",t++,g[t]=null==this.musterData[c].ParentCid?"":this.musterData[c].ParentCid,t++,g[t]=null==this.musterData[c].ParentName?"":this.musterData[c].ParentName,t++,g[t]=null==this.musterData[c].LocationName?"":this.musterData[c].LocationName,t++,g[t]=null==this.musterData[c].EffectiveDate?"":this.musterData[c].EffectiveDate,t++,g[t]=this.musterData[c].alfanumeric,t++,g[t]=this.musterData[c].Leave_Late,t++,g[t]=this.musterData[c].LWP_Late,t++,g[t]=this.musterData[c].Grade,t++,g[t]=this.musterData[c].Subdept,t++,g[t]=this.musterData[c].ContractorName,t++,g[t]=this.musterData[c].TypeDesc,t++;let e=s.addRow(g);e.alignment={vertical:"middle",horizontal:"center"},e.eachCell(t=>{t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}s.getColumn(2).width=15,s.getColumn(3).width=25,s.getColumn(4).width=25,s.getColumn(5).width=25,o.xlsx.writeBuffer().then(t=>{let e=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});w.saveAs(e,"Muster_Report_"+n+".xlsx")}),this.ngxuiloader.stop()}musterPdfReport(){var t=new f.jsPDF("l","pt","a4");const e=this.datepipe.transform(new Date,"d MMM y, h:mm:ss a"),a=this.datepipe.transform(new Date,"dd/MM/yyyy-h:mm:ss a");var i=t.internal.pageSize.width||t.internal.pageSize.getWidth(),n=t.internal.pageSize.height||t.internal.pageSize.getHeight();t.setFontSize(8),t.text("MUSTER REPORT",i/2,20,{align:"center"}),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center"}),t.text(""+e,i-20,30,{align:"right"}),t.setFontSize(8),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.setFontSize(7),t.line(20,40,i-20,40);let o=1,s=60,l=30,r=i/4,d=10;for(let h=0;h<this.musterData.length;h++){0==o&&(t.setFontSize(8),t.text("MUSTER REPORT",i/2,20,{align:"center",renderingMode:"fill"}).setFillColor("#FFFFFF"),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center",renderingMode:"fill"}),t.text(""+e,i-20,30,{align:"right"}),t.setFontSize(8),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.line(20,40,i-20,40),t.setFontSize(7),s=60,l=30,r=i/4,d=10),d=10,t.setFontSize(8),t.text("ID : "+this.musterData[h].id,l,s,{align:"left"}),t.text("NAME : "+this.musterData[h].name,l+100,s,{align:"left"}),t.text("DEPARTMENT : "+this.musterData[h].dept,l+250,s,{align:"left"}),t.text("DESIGNATION : "+this.musterData[h].desig,l+400,s,{align:"left"}),t.text("ALPHANUMERIC : "+this.musterData[h].alfanumeric,l+600,s,{align:"left"}),t.line(20,s+10,i-20,s+10),t.setFontSize(6),t.text("Date",20,s+20),t.text("STATUS",20,s+d+30),t.line(20,s+d+45,i-20,s+d+45),t.setFontSize(8),t.text("Present : "+this.musterData[h].present+"     Absent : "+this.musterData[h].absent+"     Holidays : "+this.musterData[h].holiday+"     WeeklyOff : "+this.musterData[h].weeklyof+"     Leaves : "+this.musterData[h].leave+"     LWP : "+this.musterData[h].LWP+"     Tour : "+this.musterData[h].tour+"     HalfDays : "+this.musterData[h].halfDay,20,s+65),t.setFontSize(7),t.line(20,s+70,i-20,s+70);let a=60;for(let e=0;e<this.musterData[h].status.length&&null!=this.musterData[h].status[e];e++)t.text(this.summaryDateArray[e].toString(),a,s+20,{renderingMode:"fill"}),t.text(this.musterData[h].status[e],a,s+40,{maxWidth:20}),a+=25;s+=80,o+=1,s+100>n&&(t.addPage("a4","l"),o=0)}t.save("Muster_report-"+a+".pdf")}employeeInsidePremisesPDFReport(){var t=new f.jsPDF("p","pt","a4");let e="EMPLOYEE INSIDE PREMISES";const a=this.datepipe.transform(new Date,"d MMM y, h:mm:ss a"),i=this.datepipe.transform(new Date,"dd/MM/yyyy-h:mm:ss a");var n=t.internal.pageSize.width||t.internal.pageSize.getWidth(),o=t.internal.pageSize.height||t.internal.pageSize.getHeight();t.setFontSize(8),t.text(e,n/2,20,{align:"center"}),t.text(this.common.getLocalStorage().ClientName,n/2,30,{align:"center"}),t.text(""+a,n-20,30,{align:"right"}),t.setFontSize(8),t.text("Date : "+this.datepipe.transform(this._date,"dd/MM/yyyy")+"  Time : "+this.datepipe.transform(this.time,"HH:mm"),20,30,{align:"left"}),t.setFontSize(7),t.line(20,40,n-20,40),t.setFontSize(8),t.text("ID",30,60,{align:"left"}),t.text("NAME",80,60,{align:"left"}),t.text("DEPARTMENT",180,60,{align:"left"}),t.text("DESIGNATION",260,60,{align:"left"}),t.text("ALPHANUMERIC-ID",360,60,{align:"left"}),t.text("INDATE",460,60,{align:"left"}),t.text("INTIME",520,60,{align:"left"}),t.line(20,70,n-20,70),t.line(20,t.internal.pageSize.height-20,n-20,t.internal.pageSize.height-20),t.text("Total No. Of Employees : "+this.EmployeeInsidePremisesData.length,n-200,t.internal.pageSize.height-10);let s=1,l=80,r=10;for(let d=0;d<this.EmployeeInsidePremisesData.length;d++)0==s&&(t.setFontSize(8),t.text(e,n/2,20,{align:"center",renderingMode:"fill"}).setFillColor("#FFFFFF"),t.text(this.common.getLocalStorage().ClientName,n/2,30,{align:"center",renderingMode:"fill"}),t.text(""+a,n-20,30,{align:"right"}),t.setFontSize(8),t.text("Date : "+this._date,20,30,{align:"left"}),t.line(20,40,n-20,40),t.setFontSize(8),t.text("ID",30,60,{align:"left"}),t.text("NAME",80,60,{align:"left"}),t.text("DEPARTMENT",180,60,{align:"left"}),t.text("DESIGNATION",260,60,{align:"left"}),t.text("ALPHANUMERIC-ID",360,60,{align:"left"}),t.text("INDATE",460,60,{align:"left"}),t.text("INTIME",520,60,{align:"left"}),t.line(20,70,n-20,70),t.line(20,t.internal.pageSize.height-20,n-20,t.internal.pageSize.height-20),t.text("Total No. Of Employees : "+this.EmployeeInsidePremisesData.length,50,t.internal.pageSize.height-10)),r=10,t.setFontSize(7),t.text(this.EmployeeInsidePremisesData[d].EmpId,20,l),t.text(this.EmployeeInsidePremisesData[d].Name,80,l,{maxWidth:95}),t.text(this.EmployeeInsidePremisesData[d].Department,180,l),t.text(this.EmployeeInsidePremisesData[d].Designation,260,l),t.text(this.EmployeeInsidePremisesData[d].Alfanumeric,360,l),t.text(this.EmployeeInsidePremisesData[d].Date,460,l),t.text(this.EmployeeInsidePremisesData[d].Time,520,l),l+=10,s+=1,l+100>o&&(t.addPage("a4","p"),s=0);t.save("Employee_Inside_Premises-"+i+".pdf")}employeeInsidePremisesExcelReport(){this.ngxuiloader.start();let t=[];for(let h=0;h<this.EmployeeInsidePremisesData.length;h++){let e=this.EmployeeInsidePremisesData[h];t.push([Number(e.EmpId),e.Name,e.Department,e.Designation,e.Alfanumeric,e.Date,e.Time])}const e=this.common.getLocalStorage().ClientName,a=t,i=this.datepipe.transform(new Date,"dd/MM/yyyy");let n=new q.Workbook,o=n.addWorksheet("Muster Report"),s=o.addRow(["Employee Inside Premises Report"]);o.addRow([e]),s.font={name:"Comic Sans MS",family:4,size:16,underline:"double",bold:!0},o.addRow(["Report Generation Date : "+this.datepipe.transform(new Date,"dd MMM yyyy")]);let l="Date : "+this.datepipe.transform(this._date,"dd MMM yyyy"),r="Time : "+this.datepipe.transform(this.time,"HH:mm");o.addRow([l]),o.addRow([r]),o.addRow(["Total No. Of Employees : "+this.EmployeeInsidePremisesData.length]),o.addRow([]);let d=o.addRow(["ID","NAME","DEPARTMENT","DESIGNATION","ALPHANUMERIC-ID","INDATE","INTIME"]);d.font={size:12,bold:!0},d.eachCell((t,e)=>{t.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"},bgColor:{argb:"FF0000FF"}},t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),a.forEach(t=>{o.addRow(t).eachCell(t=>{t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}),o.getColumn(1).width=15,o.getColumn(2).width=20,o.getColumn(3).width=20,o.getColumn(4).width=20,o.getColumn(5).width=20,o.getColumn(5).width=15,o.getColumn(5).width=15,n.xlsx.writeBuffer().then(t=>{let e=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});w.saveAs(e,"Employee_Inside_Premises_Report_"+i+".xlsx")}),this.ngxuiloader.stop()}generateExcelReport(t,e,a,i){this.ngxuiloader.start();const n=this.common.getLocalStorage().ClientName,o=i,s=this.datepipe.transform(new Date,"dd/MM/yyyy");let l=new q.Workbook,r=l.addWorksheet(e),d=r.addRow([e]);r.addRow([n]),d.font={name:"Comic Sans MS",family:4,size:16,underline:"double",bold:!0},r.addRow(["Report Generation Date : "+this.datepipe.transform(new Date,"dd MMM yyyy")]);let h="From : "+this.datepipe.transform(this.daterange[0],"dd MMM yyyy"),g="To : "+this.datepipe.transform(this.daterange[1],"dd MMM yyyy");r.addRow([h]),r.addRow([g]),r.addRow([]);let p=r.addRow(a);p.font={size:12,bold:!0},p.eachCell((t,e)=>{t.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"},bgColor:{argb:"FF0000FF"}},t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),o.forEach(t=>{let e=r.addRow(t);e.alignment={vertical:"middle",horizontal:"center"},e.eachCell(t=>{t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}),r.getColumn(1).width=15,r.getColumn(2).width=20,r.getColumn(3).width=12,r.getColumn(4).width=13,r.getColumn(5).width=30,r.getColumn(6).width=13,r.getColumn(7).width=13,r.getColumn(8).width=15,r.getColumn(9).width=13,r.getColumn(10).width=15,r.getColumn(11).width=13,r.getColumn(12).width=15,r.getColumn(13).width=15,r.addRow([]);let m=r.addRow(["This is system generated excel sheet."]);m.getCell(1).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFCCFFE5"}},m.getCell(1).border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},r.mergeCells(`A${m.number}:M${m.number}`),l.xlsx.writeBuffer().then(e=>{let a=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});w.saveAs(a,t+"_"+s+".xlsx")}),this.ngxuiloader.stop()}absentExcelReport(){this.ngxuiloader.start();let t=[];for(let h=0;h<this.absentData.length;h++)t.push([Number(this.absentData[h].id),this.absentData[h].Alfanumeric,this.absentData[h].name,this.absentData[h].Dept,this.absentData[h].Desig,this.absentData[h].RealDate,"ABSENT",this.absentData[h].ContractorName,this.absentData[h].TypeDesc]);const e=this.common.getLocalStorage().ClientName,a=t,i=this.datepipe.transform(new Date,"dd/MM/yyyy");let n=new q.Workbook,o=n.addWorksheet("Absent Report"),s=o.addRow(["Absent Report"]);o.addRow([e]),s.font={name:"Comic Sans MS",family:4,size:16,underline:"double",bold:!0},o.addRow(["Report Generation Date : "+this.datepipe.transform(new Date,"dd MMM yyyy")]);let l="From : "+this.datepipe.transform(this.daterange[0],"dd MMM yyyy"),r="To : "+this.datepipe.transform(this.daterange[1],"dd MMM yyyy");o.addRow([l]),o.addRow([r]),o.addRow([]);let d=o.addRow(["ID","ALPHA-NUMERIC ID","NAME","DEPARTMENT","DESIGNATION","DATE","STATUS","CONTRACTOR_NAME","TYPE_DESC"]);d.font={size:12,bold:!0},d.eachCell((t,e)=>{t.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"},bgColor:{argb:"FF0000FF"}},t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),a.forEach(t=>{let e=o.addRow(t);e.alignment={vertical:"middle"},e.eachCell(t=>{t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}),o.getColumn(1).width=20,o.getColumn(2).width=20,o.getColumn(3).width=25,o.getColumn(4).width=25,o.getColumn(5).width=25,n.xlsx.writeBuffer().then(t=>{let e=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});w.saveAs(e,"Absent_Report_"+i+".xlsx")}),this.ngxuiloader.stop()}absentPdfReport(){this.ngxuiloader.start();var t=new f.jsPDF("p","pt","a4");let e=[];for(let s=0;s<this.absentData.length;s++)e.push([Number(this.absentData[s].id),this.absentData[s].Alfanumeric,this.absentData[s].name,this.absentData[s].Dept,this.absentData[s].Desig,this.absentData[s].RealDate,"ABSENT"]);const a=this.datepipe.transform(new Date,"d MMM y, h:mm:ss a"),i=this.datepipe.transform(new Date,"dd/MM/yyyy-h:mm:ss a");var n=t.internal.pageSize.width||t.internal.pageSize.getWidth();t.internal.pageSize.height||t.internal.pageSize.getHeight(),t.setFontSize(8),t.text("ABSENT REPORT",n/2,20,{align:"center"}),t.text(this.common.getLocalStorage().ClientName,n/2,30,{align:"center"}),t.text(""+a,n-20,30,{align:"right"}),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.line(20,40,n-20,40);const o=e;y()(t,{startY:70,styles:{cellPadding:5,fontSize:8,valign:"middle",halign:"center"},theme:"striped",head:[["ID","ALPHA-NUMERIC ID","NAME","DEPARTMENT","DESIGNATION","DATE","STATUS"]],body:o,margin:{top:20},headStyles:{fillColor:[255,178,155],textColor:[0,0,0],fontSize:8,cellPadding:2}}),t.save("Absent_report-"+i+".pdf"),this.ngxuiloader.stop()}generatePDF(){}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(s.F),p.Y36(m.v),p.Y36(v._W),p.Y36(d.uU),p.Y36(g.LA))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-attendance-reports"]],viewQuery:function(t,e){if(1&t&&p.Gf(I,5),2&t){let t;p.iGM(t=p.CRH())&&(e.empsearch=t.first)}},decls:40,vars:13,consts:[[1,"py-2","container-flex"],[1,"row"],[1,"col-sm-6",2,"border-right","1px solid"],[1,"row","mb-3"],["for","input1",1,"col-sm-4","col-form-label",2,"font-weight","bold"],[2,"color","red"],[1,"col-sm-8"],["name","selectedReports",1,"browser-default","custom-select",3,"ngModel","ngModelChange","change"],["selected","",3,"value"],[3,"value",4,"ngFor","ngForOf"],["class","text-danger","style","color: red;",4,"ngIf"],["class","row mb-3",4,"ngIf"],[1,"col-sm-12","d-flex","justify-content-center"],["appHeading","","mdbBtn","","type","button","size","md","mdbWavesEffect","",1,"buttonhover",3,"click"],[1,"text-danger",2,"font-weight","bold"],[1,"col-sm-6"],["component1",""],[1,"col-sm-2","col-form-label"],["class","container-flex p-2",4,"ngIf"],[3,"value"],[1,"text-danger",2,"color","red"],["for","input2",1,"col-sm-4","col-form-label",2,"font-weight","bold"],["type","text","name","daterange","placeholder","Select Date Range","autocomplete","off","bsDaterangepicker","","inputmode","none",1,"p-3","form-control",3,"ngModel","maxDate","bsConfig","ngModelChange","bsValueChange"],["for","input3",1,"col-sm-4","col-form-label",2,"font-weight","bold"],["type","date","name","date","id","input3",1,"form-control",3,"ngModel","ngModelChange"],["hourFormat","24","inputId","timeonly",3,"ngModel","timeOnly","ngModelChange"],["for","input4",1,"col-sm-4","col-form-label",2,"font-weight","bold"],[1,"col-sm-4"],["mdbInput","","type","time","id","input4",1,"form-control"],["for","input5",1,"col-sm-4","col-form-label",2,"font-weight","bold"],["defaultLabel","--Select a Contractor--","optionLabel","Contractor_Name","optionValue","Contractor_Id","name","contractorname","display","chip","tabindex","-1",3,"options","ngModel","ngModelChange","onChange"],["for","input6",1,"col-sm-4","col-form-label",2,"font-weight","bold"],["defaultLabel","--Select a Department--","optionLabel","DeptName","optionValue","DeptId","name","deptname","display","chip","tabindex","-1",3,"options","ngModel","ngModelChange","onChange"],["for","input8",1,"col-sm-4","col-form-label",2,"font-weight","bold"],["name","designname",1,"browser-default","custom-select",3,"ngModel","ngModelChange","change"],["value","-1","selected",""],["for","input12",1,"col-sm-4","col-form-label",2,"font-weight","bold"],[1,"form-check"],["name","hangingPunch",3,"ngModel","binary","ngModelChange"],[1,"container-flex","p-2"],[1,"col-sm-3"],[1,"col-sm-3",2,"margin-top","-5px"],["appHeading","","mdbBtn","","type","button","size","sm","mdbWavesEffect","",1,"buttonhover",3,"click"],[1,"fas","fa-download",2,"font-size","20px"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngFor","ngForOf"],["showFirstLastButtons","",3,"length","pageSize","pageSizeOptions","page"],[1,"newemp"],[1,"card-group"],["class","p-1",4,"ngFor","ngForOf"],[1,"p-1"],["placement","top","style","background-color: rgb(197, 226, 243);",3,"mdbTooltip",4,"ngIf","ngIfElse"],["elseBlock",""],["placement","top",2,"background-color","rgb(197, 226, 243)",3,"mdbTooltip"],[2,"width","125px","height","150px"],["mdbTooltip","Date","placement","top"],["mdbTooltip","In Time","placement","right"],["mdbTooltip","Out Time","placement","right"],["mdbTooltip","Total Hours Worked","placement","right"],["mdbTooltip","Status","placement","right"],[4,"ngSwitchDefault"],["pill","true","color","red"],["pill","true","color","green"],["pill","true","color","orange"],["pill","true","color","yellow"],["pill","true","color","blue"],["placement","top",3,"mdbTooltip"],[1,"row","p-2","badges",2,"background-color","rgb(235, 227, 241)"],[1,"col"],["value","FT","severity","success","mdbTooltip","FILO Total","placement","top"],["value","P","severity","success","mdbTooltip","Present","placement","top"],["value","A","severity","danger","mdbTooltip","Absent","placement","top"],["value","H","severity","info","mdbTooltip","Holidays","placement","top"],["value","W","severity","warning","mdbTooltip","Weekly Off","placement","top"],["value","PO","severity","info","mdbTooltip","Pending Off","placement","top"],["value","NO","severity","success","mdbTooltip","Night Off","placement","top"],["value","VO","severity","warning","mdbTooltip","Valley Off","placement","top"],["value","L","severity","success","mdbTooltip","Leaves","placement","top"],["value","LWP","severity","info","mdbTooltip","Leave Without Pay","placement","top"],["value","T","severity","warning","mdbTooltip","Tour","placement","top"],["value","HD","severity","success","mdbTooltip","HalfDays","placement","top"],["value","LT","severity","info","mdbTooltip","Late","placement","top"],["value","ER","severity","warning","mdbTooltip","Early","placement","top"],["value","LTD","severity","info","mdbTooltip","LateDays","placement","top"],["value","ERD","severity","warning","mdbTooltip","EarlyDays","placement","top"],["style","background-color: rgb(197, 226, 243);",4,"ngIf","ngIfElse"],[2,"background-color","rgb(197, 226, 243)"],[2,"width","80px","height","80px"],[1,"table-responsive"],[1,"table","table-sm","table-hover"],["placement","top",2,"width","125px","height","165px",3,"mdbTooltip"],["mdbTooltip","Base Hour","placement","right"],["mdbTooltip","OT","placement","right"],["appTableHeader","",1,"text-white"],["autocomplete","off"],["type","text","placeholder","Search Id","name","id",1,"form-control",3,"ngModel","ngModelChange","keyup"],["type","text","placeholder","Search Name","name","name",1,"form-control",3,"ngModel","ngModelChange","keyup"],["name","dept",1,"form-control",3,"ngModel","ngModelChange","change"],["value","All","selected",""],[3,"click"],["fas","","icon","sort"]],template:function(t,e){1&t&&(p.TgZ(0,"div",0),p.TgZ(1,"div",1),p.TgZ(2,"div",2),p.TgZ(3,"form"),p.TgZ(4,"div",3),p.TgZ(5,"label",4),p._uU(6,"Reports "),p.TgZ(7,"sup",5),p._uU(8,"*"),p.qZA(),p.qZA(),p.TgZ(9,"div",6),p.TgZ(10,"select",7),p.NdJ("ngModelChange",function(t){return e.selectedReports=t})("change",function(){return e.getSelectedReportName()}),p.TgZ(11,"option",8),p._uU(12,"--Select Report Type--"),p.qZA(),p.YNc(13,N,2,2,"option",9),p.qZA(),p.YNc(14,U,2,0,"small",10),p.qZA(),p.qZA(),p.YNc(15,P,8,4,"div",11),p.YNc(16,L,8,2,"div",11),p.YNc(17,z,8,3,"div",11),p.YNc(18,Y,5,0,"div",11),p.YNc(19,Q,5,2,"div",11),p.YNc(20,k,8,3,"div",11),p.YNc(21,$,9,3,"div",11),p.YNc(22,B,6,2,"div",11),p.TgZ(23,"div",12),p.TgZ(24,"button",13),p.NdJ("click",function(){return e.showReport()}),p._uU(25,"Show"),p.qZA(),p._uU(26,"\xa0 "),p.TgZ(27,"button",13),p.NdJ("click",function(){return e.resetValue()}),p._uU(28,"Reset"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(29,"label",14),p.TgZ(30,"u"),p._uU(31,"Disclaimer: Data in the system prior to 01(one) hour is calculated, processed and shown."),p.qZA(),p.qZA(),p.qZA(),p.TgZ(32,"div",15),p._UZ(33,"app-employeesearch",null,16),p.qZA(),p.qZA(),p.TgZ(35,"label",17),p.TgZ(36,"sup",5),p._uU(37,"*"),p.qZA(),p._uU(38," Mandatory field"),p.qZA(),p.YNc(39,De,29,11,"div",18),p.qZA()),2&t&&(p.xp6(10),p.Q6J("ngModel",e.selectedReports),p.xp6(1),p.Q6J("value","-1"),p.xp6(2),p.Q6J("ngForOf",e.reports_list),p.xp6(1),p.Q6J("ngIf",e.reporterror),p.xp6(1),p.Q6J("ngIf",e.DateRange),p.xp6(1),p.Q6J("ngIf",e.Date),p.xp6(1),p.Q6J("ngIf",e.Date),p.xp6(1),p.Q6J("ngIf",e.HeadCount),p.xp6(1),p.Q6J("ngIf",e.daterange&&e.showcontractor),p.xp6(1),p.Q6J("ngIf",e.daterange),p.xp6(1),p.Q6J("ngIf",e.Desigination&&0!=e.deptname.length),p.xp6(1),p.Q6J("ngIf",e.Hanging),p.xp6(17),p.Q6J("ngIf",e.showtable))},directives:[c._Y,c.JL,c.F,c.EJ,c.JJ,c.On,c.YN,c.Kr,d.sg,d.O5,u.d,Z.mT,Z.b6,_.r,n.TB,c.Fj,n.FR,M.f,Z.Hq,i.NU,R.XZ,d.RF,d.n9,E.NW,Z.n3,Z.i9,Z.KS,Z.gR,Z.kp,d.ED,Z.NS,C.Ct,S.v,Z.Ui,Z.XI],styles:["form[_ngcontent-%COMP%]{padding-left:20px}mat-grid-tile[_ngcontent-%COMP%]{background:#add8e6;text-align:center}hr.newemp[_ngcontent-%COMP%]{border:2px solid #d2aef3;border-radius:5px}[_nghost-%COMP%]     .p-multiselect{width:23vw}[_nghost-%COMP%]     .p-calendar{width:23vw}@media screen and (max-width:640px){[_nghost-%COMP%]     .p-multiselect{width:68vw}[_nghost-%COMP%]     .p-calendar{width:68vw}}"]}),t})();var be=a(51634);const qe=["component1"],we=["reporttable"];function ve(t,e){if(1&t&&(p.TgZ(0,"option",19),p._uU(1),p.qZA()),2&t){const t=e.$implicit;p.Q6J("value",t),p.xp6(1),p.Oqu(t)}}function _e(t,e){1&t&&(p.TgZ(0,"small",20),p._uU(1,"Please select Report "),p.qZA())}function Me(t,e){1&t&&(p.TgZ(0,"small",20),p._uU(1,"Please select date range "),p.qZA())}function Re(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div",3),p.TgZ(1,"label",21),p._uU(2,"Select Date Range"),p.TgZ(3,"sup",5),p._uU(4,"*"),p.qZA(),p.qZA(),p.TgZ(5,"div",6),p.TgZ(6,"input",22),p.NdJ("ngModelChange",function(e){return p.CHM(t),p.oxw().daterange=e})("bsValueChange",function(e){return p.CHM(t),p.oxw().onValueChange(e)}),p.qZA(),p.YNc(7,Me,2,0,"small",10),p.qZA(),p.qZA()}if(2&t){const t=p.oxw();p.xp6(6),p.Q6J("ngModel",t.daterange)("maxDate",t.maxDateValue)("bsConfig",t.daterangeConfig),p.xp6(1),p.Q6J("ngIf",t.dateerror)}}function Ee(t,e){1&t&&(p.TgZ(0,"small",20),p._uU(1,"Please select date "),p.qZA())}function Ce(t,e){if(1&t&&(p.TgZ(0,"div",3),p.TgZ(1,"label",23),p._uU(2," Date "),p.TgZ(3,"sup",5),p._uU(4,"*"),p.qZA(),p.qZA(),p.TgZ(5,"div",6),p._UZ(6,"input",24,25),p.YNc(8,Ee,2,0,"small",10),p.qZA(),p.qZA()),2&t){const t=p.oxw();p.xp6(8),p.Q6J("ngIf",t.date1error)}}function Se(t,e){1&t&&(p.TgZ(0,"div",3),p.TgZ(1,"label",26),p._uU(2,"Select Time for Head Count"),p.qZA(),p.TgZ(3,"div",27),p._UZ(4,"input",28),p.qZA(),p.qZA())}function Ie(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div",3),p.TgZ(1,"label",29),p._uU(2,"Contractor Name "),p.qZA(),p.TgZ(3,"div",6),p.TgZ(4,"p-multiSelect",30),p.NdJ("ngModelChange",function(e){return p.CHM(t),p.oxw().contractorname=e})("onChange",function(){return p.CHM(t),p.oxw().contractorSelection()}),p.qZA(),p.qZA(),p.qZA()}if(2&t){const t=p.oxw();p.xp6(4),p.Q6J("options",t.contractor_list)("ngModel",t.contractorname)}}function Ne(t,e){1&t&&(p.TgZ(0,"small",20),p._uU(1,"Please select Department "),p.qZA())}function Ue(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div",3),p.TgZ(1,"label",31),p._uU(2,"Department "),p.TgZ(3,"sup",5),p._uU(4,"*"),p.qZA(),p.qZA(),p.TgZ(5,"div",6),p.TgZ(6,"p-multiSelect",32),p.NdJ("ngModelChange",function(e){return p.CHM(t),p.oxw().deptname=e})("onChange",function(){return p.CHM(t),p.oxw().showEmployeeByDept()}),p.qZA(),p.YNc(7,Ne,2,0,"small",10),p.qZA(),p.qZA()}if(2&t){const t=p.oxw();p.xp6(6),p.Q6J("options",t.dept_list)("ngModel",t.deptname),p.xp6(1),p.Q6J("ngIf",t.nameerror)}}function Fe(t,e){if(1&t&&(p.TgZ(0,"option",19),p._uU(1),p.qZA()),2&t){const t=e.$implicit;p.Q6J("value",t.DesignName),p.xp6(1),p.hij("",t.DesignName," ")}}function Pe(t,e){1&t&&(p.TgZ(0,"small",20),p._uU(1,"Please select Designation "),p.qZA())}function Oe(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div",3),p.TgZ(1,"label",33),p._uU(2,"Designation"),p.qZA(),p.TgZ(3,"div",6),p.TgZ(4,"select",34),p.NdJ("ngModelChange",function(e){return p.CHM(t),p.oxw().designname=e})("change",function(){return p.CHM(t),p.oxw().showEmployeeByDesg()}),p.TgZ(5,"option",35),p._uU(6,"--Select Designation--"),p.qZA(),p.YNc(7,Fe,2,2,"option",9),p.qZA(),p.YNc(8,Pe,2,0,"small",10),p.qZA(),p.qZA()}if(2&t){const t=p.oxw();p.xp6(4),p.Q6J("ngModel",t.designname),p.xp6(3),p.Q6J("ngForOf",t.desig_list),p.xp6(1),p.Q6J("ngIf",t.name1error)}}function Le(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div",3),p.TgZ(1,"label",36),p._uU(2,"Include Hanging In/Out Punches "),p.qZA(),p.TgZ(3,"div",6),p.TgZ(4,"div",37),p.TgZ(5,"p-checkbox",38),p.NdJ("ngModelChange",function(e){return p.CHM(t),p.oxw().hangingPunch=e}),p.qZA(),p.qZA(),p.qZA(),p.qZA()}if(2&t){const t=p.oxw();p.xp6(5),p.Q6J("ngModel",t.hangingPunch)("binary",!0)}}function Je(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div",3),p.TgZ(1,"label",39),p._uU(2,"Report Type "),p.qZA(),p.TgZ(3,"mat-radio-group",40),p.NdJ("ngModelChange",function(e){return p.CHM(t),p.oxw().reportType=e}),p.TgZ(4,"mat-radio-button",41),p._uU(5,"FILO "),p.qZA(),p._uU(6,"\xa0 "),p.TgZ(7,"mat-radio-button",42),p._uU(8,"MTA"),p.qZA(),p.qZA(),p.qZA()}if(2&t){const t=p.oxw();p.xp6(3),p.Q6J("ngModel",t.reportType),p.xp6(1),p.Q6J("checked",!0)}}function ze(t,e){if(1&t&&(p.TgZ(0,"td",59),p._uU(1),p.qZA()),2&t){const t=p.oxw().$implicit;p.xp6(1),p.Oqu(t.InPremises)}}function Ye(t,e){if(1&t&&(p.TgZ(0,"td"),p._uU(1),p.qZA()),2&t){const t=p.oxw().$implicit;p.xp6(1),p.Oqu(t.InEnteredFrom)}}function Qe(t,e){if(1&t&&(p.TgZ(0,"td",59),p._uU(1),p.qZA()),2&t){const t=p.oxw().$implicit;p.xp6(1),p.Oqu(t.OutPremises)}}function He(t,e){if(1&t&&(p.TgZ(0,"td"),p._uU(1),p.qZA()),2&t){const t=p.oxw().$implicit;p.xp6(1),p.Oqu(t.OutEnteredFrom)}}function ke(t,e){if(1&t&&(p.TgZ(0,"tr"),p.TgZ(1,"td"),p._uU(2),p.qZA(),p.TgZ(3,"td"),p._uU(4),p.qZA(),p.TgZ(5,"td"),p._uU(6),p.qZA(),p.TgZ(7,"td"),p._uU(8),p.qZA(),p.TgZ(9,"td"),p._uU(10),p.qZA(),p.YNc(11,ze,2,1,"td",57),p.YNc(12,Ye,2,1,"td",58),p.YNc(13,Qe,2,1,"td",57),p.YNc(14,He,2,1,"td",58),p.qZA()),2&t){const t=e.$implicit;p.xp6(2),p.Oqu(t.InPunchDate),p.xp6(2),p.Oqu(t.InPunchTime),p.xp6(2),p.Oqu(t.OutPunchDate),p.xp6(2),p.Oqu(t.OutPunchTime),p.xp6(2),p.Oqu(t.Total),p.xp6(1),p.Q6J("ngIf","#"==t.InPremises),p.xp6(1),p.Q6J("ngIf","#"!=t.InPremises),p.xp6(1),p.Q6J("ngIf","#"==t.OutPremises),p.xp6(1),p.Q6J("ngIf","#"!=t.OutPremises)}}function We(t,e){if(1&t&&(p.TgZ(0,"div"),p._UZ(1,"hr",53),p.TgZ(2,"div",1),p.TgZ(3,"div",45),p.TgZ(4,"b"),p._uU(5,"ID : "),p.qZA(),p._uU(6),p.qZA(),p.TgZ(7,"div",45),p.TgZ(8,"b"),p._uU(9,"NAME : "),p.qZA(),p._uU(10),p.qZA(),p.TgZ(11,"div",45),p.TgZ(12,"b"),p._uU(13,"DEPARTMENT : "),p.qZA(),p._uU(14),p.qZA(),p.qZA(),p._UZ(15,"hr"),p.TgZ(16,"div",54),p.TgZ(17,"div",55),p.TgZ(18,"table",56),p.TgZ(19,"thead"),p.TgZ(20,"tr"),p.TgZ(21,"th"),p._uU(22,"InPunch Date"),p.qZA(),p.TgZ(23,"th"),p._uU(24,"InPunch Time"),p.qZA(),p.TgZ(25,"th"),p._uU(26,"OutPunch Date"),p.qZA(),p.TgZ(27,"th"),p._uU(28,"OutPunch Time"),p.qZA(),p.TgZ(29,"th"),p._uU(30,"Total"),p.qZA(),p.TgZ(31,"th"),p._uU(32,"Entered From "),p.qZA(),p.TgZ(33,"th"),p._uU(34,"Out From"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(35,"tbody"),p.YNc(36,ke,15,9,"tr",52),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&t){const t=e.$implicit;p.xp6(6),p.Oqu(t.Id),p.xp6(4),p.Oqu(t.Name),p.xp6(4),p.Oqu(t.Department),p.xp6(22),p.Q6J("ngForOf",t.MA)}}function je(t,e){if(1&t&&(p.TgZ(0,"div"),p.YNc(1,We,37,4,"div",52),p.qZA()),2&t){const t=p.oxw(2);p.xp6(1),p.Q6J("ngForOf",t.mobileData)}}function $e(t,e){if(1&t&&(p.TgZ(0,"tr"),p.TgZ(1,"td"),p._uU(2),p.qZA(),p.TgZ(3,"td"),p._uU(4),p.qZA(),p.TgZ(5,"td"),p._uU(6),p.qZA(),p.TgZ(7,"td"),p._uU(8),p.qZA(),p.TgZ(9,"td"),p._uU(10),p.qZA(),p.TgZ(11,"td"),p._uU(12),p.qZA(),p.qZA()),2&t){const t=e.$implicit;p.xp6(2),p.Oqu(t.Shift),p.xp6(2),p.Oqu(t.InDate),p.xp6(2),p.Oqu(t.InTime),p.xp6(2),p.Oqu(t.OutTime),p.xp6(2),p.Oqu(t.DayTotal),p.xp6(2),p.Oqu(t.OT)}}function Be(t,e){if(1&t&&(p.TgZ(0,"div"),p._UZ(1,"hr",53),p.TgZ(2,"div",1),p.TgZ(3,"div",45),p.TgZ(4,"b"),p._uU(5,"ID : "),p.qZA(),p._uU(6),p.qZA(),p.TgZ(7,"div",45),p.TgZ(8,"b"),p._uU(9,"NAME : "),p.qZA(),p._uU(10),p.qZA(),p.TgZ(11,"div",45),p.TgZ(12,"b"),p._uU(13,"DEPARTMENT : "),p.qZA(),p._uU(14),p.qZA(),p.qZA(),p._UZ(15,"hr"),p.TgZ(16,"div",60),p.TgZ(17,"div",61),p.TgZ(18,"table",62),p.TgZ(19,"thead"),p.TgZ(20,"tr"),p.TgZ(21,"th"),p._uU(22,"Shift"),p.qZA(),p.TgZ(23,"th"),p._uU(24,"Date"),p.qZA(),p.TgZ(25,"th"),p._uU(26,"InPunch Time"),p.qZA(),p.TgZ(27,"th"),p._uU(28,"OutPunch Time"),p.qZA(),p.TgZ(29,"th"),p._uU(30,"DayTotal"),p.qZA(),p.TgZ(31,"th"),p._uU(32,"Overtime"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(33,"tbody"),p.YNc(34,$e,13,6,"tr",52),p.TgZ(35,"tr"),p.TgZ(36,"td",63),p._uU(37,"Total"),p.qZA(),p._UZ(38,"td"),p._UZ(39,"td"),p._UZ(40,"td"),p.TgZ(41,"td",63),p._uU(42),p.qZA(),p.TgZ(43,"td",63),p._uU(44),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&t){const t=e.$implicit;p.xp6(6),p.Oqu(t.Id),p.xp6(4),p.Oqu(t.Name),p.xp6(4),p.Oqu(t.Department),p.xp6(20),p.Q6J("ngForOf",t.OTReport),p.xp6(8),p.Oqu(t.Total_Working_Hours),p.xp6(2),p.Oqu(t.Total_OT)}}function Ve(t,e){if(1&t&&(p.TgZ(0,"div"),p.YNc(1,Be,45,6,"div",52),p.qZA()),2&t){const t=p.oxw(3);p.xp6(1),p.Q6J("ngForOf",t.overtimedata)}}function Ge(t,e){if(1&t&&(p.TgZ(0,"tr"),p.TgZ(1,"td"),p._uU(2),p.qZA(),p.TgZ(3,"td"),p._uU(4),p.qZA(),p.TgZ(5,"td"),p._uU(6),p.qZA(),p.TgZ(7,"td"),p._uU(8),p.qZA(),p.TgZ(9,"td"),p._uU(10),p.qZA(),p.TgZ(11,"td"),p._uU(12),p.qZA(),p.qZA()),2&t){const t=e.$implicit;p.xp6(2),p.Oqu(t.Shift),p.xp6(2),p.Oqu(t.RealDate),p.xp6(2),p.Oqu(t.InTime),p.xp6(2),p.Oqu(t.OutTime),p.xp6(2),p.Oqu(t.DayTotalMultiple),p.xp6(2),p.Oqu(t.OT_MTA)}}function Xe(t,e){if(1&t&&(p.TgZ(0,"div"),p._UZ(1,"hr",53),p.TgZ(2,"div",1),p.TgZ(3,"div",45),p.TgZ(4,"b"),p._uU(5,"ID : "),p.qZA(),p._uU(6),p.qZA(),p.TgZ(7,"div",45),p.TgZ(8,"b"),p._uU(9,"NAME : "),p.qZA(),p._uU(10),p.qZA(),p.TgZ(11,"div",45),p.TgZ(12,"b"),p._uU(13,"DEPARTMENT : "),p.qZA(),p._uU(14),p.qZA(),p.qZA(),p._UZ(15,"hr"),p.TgZ(16,"div",60),p.TgZ(17,"div",61),p.TgZ(18,"table",62),p.TgZ(19,"thead"),p.TgZ(20,"tr"),p.TgZ(21,"th"),p._uU(22,"Shift"),p.qZA(),p.TgZ(23,"th"),p._uU(24,"Date"),p.qZA(),p.TgZ(25,"th"),p._uU(26,"InPunch Time"),p.qZA(),p.TgZ(27,"th"),p._uU(28,"OutPunch Time"),p.qZA(),p.TgZ(29,"th"),p._uU(30,"DayTotal"),p.qZA(),p.TgZ(31,"th"),p._uU(32,"Overtime"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(33,"tbody"),p.YNc(34,Ge,13,6,"tr",52),p.TgZ(35,"tr"),p.TgZ(36,"td",63),p._uU(37,"Total"),p.qZA(),p._UZ(38,"td"),p._UZ(39,"td"),p._UZ(40,"td"),p.TgZ(41,"td",63),p._uU(42),p.qZA(),p.TgZ(43,"td",63),p._uU(44),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&t){const t=e.$implicit;p.xp6(6),p.Oqu(t.ID),p.xp6(4),p.Oqu(t.Name),p.xp6(4),p.Oqu(t.dept),p.xp6(20),p.Q6J("ngForOf",t.mta),p.xp6(8),p.Oqu(t.Total_Working_Hours),p.xp6(2),p.Oqu(t.Total_OT)}}function Ke(t,e){if(1&t&&(p.TgZ(0,"div"),p.YNc(1,Xe,45,6,"div",52),p.qZA()),2&t){const t=p.oxw(3);p.xp6(1),p.Q6J("ngForOf",t.overtimedata)}}function ta(t,e){if(1&t&&(p.TgZ(0,"div"),p.YNc(1,Ve,2,1,"div",58),p.YNc(2,Ke,2,1,"div",58),p.qZA()),2&t){const t=p.oxw(2);p.xp6(1),p.Q6J("ngIf","filo"==t.reportType),p.xp6(1),p.Q6J("ngIf","mta"==t.reportType)}}function ea(t,e){if(1&t&&(p.TgZ(0,"tr"),p.TgZ(1,"td"),p._uU(2),p.qZA(),p.TgZ(3,"td"),p._uU(4),p.qZA(),p.TgZ(5,"td"),p._uU(6),p.qZA(),p.TgZ(7,"td"),p._uU(8),p.qZA(),p.TgZ(9,"td"),p._uU(10),p.qZA(),p.TgZ(11,"td"),p._uU(12),p.qZA(),p.TgZ(13,"td"),p._uU(14),p.qZA(),p.TgZ(15,"td"),p._uU(16),p.qZA(),p.TgZ(17,"td"),p._uU(18),p.qZA(),p.TgZ(19,"td"),p._uU(20),p.qZA(),p.qZA()),2&t){const t=e.$implicit;p.xp6(2),p.Oqu(t.EmpId),p.xp6(2),p.Oqu(t.Name),p.xp6(2),p.Oqu(t.RealDate),p.xp6(2),p.Oqu(t.RealTime),p.xp6(2),p.Oqu(t.InOutStatus),p.xp6(2),p.Oqu(t.OldDate),p.xp6(2),p.Oqu(t.OldTime),p.xp6(2),p.Oqu(t.MakerTimeStamp),p.xp6(2),p.Oqu(t.Status),p.xp6(2),p.Oqu(t.ProcessStatus)}}function aa(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"div",54),p.TgZ(2,"div",64),p.TgZ(3,"table",56),p.TgZ(4,"thead"),p.TgZ(5,"tr"),p.TgZ(6,"th"),p._uU(7,"Id"),p.qZA(),p.TgZ(8,"th"),p._uU(9,"Name"),p.qZA(),p.TgZ(10,"th"),p._uU(11,"Date"),p.qZA(),p.TgZ(12,"th"),p._uU(13,"Time"),p.qZA(),p.TgZ(14,"th"),p._uU(15,"In/Out"),p.qZA(),p.TgZ(16,"th"),p._uU(17,"OldDate"),p.qZA(),p.TgZ(18,"th"),p._uU(19,"OldTime "),p.qZA(),p.TgZ(20,"th"),p._uU(21,"MakerTimeStamp"),p.qZA(),p.TgZ(22,"th"),p._uU(23,"Status"),p.qZA(),p.TgZ(24,"th"),p._uU(25,"ProcessStatus"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(26,"tbody"),p.YNc(27,ea,21,10,"tr",52),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&t){const t=p.oxw(2);p.xp6(27),p.Q6J("ngForOf",t.makerCheckerData)}}function ia(t,e){if(1&t&&(p.TgZ(0,"tr"),p.TgZ(1,"td"),p._uU(2),p.qZA(),p.TgZ(3,"td"),p._uU(4),p.qZA(),p.TgZ(5,"td"),p._uU(6),p.qZA(),p.TgZ(7,"td"),p._uU(8),p.qZA(),p.TgZ(9,"td"),p._uU(10),p.qZA(),p.TgZ(11,"td"),p._uU(12),p.qZA(),p.qZA()),2&t){const t=e.$implicit;p.xp6(2),p.Oqu(t.ID),p.xp6(2),p.Oqu(t.Name),p.xp6(2),p.Oqu(t.RealDate),p.xp6(2),p.Oqu(t.RealTime),p.xp6(2),p.Oqu(t.InOutStatus),p.xp6(2),p.Oqu(t.Alias)}}function na(t,e){if(1&t&&(p.TgZ(0,"div"),p.TgZ(1,"div",54),p.TgZ(2,"div",64),p.TgZ(3,"table",56),p.TgZ(4,"thead"),p.TgZ(5,"tr"),p.TgZ(6,"th"),p._uU(7,"Id"),p.qZA(),p.TgZ(8,"th"),p._uU(9,"Name"),p.qZA(),p.TgZ(10,"th"),p._uU(11,"Date"),p.qZA(),p.TgZ(12,"th"),p._uU(13,"Time"),p.qZA(),p.TgZ(14,"th"),p._uU(15,"In/Out"),p.qZA(),p.TgZ(16,"th"),p._uU(17,"Device Description"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(18,"tbody"),p.YNc(19,ia,13,6,"tr",52),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&t){const t=p.oxw(2);p.xp6(19),p.Q6J("ngForOf",t.accessControlData)}}function oa(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"div",43),p.TgZ(1,"h1"),p._uU(2),p.qZA(),p._UZ(3,"br"),p.TgZ(4,"div",1,44),p.TgZ(6,"div",45),p.TgZ(7,"b"),p._uU(8,"FromDate : "),p.qZA(),p._uU(9),p.qZA(),p.TgZ(10,"div",45),p.TgZ(11,"b"),p._uU(12,"ToDate : "),p.qZA(),p._uU(13),p.qZA(),p.TgZ(14,"div",46),p.TgZ(15,"button",47),p.NdJ("click",function(){return p.CHM(t),p.oxw().genericPdfReport()}),p._UZ(16,"i",48),p._uU(17,"\xa0Download PDF"),p.qZA(),p.qZA(),p.TgZ(18,"div",46),p.TgZ(19,"button",49),p.NdJ("click",function(){return p.CHM(t),p.oxw().genericExcelReport()}),p._UZ(20,"i",48),p._uU(21,"\xa0Download Excel"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(22,"div",50),p.YNc(23,je,2,1,"div",51),p.YNc(24,ta,3,2,"div",51),p.YNc(25,aa,28,1,"div",51),p.YNc(26,na,20,1,"div",51),p.qZA(),p.qZA()}if(2&t){const t=p.oxw();p.xp6(2),p.Oqu(t.reportName),p.xp6(7),p.Oqu(t.fromdatedisplay),p.xp6(4),p.hij(" ",t.todatedisplay,""),p.xp6(2),p.Q6J("disabled",t.pdfdisabled),p.xp6(7),p.Q6J("ngSwitch",t.selectedReports),p.xp6(1),p.Q6J("ngSwitchCase","Mobile Attendance Report"),p.xp6(1),p.Q6J("ngSwitchCase","Overtime Report"),p.xp6(1),p.Q6J("ngSwitchCase","Maker Checker Report"),p.xp6(1),p.Q6J("ngSwitchCase","Access Control Report")}}let sa=(()=>{class t{constructor(t,e,a,i,n){this.reports=t,this.common=e,this.toast=a,this.datepipe=i,this.ngxuiloader=n,this.yearrange="2010:",this.nameerror=!1,this.name1error=!1,this.typeerror=!1,this.dateerror=!1,this.reporterror=!1,this.date1error=!1,this.deptname=[],this.selectedEmployee=[],this.tabledata=[],this.showtable=!1,this.selectedReports="-1",this.DateRange=!1,this.ContractorName=!0,this.DepartmentName=!0,this.SubDepartment=!0,this.Desigination=!0,this.EmployeeType=!0,this.Records=!1,this.Mode=!0,this.Date=!1,this.HeadCount=!1,this.Hanging=!1,this.PPunches=!1,this.hangingPunch=!1,this.multiplePunchData=[],this.p_star_punches=!1,this.summaryDateArray=[],this.dayarray=[],this.reportType="filo",this.contractor_list=[],this.original_dept_list=[],this.showcontractor=!1,this.contractor="",this.pdfdisabled=!1,this.ranges=[{value:[new Date,new Date],label:"Today"},{value:[new Date((new Date).setDate((new Date).getDate()-7)),new Date],label:"Last 7 Days"},{value:[new Date((new Date).getFullYear(),(new Date).getMonth(),1),new Date((new Date).setDate((new Date).getDate()-1))],label:"This Month"},{value:[new Date((new Date).getFullYear(),(new Date).getMonth()-1,1),new Date((new Date).getFullYear(),(new Date).getMonth(),0)],label:"Last Month"}],this.dept_list=[],this.desig_list=[],this.type_list=[],this.cont_list=[],this.sub_list=[],this.attendanceData=[],this.musterData=[],this.filoData=[],this.reports_list=["Mobile Attendance Report","Overtime Report","Maker Checker Report","Access Control Report"],this.mobileData=[],this.overtimedata=[],this.makerCheckerData=[],this.accessControlData=[]}ngOnInit(){var t=this;this.daterangeConfig={containerClass:"theme-dark-blue",showPreviousMonth:!0,isAnimated:!0,rangeInputFormat:"DD/MM/YYYY",maxDateRange:30,showClearButton:!0,clearPosition:"right",selectWeekDateRange:!0,ranges:this.ranges},this.showcontractor=(this.common.getLocalStorage().Contractor.toLowerCase(),!0);try{this.common.getContractorList().subscribe(function(){var e=(0,T.Z)(function*(e){t.contractor_list=yield e,null!=t.contractor_list.data||null!=t.contractor_list.data?0!=t.contractor_list.data.length&&(t.contractor_list=t.contractor_list.data):(t.contractor_list=[],t.contractor_list.push({Contractor_Id:"-1",Contractor_Name:"No Contractor Registered"}))});return function(t){return e.apply(this,arguments)}}()),this.common.getDepartmentList().subscribe(function(){var e=(0,T.Z)(function*(e){t.dept_list=yield e,null!=t.dept_list.data||null!=t.dept_list.data?(0!=t.dept_list.data.length&&(t.dept_list=t.dept_list.data),t.original_dept_list=t.dept_list):(t.dept_list=[],t.dept_list.push({DeptId:"-1",DeptName:"No Department Registered"}))});return function(t){return e.apply(this,arguments)}}()),this.common.getDesignationList().subscribe(function(){var e=(0,T.Z)(function*(e){t.desig_list=yield e,null!=t.desig_list.data||null!=t.desig_list.data?0!=t.desig_list.data.length&&(t.desig_list=t.desig_list.data):(t.desig_list=[],t.desig_list.push({DesignId:"-1",DesignName:"No Designation Registered"}))});return function(t){return e.apply(this,arguments)}}())}catch(e){let t={Exception:e,id:this.common.getLocalStorage().LoginId,Api:"Sub report Component"};this.common.saveLog(t,"ApiException")}this.DateRange=!0,this.recordtype="M",this.reporttype="express",this.yearrange+=(new Date).getFullYear(),this.designname="-1",this.maxDateValue=new Date,this.maxDateValue.setMonth((new Date).getMonth()),this.maxDateValue.setFullYear((new Date).getFullYear()),this.maxDateValue.setDate((new Date).getDate()-1)}getSelectedReportName(){if("-1"==this.selectedReports)return this.DateRange=!1,this.Date=!1,this.HeadCount=!1,this.Records=!1,this.PPunches=!1,this.Hanging=!1,void(this.reporterror=!0);this.reporterror=!1,"Employees Inside Premises Report"==this.selectedReports?(this.DateRange=!1,this.Date=!0,this.HeadCount=!0,this.Records=!1):(this.DateRange=!0,this.Date=!1,this.HeadCount=!1,this.Records=!0),this.showtable=!1}onValueChange(t){this.empsearch.showtable=!0,null==t&&(this.deptname=[],this.empsearch.showtable=!1)}contractorSelection(){var t=this;if(this.contractor="",this.deptname=[],this.empsearch.showtable=!1,0!=this.contractorname.length){this.contractor+=this.contractorname[0];for(let t=1;t<this.contractorname.length;t++)this.contractor+=","+this.contractorname[t];this.common.getDepartmentUnderContractor(this.contractor).subscribe(function(){var e=(0,T.Z)(function*(e){let a=yield e;if(null!=a.data&&0!=a.data.length){t.dept_list=[];for(let e=0;e<a.data.length;e++)for(let i=0;i<t.original_dept_list.length;i++)a.data[e]==t.original_dept_list[i].DeptId&&t.dept_list.push(t.original_dept_list[i])}else t.dept_list=[]});return function(t){return e.apply(this,arguments)}}())}else this.dept_list=this.original_dept_list}showEmployeeByDept(){this.nameerror=0==this.deptname.length,this.designname="-1";let t=this.datepipe.transform(this.daterange[0],"dd/MM/yyyy"),e=this.datepipe.transform(this.daterange[1],"dd/MM/yyyy");if(this.deptname.length==this.dept_list.length)this.empsearch.showEmployeeWithinRange(t,e,"All",this.contractor);else{let a="";for(let t=0;t<this.deptname.length;t++)this.dept_list.filter(e=>{e.DeptId==this.deptname[t]&&(a+=e.DeptId+",")});a=a.slice(0,-1),this.empsearch.showEmployeeWithinRange(t,e,a,this.contractor)}}showEmployeeByDesg(){let t=this.desig_list.filter(t=>t.DesignName==this.designname);this.empsearch.showEmployeeByDesgById(t[0].DesignId)}onCheckDate(){var t=new Date(this.daterange[0]),e=new Date(this.daterange[1]).getTime()-t.getTime();this.selectedDays=Math.floor(e/864e5)}counter(t){return new Array(t)}resetValue(){this.showtable=!1,this.empsearch.selectedEmployee=[],this.empsearch.showtable=!1,this.attendanceData=[],this.selectedReports="-1",this.DateRange=!1,this.Date=!1,this.HeadCount=!1,this.Records=!1,this.PPunches=!1,this.Hanging=!1,this.daterange=[],this.deptname=[],this.designname="-1",this.reporttype="express"}showReport(){if("-1"==this.selectedReports)return void(this.reporterror=!0);if(this.reporterror=!1,this.dateerror=null==this.daterange||null==this.daterange[0]||null==this.daterange[1],this.nameerror="-1"==this.deptname,this.reporterror||this.dateerror||this.nameerror)return;if(this.onCheckDate(),0==this.empsearch.selectedEmployee.length)return void this.toast.warning("Please Select atleast one employee!!!");let t=this.datepipe.transform(this.daterange[0],"dd/MM/yyyy"),e=this.datepipe.transform(this.daterange[1],"dd/MM/yyyy");this.fromdatedisplay=t,this.todatedisplay=e,this.reportName=this.selectedReports,this.common.insertLog("Report/SubReport/seen-"+this.reportName),"Mobile Attendance Report"==this.selectedReports?(this.pdfdisabled=!1,this.getMobileAttendaceReport(t,e)):"Overtime Report"==this.selectedReports?(this.pdfdisabled=!1,this.getOvertimeReport(t,e)):"Maker Checker Report"==this.selectedReports?(this.pdfdisabled=!0,this.getMakerCheckerReport(t,e)):"Access Control Report"==this.selectedReports&&this.getAccessControlReport(t,e)}getMobileAttendaceReport(t,e){var a=this;this.selectedEmployee=this.empsearch.selectedEmployee;let i=[];for(let o=0;o<this.selectedEmployee.length;o++)i.push(this.selectedEmployee[o].EmployeeId);let n={CID:this.common.getCid(),EmpId:i,FromDate:t,ToDate:e,ReportType:"express",ReportMode:"M"};this.reports.getMobileAttendanceReport(n).subscribe(function(){var t=(0,T.Z)(function*(t){let e=yield t;1==e.errorcode&&(0!=e.data.length||null!=e.data?(a.mobileData=yield e.data,a.showtable=yield!0,a.reporttable.nativeElement.scrollIntoView({behavior:"smooth"})):(a.mobileData=[],a.showtable=!1))});return function(e){return t.apply(this,arguments)}}(),t=>{let e={Exception:t.message,id:this.common.getLocalStorage().LoginId,Api:"Mobile Attendance Report"};this.common.saveLog(e,"ApiException")})}getOvertimeReport(t,e){var a=this;this.selectedEmployee=this.empsearch.selectedEmployee;let i=[];for(let o=0;o<this.selectedEmployee.length;o++)i.push(this.selectedEmployee[o].EmployeeId);let n={CID:this.common.getCid(),EmpId:i,FromDate:t,ToDate:e,ReportType:"express",ReportMode:"M"};"filo"==this.reportType?this.reports.getOvertimeReport(n).subscribe(function(){var t=(0,T.Z)(function*(t){let e=yield t,i=[],n=[];if(1==e.errorcode)if(0!=e.data.length||null!=e.data){a.overtimedata=yield e.data;for(let t=0;t<a.overtimedata.length;t++){n=[],i=[];for(let e=0;e<a.overtimedata[t].OTReport.length;e++)i.push(a.overtimedata[t].OTReport[e].OT),n.push(a.overtimedata[t].OTReport[e].DayTotal);a.overtimedata[t].Total_OT=(0,be.Bd)((0,be.IH)(i)),a.overtimedata[t].Total_Working_Hours=(0,be.Bd)((0,be.IH)(n))}a.showtable=yield!0,a.reporttable.nativeElement.scrollIntoView({behavior:"smooth"})}else a.overtimedata=[],a.showtable=!1});return function(e){return t.apply(this,arguments)}}(),t=>{let e={Exception:t.message,id:this.common.getLocalStorage().LoginId,Api:"Overtime Filo Report"};this.common.saveLog(e,"ApiException")}):this.reports.getMultiplePunchesReport(n).subscribe(function(){var t=(0,T.Z)(function*(t){let e=yield t,i=[],n=[];if(1==e.errorcode)if(0!=e.data.length||null!=e.data){a.overtimedata=yield e.data,a.overtimedata=a.overtimedata.filter(t=>(t.mta=t.mta.filter(t=>""!=t.OT_MTA),t));for(let t=0;t<a.overtimedata.length;t++){n=[],i=[];for(let e=0;e<a.overtimedata[t].mta.length;e++)e!=a.overtimedata[t].mta.length-1&&a.overtimedata[t].mta[e].RealDate==a.overtimedata[t].mta[e+1].RealDate||(i.push(a.overtimedata[t].mta[e].OT_MTA),n.push(a.overtimedata[t].mta[e].DayTotalMultiple));a.overtimedata[t].Total_OT=(0,be.Bd)((0,be.IH)(i)),a.overtimedata[t].Total_Working_Hours=(0,be.Bd)((0,be.IH)(n))}a.showtable=yield!0,a.reporttable.nativeElement.scrollIntoView({behavior:"smooth"})}else a.overtimedata=[],a.showtable=!1});return function(e){return t.apply(this,arguments)}}(),t=>{let e={Exception:t.message,id:this.common.getLocalStorage().LoginId,Api:"Overtime MTA Report"};this.common.saveLog(e,"ApiException")})}getMakerCheckerReport(t,e){var a=this;this.selectedEmployee=this.empsearch.selectedEmployee;let i=[];for(let o=0;o<this.selectedEmployee.length;o++)i.push(this.selectedEmployee[o].EmployeeId);let n={CID:this.common.getCid(),Employees:i,FromDate:t,ToDate:e};this.ngxuiloader.start(),this.reports.getMakerCheckerReport(n).subscribe(function(){var t=(0,T.Z)(function*(t){let e=yield t;a.ngxuiloader.stop(),1==e.errorcode&&(0!=e.data.length||null!=e.data?(a.makerCheckerData=yield e.data,a.showtable=!0,a.reporttable.nativeElement.scrollIntoView({behavior:"smooth"})):(a.makerCheckerData=[],a.showtable=!1))});return function(e){return t.apply(this,arguments)}}(),t=>{let e={Exception:t.message,id:this.common.getLocalStorage().LoginId,Api:"Maker Checker Report"};this.common.saveLog(e,"ApiException")})}getAccessControlReport(t,e){var a=this;this.selectedEmployee=this.empsearch.selectedEmployee;let i=[];for(let o=0;o<this.selectedEmployee.length;o++)i.push(this.selectedEmployee[o].EmployeeId);let n={CID:this.common.getCid(),EmpId:i,FromDate:t,ToDate:e,ReportType:"",ReportMode:""};this.ngxuiloader.start(),this.reports.getAccessControlReport(n).subscribe(function(){var t=(0,T.Z)(function*(t){let e=yield t;a.ngxuiloader.stop(),1==e.errorcode&&(0!=e.data.length||null!=e.data?(a.accessControlData=yield e.data,a.showtable=!0,a.reporttable.nativeElement.scrollIntoView({behavior:"smooth"})):(a.accessControlData=[],a.showtable=!1))});return function(e){return t.apply(this,arguments)}}(),t=>{let e={Exception:t.message,id:this.common.getLocalStorage().LoginId,Api:"Access Control Report"};this.common.saveLog(e,"ApiException")})}genericExcelReport(){"Mobile Attendance Report"==this.selectedReports?this.mobileAttendanceExcelReport():"Overtime Report"==this.selectedReports?this.overtimeExcelReport():"Maker Checker Report"==this.selectedReports?this.makerCheckerExcelReport():"Access Control Report"==this.selectedReports&&this.accessControlExcelReport()}genericPdfReport(){"Mobile Attendance Report"==this.selectedReports?this.mobileAttendancePDFReport():"Overtime Report"==this.selectedReports?this.overtimePDFReport():"Access Control Report"==this.selectedReports&&this.accessControlPDFReport()}mobileAttendancePDFReport(){var t=new f.jsPDF("l","pt","a4");const e=this.datepipe.transform(new Date,"d MMM y, h:mm:ss a"),a=this.datepipe.transform(new Date,"dd/MM/yyyy-h:mm:ss a");var i=t.internal.pageSize.width||t.internal.pageSize.getWidth(),n=t.internal.pageSize.height||t.internal.pageSize.getHeight();t.setFontSize(8),t.text("Mobile Attendance Report",i/2,20,{align:"center"}),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center"}),t.text(""+e,i-20,30,{align:"right"}),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.line(20,40,i-20,40);let o=["InPunchDate","InPunchTime","OutPunchDate","OutPunchTime","Total","Entered From","Out From"],s=20;t.setFontSize(8);for(let g of o)"Entered From"==g||"Out From"==g?(t.text(g,s,60,{maxWidth:250}),s+=260):(t.text(g,s,60,{maxWidth:60}),s+=70);t.line(20,70,i-20,70),t.setFontSize(8);let l=1,r=100;s=30;let d=i/4,h=10;for(let g=0;g<this.mobileData.length;g++){if(0==l){s=20,t.setFontSize(8);for(let e of o)"Entered From"==e||"Out From"==e?(t.text(e,s,60,{maxWidth:250}),s+=260):(t.text(e,s,60,{maxWidth:60}),s+=70);t.line(20,70,i-20,70),t.setFontSize(8),t.text("Mobile Attendance Report",i/2,20,{align:"center",renderingMode:"fill"}).setFillColor("#FFFFFF"),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center",renderingMode:"fill"}),t.text(""+e,i-20,30,{align:"right"}),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.line(20,40,i-20,40),r=100,s=30,d=i/4,h=10}h=10,t.setFontSize(8),t.text("ID : "+this.mobileData[g].Id,s,r,{align:"left"}),t.text("NAME : "+this.mobileData[g].Name,s+100,r,{align:"left"}),t.text("DEPARTMENT : "+this.mobileData[g].Department,s+300,r,{align:"left"}),t.text("ALPHANUMERIC : "+this.mobileData[g].AlfaNumeric,s+500,r,{align:"left"}),t.setFontSize(7),t.line(20,r+10,i-20,r+10);let a=20;r+=20;for(let l=0;l<this.mobileData[g].MA.length;l++)if(t.text(this.mobileData[g].MA[l].InPunchDate,a,r,{renderingMode:"fill"}),t.text(this.mobileData[g].MA[l].InPunchTime,a+70,r,{renderingMode:"fill"}),t.text(this.mobileData[g].MA[l].OutPunchDate,a+140,r),t.text(this.mobileData[g].MA[l].OutPunchTime,a+210,r),t.text(this.mobileData[g].MA[l].Total,a+280,r),"#"==this.mobileData[g].MA[l].InPremises?(t.setTextColor(255,0,0),t.text(this.mobileData[g].MA[l].InPremises,a+350,r,{maxWidth:230}),t.setTextColor(0,0,0)):t.text(this.mobileData[g].MA[l].InEnteredFrom,a+350,r,{maxWidth:230}),"#"==this.mobileData[g].MA[l].OutPremises?(t.setTextColor(255,0,0),t.text(this.mobileData[g].MA[l].OutPremises,a+590,r,{maxWidth:225}),t.setTextColor(0,0,0)):t.text(this.mobileData[g].MA[l].OutEnteredFrom,a+590,r,{maxWidth:225}),r+=30,r+30>n){t.addPage("a4","l"),s=20,t.setFontSize(8);for(let e of o)"Entered From"==e||"Out From"==e?(t.text(e,s,60,{maxWidth:250}),s+=260):(t.text(e,s,60,{maxWidth:60}),s+=70);t.line(20,70,i-20,70),t.setFontSize(8),t.text("Mobile Attendance Report ",i/2,20,{align:"center",renderingMode:"fill"}).setFillColor("#FFFFFF"),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center",renderingMode:"fill"}),t.text(""+e,i-20,30,{align:"right"}),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.line(20,40,i-20,40),r=100,s=30,d=i/4,h=10}t.line(20,r,i-20,r),r+=30,l+=1,r+100>n&&(t.addPage("a4","l"),l=0)}t.save("Mobile_Attendance_Report-"+a+".pdf")}mobileAttendanceExcelReport(){this.ngxuiloader.start();const t=this.common.getLocalStorage().ClientName,e=this.datepipe.transform(new Date,"dd/MM/yyyy");let a=new q.Workbook,i=a.addWorksheet("Mobile Attendance Report"),n=i.addRow(["Mobile Attendance Report"]);i.addRow([t]),n.font={name:"Comic Sans MS",family:4,size:16,underline:"double",bold:!0},i.addRow(["Report Generation Date : "+this.datepipe.transform(new Date,"dd MMM yyyy")]);let o="From : "+this.datepipe.transform(this.daterange[0],"dd MMM yyyy"),s="To : "+this.datepipe.transform(this.daterange[1],"dd MMM yyyy");i.addRow([o]),i.addRow([s]),i.addRow([]);let l=i.addRow(["ID","NAME","DEPARTMENT","ALPHANUMERIC","INPUNCH DATE","INPUNCH TIME","OUTPUNCH DATE","OUTPUNCH TIME","TOTAL","ENTERED FROM","OUT FROM","INPREMISES","OUTPREMISES","CONTRACTOR NAME","TYPE_DESC"]);l.font={size:12,bold:!0},l.eachCell((t,e)=>{t.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"},bgColor:{argb:"FF0000FF"}},t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}});let r=[];for(let d=0;d<this.mobileData.length;d++){r=[],r[1]=Number(this.mobileData[d].Id),r[2]=this.mobileData[d].Name,r[3]=this.mobileData[d].Department,r[4]=this.mobileData[d].AlfaNumeric;let t=5;for(let e of this.mobileData[d].MA){t=5,r[t]=e.InPunchDate,t++,r[t]=e.InPunchTime,t++,r[t]=e.OutPunchDate,t++,r[t]=e.OutPunchTime,t++,r[t]=e.Total,t++,r[t]=e.InEnteredFrom,t++,r[t]=e.OutEnteredFrom,t++,r[t]=e.InPremises,t++,r[t]=e.OutPremises,t++,r[t]=e.ContractorName,t++,r[t]=e.TypeDesc,t++;let a=i.addRow(r);a.alignment={vertical:"middle",horizontal:"center"},a.eachCell(t=>{t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}}i.getColumn(1).width=15,i.getColumn(2).width=20,i.getColumn(3).width=25,i.getColumn(4).width=15,i.getColumn(5).width=12,i.getColumn(6).width=12,i.getColumn(7).width=12,i.getColumn(8).width=12,i.getColumn(9).width=12,i.getColumn(10).width=30,i.getColumn(11).width=30,i.getColumn(10).alignment={vertical:"middle",horizontal:"center",wrapText:!0},i.getColumn(11).alignment={vertical:"middle",horizontal:"center",wrapText:!0},a.xlsx.writeBuffer().then(t=>{let a=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});w.saveAs(a,"Mobile Attendance Report_"+e+".xlsx")}),this.ngxuiloader.stop()}overtimePDFReport(){var t=new f.jsPDF("p","pt","a4");const e=this.datepipe.transform(new Date,"d MMM y, h:mm:ss a"),a=this.datepipe.transform(new Date,"dd/MM/yyyy-h:mm:ss a");var i=t.internal.pageSize.width||t.internal.pageSize.getWidth(),n=t.internal.pageSize.height||t.internal.pageSize.getHeight();t.setFontSize(8),t.text("Overtime Report",i/2,20,{align:"center"}),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center"}),t.text(""+e,i-20,30,{align:"right"}),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.line(20,40,i-20,40);let o=["InDate","Shift","In Time","Out Time","Day Total","OT"],s=20;t.setFontSize(8);for(let g of o)t.text(g,s,50,{maxWidth:60}),s+=70;t.line(20,55,i-20,55),t.setFontSize(8);let l=1,r=70;s=30;let d=i/4,h=10;if("filo"==this.reportType)for(let g=0;g<this.overtimedata.length;g++){if(0==l){s=20,t.setFontSize(8);for(let e of o)t.text(e,s,50,{maxWidth:60}),s+=70;t.line(20,55,i-20,55),t.setFontSize(8),t.text("Overtime Report",i/2,20,{align:"center",renderingMode:"fill"}).setFillColor("#FFFFFF"),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center",renderingMode:"fill"}),t.text(""+e,i-20,30,{align:"right"}),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.line(20,40,i-20,40),r=70,s=30,d=i/4,h=10}h=10,t.setFontSize(8),t.text("ID : "+this.overtimedata[g].Id,s,r,{align:"left"}),t.text("NAME : "+this.overtimedata[g].Name,s+100,r,{align:"left"}),t.text("DEPARTMENT : "+this.overtimedata[g].Department,s+250,r,{align:"left"}),t.text("ALPHANUMERIC : "+this.overtimedata[g].Alfanumeric,s+400,r,{align:"left"}),t.setFontSize(7),t.line(20,r+10,i-20,r+10);let a=20;r+=20;for(let p=0;p<this.overtimedata[g].OTReport.length;p++)if(t.text(this.overtimedata[g].OTReport[p].InDate,a,r,{renderingMode:"fill"}),t.text(this.overtimedata[g].OTReport[p].Shift,a+70,r,{renderingMode:"fill"}),t.text(this.overtimedata[g].OTReport[p].InTime,a+140,r),t.text(this.overtimedata[g].OTReport[p].OutTime,a+210,r),t.text(this.overtimedata[g].OTReport[p].DayTotal,a+280,r),t.text(this.overtimedata[g].OTReport[p].OT,a+350,r),r+=10,r+30>n){t.addPage("a4","p"),s=20,t.setFontSize(8);for(let e of o)t.text(e,s,50,{maxWidth:60}),s+=70;t.line(20,55,i-20,55),t.setFontSize(8),t.text("Overtime Attendance Report ",i/2,20,{align:"center",renderingMode:"fill"}).setFillColor("#FFFFFF"),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center",renderingMode:"fill"}),t.text(""+e,i-20,30,{align:"right"}),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.line(20,40,i-20,40),r=70,s=30,d=i/4,h=10,t.line(20,r,i-20,r),r+=30,l+=1}t.line(20,r,i-20,r),r+=10,t.text(this.overtimedata[g].Total_Working_Hours,a+280,r),t.text(this.overtimedata[g].Total_OT,a+350,r),r+=5,t.line(20,r,i-20,r),r+=10,r+100>n&&(t.text("in hundred"+r,s,r),t.addPage("a4","p"),l=0)}else if("mta"==this.reportType)for(let g=0;g<this.overtimedata.length;g++){if(0==l){s=20,t.setFontSize(8);for(let e of o)t.text(e,s,50,{maxWidth:60}),s+=70;t.line(20,55,i-20,55),t.setFontSize(8),t.text("Overtime Report",i/2,20,{align:"center",renderingMode:"fill"}).setFillColor("#FFFFFF"),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center",renderingMode:"fill"}),t.text(""+e,i-20,30,{align:"right"}),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.line(20,40,i-20,40),r=70,s=30,d=i/4,h=10}h=10,t.setFontSize(8),t.text("ID : "+this.overtimedata[g].ID,s,r,{align:"left"}),t.text("NAME : "+this.overtimedata[g].Name,s+100,r,{align:"left"}),t.text("DEPARTMENT : "+this.overtimedata[g].dept,s+300,r,{align:"left"}),t.setFontSize(7),t.line(20,r+10,i-20,r+10);let a=20;r+=20;for(let p=0;p<this.overtimedata[g].mta.length;p++)if(t.text(this.overtimedata[g].mta[p].RealDate,a,r,{renderingMode:"fill"}),t.text(this.overtimedata[g].mta[p].Shift,a+70,r,{renderingMode:"fill"}),t.text(this.overtimedata[g].mta[p].InTime,a+140,r),t.text(this.overtimedata[g].mta[p].OutTime,a+210,r),t.text(this.overtimedata[g].mta[p].DayTotalMultiple,a+280,r),t.text(this.overtimedata[g].mta[p].OT_MTA,a+350,r),r+=10,r+30>n){t.addPage("a4","p"),s=20,t.setFontSize(8);for(let e of o)t.text(e,s,50,{maxWidth:60}),s+=70;t.line(20,55,i-20,55),t.setFontSize(8),t.text("Overtime Attendance Report ",i/2,20,{align:"center",renderingMode:"fill"}).setFillColor("#FFFFFF"),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center",renderingMode:"fill"}),t.text(""+e,i-20,30,{align:"right"}),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.line(20,40,i-20,40),r=70,s=30,d=i/4,h=10,t.line(20,r,i-20,r),r+=30,l+=1}t.line(20,r,i-20,r),r+=10,t.text(this.overtimedata[g].Total_Working_Hours,a+280,r),t.text(this.overtimedata[g].Total_OT,a+350,r),r+=5,t.line(20,r,i-20,r),r+=10,r+100>n&&(t.addPage("a4","p"),l=0)}t.save("Overtime_Report-"+a+".pdf")}overtimeExcelReport(){this.ngxuiloader.start();const t=this.common.getLocalStorage().ClientName,e=this.datepipe.transform(new Date,"dd/MM/yyyy");let a=new q.Workbook,i=a.addWorksheet("Mobile Attendance Report"),n=i.addRow(["Overtime Report"]);i.addRow([t]),n.font={name:"Comic Sans MS",family:4,size:16,underline:"double",bold:!0},i.addRow(["Report Generation Date : "+this.datepipe.transform(new Date,"dd MMM yyyy")]);let o="From : "+this.datepipe.transform(this.daterange[0],"dd MMM yyyy"),s="To : "+this.datepipe.transform(this.daterange[1],"dd MMM yyyy");i.addRow([o]),i.addRow([s]),i.addRow([]);let l=i.addRow(["ID","NAME","DEPARTMENT","ALPHANUMERIC","SHIFT","IN DATE","IN TIME","OUT TIME","TOTAL","OT"]);l.font={size:12,bold:!0},l.eachCell((t,e)=>{t.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"},bgColor:{argb:"FF0000FF"}},t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}});let r=[];for(let d=0;d<this.overtimedata.length;d++){r=[],"filo"==this.reportType?(r[1]=Number(this.overtimedata[d].Id),r[2]=this.overtimedata[d].Name,r[3]=this.overtimedata[d].Department,r[4]=this.overtimedata[d].Alfanumeric):"mta"==this.reportType&&(r[1]=Number(this.overtimedata[d].ID),r[2]=this.overtimedata[d].Name,r[3]=this.overtimedata[d].dept,r[4]=this.overtimedata[d].Alfanumeric);let t=5;if("filo"==this.reportType)for(let a of this.overtimedata[d].OTReport){t=5,r[t]=a.Shift,t++,r[t]=a.InDate,t++,r[t]=a.InTime,t++,r[t]=a.OutTime,t++,r[t]=a.DayTotal,t++,r[t]=a.OT,t++;let e=i.addRow(r);e.alignment={vertical:"middle",horizontal:"center"},e.eachCell(t=>{t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}else if("mta"==this.reportType)for(let a of this.overtimedata[d].mta){t=5,r[t]=a.Shift,t++,r[t]=a.RealDate,t++,r[t]=a.InTime,t++,r[t]=a.OutTime,t++,r[t]=a.DayTotalMultiple,t++,r[t]=a.OT_MTA,t++;let e=i.addRow(r);e.alignment={vertical:"middle",horizontal:"center"},e.eachCell(t=>{t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}r=[],r[1]="TOTAL",r[t-2]=this.overtimedata[d].Total_Working_Hours,r[t-1]=this.overtimedata[d].Total_OT;let e=i.addRow(r);e.alignment={vertical:"middle",horizontal:"center"},e.eachCell(t=>{t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}i.getColumn(1).width=15,i.getColumn(2).width=20,i.getColumn(3).width=25,i.getColumn(4).width=15,i.getColumn(5).width=12,i.getColumn(6).width=12,i.getColumn(7).width=12,i.getColumn(8).width=12,i.getColumn(9).width=12,i.getColumn(10).width=30,i.getColumn(11).width=30,i.getColumn(10).alignment={vertical:"middle",horizontal:"center",wrapText:!0},i.getColumn(11).alignment={vertical:"middle",horizontal:"center",wrapText:!0},a.xlsx.writeBuffer().then(t=>{let a=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});w.saveAs(a,"Overtime Report_"+e+".xlsx")}),this.ngxuiloader.stop()}makerCheckerExcelReport(){this.ngxuiloader.start();let t=[],e="Maker Checker Report";for(let g=0;g<this.makerCheckerData.length;g++){let e=this.makerCheckerData[g];t.push([Number(e.EmpId),e.Name,e.Alfanumeric,e.RealDate,e.RealTime,e.InOutStatus,e.OldDate,e.OldTime,e.CheckedBy,e.RO_Name,e.CheckerTimeStamp,e.MakerTimeStamp,e.Reason,e.Status,e.ProcessStatus])}const a=this.common.getLocalStorage().ClientName,i=t,n=this.datepipe.transform(new Date,"dd/MM/yyyy");let o=new q.Workbook,s=o.addWorksheet(e),l=s.addRow([e]);s.addRow([a]),l.font={name:"Comic Sans MS",family:4,size:16,underline:"double",bold:!0},s.addRow(["Report Generation Date : "+this.datepipe.transform(new Date,"dd MMM yyyy")]);let r="FromDate : "+this.datepipe.transform(this.daterange[0],"dd MMM yyyy"),d="ToDate : "+this.datepipe.transform(this.daterange[1],"dd MMM yyyy");s.addRow([r]),s.addRow([d]),s.addRow([]);let h=s.addRow(["ID","NAME","ALPHANUMERIC","REALDATE","REALTIME","INOUTSTATUS","OLDDATE","OLDTIME","CHECKED_BY","RO_NAME","CHECKER_TIMESTAMP","MAKER_TIMESTAMP","REASON","STATUS","PROCESS_STATUS"]);h.font={size:12,bold:!0},h.eachCell((t,e)=>{t.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"},bgColor:{argb:"FF0000FF"}},t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),i.forEach(t=>{s.addRow(t).eachCell(t=>{t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}),s.getColumn(1).width=15,s.getColumn(2).width=20,s.getColumn(3).width=20,s.getColumn(4).width=20,s.getColumn(5).width=20,s.getColumn(5).width=15,s.getColumn(5).width=15,o.xlsx.writeBuffer().then(t=>{let e=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});w.saveAs(e,"Maker_checker_Report_"+n+".xlsx")}),this.ngxuiloader.stop()}accessControlExcelReport(){this.ngxuiloader.start();let t=[],e="Access Control Report";for(let h=0;h<this.accessControlData.length;h++){let e=this.accessControlData[h];t.push([Number(e.ID),e.Name,e.RealDate,e.RealTime,e.InOutStatus,e.Alias])}const a=this.common.getLocalStorage().ClientName,i=this.datepipe.transform(new Date,"dd/MM/yyyy");let n=new q.Workbook,o=n.addWorksheet(e),s=o.addRow([e]);o.addRow([a]),s.font={name:"Comic Sans MS",family:4,size:16,underline:"double",bold:!0},o.addRow(["Report Generation Date : "+this.datepipe.transform(new Date,"dd MMM yyyy")]);let l="FromDate : "+this.datepipe.transform(this.daterange[0],"dd MMM yyyy"),r="ToDate : "+this.datepipe.transform(this.daterange[1],"dd MMM yyyy");o.addRow([l]),o.addRow([r]),o.addRow([]);let d=o.addRow(["ID","NAME","REALDATE","REALTIME","INOUTSTATUS","DEVICE DESCRIPTION"]);d.font={size:12,bold:!0},d.eachCell((t,e)=>{t.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"},bgColor:{argb:"FF0000FF"}},t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),t.forEach(t=>{o.addRow(t).eachCell(t=>{t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}),o.getColumn(1).width=15,o.getColumn(2).width=20,o.getColumn(3).width=20,o.getColumn(4).width=20,o.getColumn(5).width=20,o.getColumn(6).width=25,n.xlsx.writeBuffer().then(t=>{let e=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});w.saveAs(e,"Access_Control_Report_"+i+".xlsx")}),this.ngxuiloader.stop()}accessControlPDFReport(){var t=new f.jsPDF("p","pt","a4");let e="ACCESS CONTROL REPORT";const a=this.datepipe.transform(new Date,"d MMM y, h:mm:ss a"),i=this.datepipe.transform(new Date,"dd/MM/yyyy-h:mm:ss a");var n=t.internal.pageSize.width||t.internal.pageSize.getWidth(),o=t.internal.pageSize.height||t.internal.pageSize.getHeight();t.setFontSize(8),t.text(e,n/2,20,{align:"center"}),t.text(this.common.getLocalStorage().ClientName,n/2,30,{align:"center"}),t.text(""+a,n-20,30,{align:"right"}),t.setFontSize(8),t.setFontSize(7),t.line(20,40,n-20,40),t.setFontSize(8),t.text("ID",30,60,{align:"left"}),t.text("NAME",80,60,{align:"left"}),t.text("DEPARTMENT",180,60,{align:"left"}),t.text("REALDATE",260,60,{align:"left"}),t.text("REALTIME",360,60,{align:"left"}),t.text("DEVICE",460,60,{align:"left"}),t.line(20,70,n-20,70);let s=1,l=80,r=10;for(let d=0;d<this.accessControlData.length;d++)0==s&&(t.setFontSize(8),t.text(e,n/2,20,{align:"center",renderingMode:"fill"}).setFillColor("#FFFFFF"),t.text(this.common.getLocalStorage().ClientName,n/2,30,{align:"center",renderingMode:"fill"}),t.text(""+a,n-20,30,{align:"right"}),t.setFontSize(8),t.line(20,40,n-20,40),t.setFontSize(8),t.text("ID",30,60,{align:"left"}),t.text("NAME",80,60,{align:"left"}),t.text("DEPARTMENT",180,60,{align:"left"}),t.text("REALDATE",260,60,{align:"left"}),t.text("REALTIME",360,60,{align:"left"}),t.text("DEVICE",460,60,{align:"left"}),t.line(20,70,n-20,70),l=80),r=10,t.setFontSize(7),t.text(this.accessControlData[d].ID,20,l),t.text(this.accessControlData[d].Name,80,l,{maxWidth:95}),t.text(this.accessControlData[d].Dept_Name,180,l),t.text(this.accessControlData[d].RealDate,260,l),t.text(this.accessControlData[d].RealTime,360,l),t.text(this.accessControlData[d].Alias,460,l),l+=10,s+=1,l+100>o&&(t.addPage("a4","p"),s=0);t.save("AccessControl-"+i+".pdf")}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(s.F),p.Y36(m.v),p.Y36(v._W),p.Y36(d.uU),p.Y36(g.LA))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-subreport"]],viewQuery:function(t,e){if(1&t&&(p.Gf(qe,5),p.Gf(we,5)),2&t){let t;p.iGM(t=p.CRH())&&(e.empsearch=t.first),p.iGM(t=p.CRH())&&(e.reporttable=t.first)}},decls:40,vars:13,consts:[[1,"py-2","container-flex"],[1,"row"],[1,"col-sm-6",2,"border-right","1px solid"],[1,"row","mb-3"],["for","input1",1,"col-sm-4","col-form-label",2,"font-weight","bold"],[2,"color","red"],[1,"col-sm-8"],["name","selectedReports",1,"browser-default","custom-select",3,"ngModel","ngModelChange","change"],["selected","",3,"value"],[3,"value",4,"ngFor","ngForOf"],["class","text-danger","style","color: red;",4,"ngIf"],["class","row mb-3",4,"ngIf"],[1,"col-sm-12","d-flex","justify-content-center"],["appHeading","","mdbBtn","","type","button","size","md","mdbWavesEffect","",1,"buttonhover",3,"click"],[1,"text-danger",2,"font-weight","bold"],[1,"col-sm-6"],["component1",""],[1,"col-sm-2","col-form-label"],["class","container-flex p-2",4,"ngIf"],[3,"value"],[1,"text-danger",2,"color","red"],["for","input2",1,"col-sm-4","col-form-label",2,"font-weight","bold"],["type","text","name","daterange","placeholder","Select Date Range","autocomplete","off","bsDaterangepicker","","inputmode","none",1,"p-3","form-control",3,"ngModel","maxDate","bsConfig","ngModelChange","bsValueChange"],["for","input3",1,"col-sm-4","col-form-label",2,"font-weight","bold"],["type","date","id","input3",1,"form-control"],["date1",""],["for","input4",1,"col-sm-4","col-form-label",2,"font-weight","bold"],[1,"col-sm-4"],["mdbInput","","type","time","id","input4",1,"form-control"],["for","input5",1,"col-sm-4","col-form-label",2,"font-weight","bold"],["defaultLabel","--Select a Contractor--","optionLabel","Contractor_Name","optionValue","Contractor_Id","name","contractorname","display","chip",3,"options","ngModel","ngModelChange","onChange"],["for","input6",1,"col-sm-4","col-form-label",2,"font-weight","bold"],["defaultLabel","--Select a Department--","optionLabel","DeptName","optionValue","DeptId","name","deptname","display","chip",3,"options","ngModel","ngModelChange","onChange"],["for","input8",1,"col-sm-4","col-form-label",2,"font-weight","bold"],["name","designname",1,"browser-default","custom-select",3,"ngModel","ngModelChange","change"],["value","-1","selected",""],["for","input12",1,"col-sm-4","col-form-label",2,"font-weight","bold"],[1,"form-check"],["name","hangingPunch",3,"ngModel","binary","ngModelChange"],["for","input13",1,"col-sm-4","col-form-label",2,"font-weight","bold"],["aria-labelledby","example-radio-group-label","name","reporttype",1,"example-radio-group",3,"ngModel","ngModelChange"],["value","filo","id","filo",1,"example-radio-button",3,"checked"],["id","mta","value","mta",1,"example-radio-button"],[1,"container-flex","p-2"],["reporttable",""],[1,"col-sm-3"],[1,"col-sm-3",2,"margin-top","-5px"],["appHeading","","mdbBtn","","type","button","size","sm","mdbWavesEffect","",1,"buttonhover",3,"disabled","click"],[1,"fas","fa-download",2,"font-size","20px"],["appHeading","","mdbBtn","","type","button","size","sm","mdbWavesEffect","",1,"buttonhover",3,"click"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngFor","ngForOf"],[1,"newemp"],[1,"p-1"],[1,"table","table-responsive"],[1,"table","table-hover","table-bordered","table-striped"],["class","p-3",4,"ngIf"],[4,"ngIf"],[1,"p-3"],[1,"p-1","container"],[1,"table","table-responsive","col-sm-12"],[1,"table","table-bordered","table-hover","table-striped"],[2,"font-weight","bold"],[1,"table-responsive"]],template:function(t,e){1&t&&(p.TgZ(0,"div",0),p.TgZ(1,"div",1),p.TgZ(2,"div",2),p.TgZ(3,"form"),p.TgZ(4,"div",3),p.TgZ(5,"label",4),p._uU(6,"Reports "),p.TgZ(7,"sup",5),p._uU(8,"*"),p.qZA(),p.qZA(),p.TgZ(9,"div",6),p.TgZ(10,"select",7),p.NdJ("ngModelChange",function(t){return e.selectedReports=t})("change",function(){return e.getSelectedReportName()}),p.TgZ(11,"option",8),p._uU(12,"--Select Report Type--"),p.qZA(),p.YNc(13,ve,2,2,"option",9),p.qZA(),p.YNc(14,_e,2,0,"small",10),p.qZA(),p.qZA(),p.YNc(15,Re,8,4,"div",11),p.YNc(16,Ce,9,1,"div",11),p.YNc(17,Se,5,0,"div",11),p.YNc(18,Ie,5,2,"div",11),p.YNc(19,Ue,8,3,"div",11),p.YNc(20,Oe,9,3,"div",11),p.YNc(21,Le,6,2,"div",11),p.YNc(22,Je,9,2,"div",11),p.TgZ(23,"div",12),p.TgZ(24,"button",13),p.NdJ("click",function(){return e.showReport()}),p._uU(25,"Show"),p.qZA(),p._uU(26,"\xa0 "),p.TgZ(27,"button",13),p.NdJ("click",function(){return e.resetValue()}),p._uU(28,"Reset"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(29,"label",14),p.TgZ(30,"u"),p._uU(31,"Disclaimer: Data in the system prior to 01(one) hour is calculated, processed and shown."),p.qZA(),p.qZA(),p.qZA(),p.TgZ(32,"div",15),p._UZ(33,"app-employeesearch",null,16),p.qZA(),p.qZA(),p.TgZ(35,"label",17),p.TgZ(36,"sup",5),p._uU(37,"*"),p.qZA(),p._uU(38," Mandatory field"),p.qZA(),p.YNc(39,oa,27,9,"div",18),p.qZA()),2&t&&(p.xp6(10),p.Q6J("ngModel",e.selectedReports),p.xp6(1),p.Q6J("value","-1"),p.xp6(2),p.Q6J("ngForOf",e.reports_list),p.xp6(1),p.Q6J("ngIf",e.reporterror),p.xp6(1),p.Q6J("ngIf",e.DateRange),p.xp6(1),p.Q6J("ngIf",e.Date),p.xp6(1),p.Q6J("ngIf",e.HeadCount),p.xp6(1),p.Q6J("ngIf",e.daterange&&e.showcontractor),p.xp6(1),p.Q6J("ngIf",e.daterange),p.xp6(1),p.Q6J("ngIf",e.Desigination&&0!=e.deptname.length),p.xp6(1),p.Q6J("ngIf",e.Hanging),p.xp6(1),p.Q6J("ngIf","Overtime Report"==e.selectedReports),p.xp6(17),p.Q6J("ngIf",e.showtable))},directives:[c._Y,c.JL,c.F,c.EJ,c.JJ,c.On,c.YN,c.Kr,d.sg,d.O5,u.d,Z.mT,Z.b6,_.r,n.TB,c.Fj,n.FR,Z.Hq,i.NU,R.XZ,o.VQ,o.U0,d.RF,d.n9],styles:["[_nghost-%COMP%]     .p-multiselect{width:25vw}hr.newemp[_ngcontent-%COMP%]{border:2px solid #d2aef3;border-radius:5px}@media screen and (max-width:640px){[_nghost-%COMP%]     .p-multiselect{width:68vw}}"]}),t})();function la(t,e){if(1&t&&(p.TgZ(0,"option",4),p._uU(1),p.qZA()),2&t){const t=e.$implicit;p.Q6J("value",t),p.xp6(1),p.Oqu(t)}}function ra(t,e){1&t&&(p.TgZ(0,"div"),p.TgZ(1,"div",8),p.TgZ(2,"div",9),p.TgZ(3,"h1",10),p._uU(4,"Reports"),p.qZA(),p.qZA(),p.TgZ(5,"div",9),p.TgZ(6,"ul"),p.TgZ(7,"li"),p.TgZ(8,"h4"),p._uU(9,"Select Report Type "),p._UZ(10,"mdb-icon",11),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA())}function da(t,e){1&t&&(p.TgZ(0,"div"),p._UZ(1,"app-master-reports"),p.qZA())}function ha(t,e){1&t&&(p.TgZ(0,"div"),p._UZ(1,"app-attendance-reports"),p.qZA())}function ga(t,e){1&t&&(p.TgZ(0,"div"),p._UZ(1,"app-subreport"),p.qZA())}const pa=[{path:"",component:(()=>{class t{constructor(t,e,a){this.router=t,this.route=e,this.common=a,this.selectedRoute="Attendance Reports",this.spinner=g.aS,this.navbaroptions=["Master Reports","Attendance Reports","Sub Reports"]}ngOnInit(){this.selectedRoute="--Select Option--"}changeOption(t){this.selectedRoute=t.target.value}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(h.F0),p.Y36(h.gz),p.Y36(m.v))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-navbar-reports"]],decls:12,vars:10,consts:[[3,"fgsColor","fgsType"],[1,"mt-2","p-4"],[1,"col-sm-12","mb-2"],["appHeading","","name","selectedRoute",1,"py-3","text-center",2,"font-size","large","width","100%",3,"ngModel","ngModelChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"container","mt-5","p-2"],[1,"d-flex","justify-content-center"],[1,"text-primary"],["fas","","icon","arrow-up"]],template:function(t,e){1&t&&(p._UZ(0,"ngx-ui-loader",0),p.TgZ(1,"div",1),p.TgZ(2,"div",2),p.TgZ(3,"select",3),p.NdJ("ngModelChange",function(t){return e.selectedRoute=t}),p.TgZ(4,"option",4),p._uU(5,"--Select Option--"),p.qZA(),p.YNc(6,la,2,2,"option",5),p.qZA(),p.qZA(),p.TgZ(7,"div",6),p.YNc(8,ra,11,0,"div",7),p.YNc(9,da,2,0,"div",7),p.YNc(10,ha,2,0,"div",7),p.YNc(11,ga,2,0,"div",7),p.qZA(),p.qZA()),2&t&&(p.Q6J("fgsColor","white")("fgsType",e.spinner.rectangleBouncePulseOut),p.xp6(3),p.Q6J("ngModel",e.selectedRoute),p.xp6(1),p.Q6J("value","--Select Option--"),p.xp6(2),p.Q6J("ngForOf",e.navbaroptions),p.xp6(1),p.Q6J("ngSwitch",e.selectedRoute),p.xp6(1),p.Q6J("ngSwitchCase","--Select Option--"),p.xp6(1),p.Q6J("ngSwitchCase","Master Reports"),p.xp6(1),p.Q6J("ngSwitchCase","Attendance Reports"),p.xp6(1),p.Q6J("ngSwitchCase","Sub Reports"))},directives:[g.Jj,c.EJ,u.d,c.JJ,c.On,c.YN,c.Kr,d.sg,d.RF,d.n9,Z.Ui,Z.XI,b,xe,sa],styles:[""]}),t})()}];let ma=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=p.oAB({type:t}),t.\u0275inj=p.cJS({imports:[[h.Bz.forChild(pa)],h.Bz]}),t})();var ca=a(42693),ua=a(52309);const Za={bgsColor:"blue",bgsType:g.aS.rectangleBouncePulseOut};let Ta=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=p.oAB({type:t}),t.\u0275inj=p.cJS({providers:[m.v,d.uU,s.F,{provide:o._J,useValue:{color:"warn"}}],imports:[[d.ez,ma,Z.yi.forRoot(),c.u5,c.UX,g.Js.forRoot(Za),g.Cz.forRoot({showForeground:!0}),ca.JF,r.o,l.G,M._8,ua.N6,o.Fk,R.nD,C.TX,n.kn.forRoot(),i.q4,E.TU]]}),t})()}}]);