(self.webpackChunketam_prime=self.webpackChunketam_prime||[]).push([[448],{37448:(t,e,a)=>{"use strict";a.r(e),a.d(e,{ReportModule:()=>Te});var i=a(74855),n=a(61116),o=a(16304),s=a(62707),l=a(82051),d=a(23651),r=a(52279),h=a.n(r),g=a(35366),m=a(80712),p=a(9017),u=a(3492),c=a(81888),T=a(31041),Z=a(39313),f=a(37456),y=a(2619),A=a(82608),D=a(58150),x=a(95193);const b=["component1"];function q(t,e){if(1&t&&(g.TgZ(0,"option",19),g._uU(1),g.qZA()),2&t){const t=e.$implicit;g.Q6J("value",t),g.xp6(1),g.Oqu(t)}}function w(t,e){1&t&&(g.TgZ(0,"small",20),g._uU(1,"Please select Report "),g.qZA())}function v(t,e){1&t&&(g.TgZ(0,"small",20),g._uU(1,"Please select date range "),g.qZA())}function S(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",44),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).$implicit;g.xp6(2),g.Oqu(t.Type)}}function M(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",45),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).$implicit;g.xp6(2),g.Oqu(t.Type)}}function R(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",46),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).$implicit;g.xp6(2),g.Oqu(t.Type)}}function _(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",47),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).$implicit;g.xp6(2),g.Oqu(t.Type)}}function F(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",48),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).$implicit;g.xp6(2),g.Oqu(t.Type)}}function O(t,e){if(1&t&&(g.TgZ(0,"mdb-card",36),g.TgZ(1,"mdb-card-body",37),g.TgZ(2,"mdb-card-title",38),g.TgZ(3,"b"),g._uU(4),g.qZA(),g.qZA(),g.TgZ(5,"mdb-card-text"),g.TgZ(6,"div",39),g._uU(7),g.qZA(),g.TgZ(8,"div",40),g._uU(9),g.qZA(),g.TgZ(10,"div",41),g._uU(11),g.qZA(),g.TgZ(12,"div",42),g.TgZ(13,"div",26),g.YNc(14,S,3,1,"div",27),g.YNc(15,M,3,1,"div",27),g.YNc(16,R,3,1,"div",27),g.YNc(17,_,3,1,"div",27),g.YNc(18,F,3,1,"div",43),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA()),2&t){const t=g.oxw().$implicit;g.Q6J("mdbTooltip",t.InPunchDay),g.xp6(4),g.Oqu(t.InPunchDate),g.xp6(3),g.Oqu(t.InPunchTime),g.xp6(2),g.hij(" ",t.OutPunchTime,""),g.xp6(2),g.hij(" ",t.DayTotal,""),g.xp6(2),g.Q6J("ngSwitch",t.Type),g.xp6(1),g.Q6J("ngSwitchCase","A"),g.xp6(1),g.Q6J("ngSwitchCase","P"),g.xp6(1),g.Q6J("ngSwitchCase","P*"),g.xp6(1),g.Q6J("ngSwitchCase","L")}}function P(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",44),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).$implicit;g.xp6(2),g.Oqu(t.Type)}}function I(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",45),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).$implicit;g.xp6(2),g.Oqu(t.Type)}}function U(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",46),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).$implicit;g.xp6(2),g.Oqu(t.Type)}}function E(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",47),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).$implicit;g.xp6(2),g.Oqu(t.Type)}}function N(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",48),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).$implicit;g.xp6(2),g.Oqu(t.Type)}}function C(t,e){if(1&t&&(g.TgZ(0,"mdb-card",49),g.TgZ(1,"mdb-card-body",37),g.TgZ(2,"mdb-card-title",38),g.TgZ(3,"b"),g._uU(4),g.qZA(),g.qZA(),g.TgZ(5,"mdb-card-text"),g.TgZ(6,"div",39),g._uU(7),g.qZA(),g.TgZ(8,"div",40),g._uU(9),g.qZA(),g.TgZ(10,"div",41),g._uU(11),g.qZA(),g.TgZ(12,"div",42),g.TgZ(13,"div",26),g.YNc(14,P,3,1,"div",27),g.YNc(15,I,3,1,"div",27),g.YNc(16,U,3,1,"div",27),g.YNc(17,E,3,1,"div",27),g.YNc(18,N,3,1,"div",43),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA()),2&t){const t=g.oxw().$implicit;g.Q6J("mdbTooltip",t.InPunchDay),g.xp6(4),g.Oqu(t.InPunchDate),g.xp6(3),g.Oqu(t.InPunchTime),g.xp6(2),g.hij(" ",t.OutPunchTime,""),g.xp6(2),g.hij(" ",t.DayTotal," "),g.xp6(2),g.Q6J("ngSwitch",t.Type),g.xp6(1),g.Q6J("ngSwitchCase","A"),g.xp6(1),g.Q6J("ngSwitchCase","P"),g.xp6(1),g.Q6J("ngSwitchCase","P*"),g.xp6(1),g.Q6J("ngSwitchCase","L")}}function L(t,e){if(1&t&&(g.TgZ(0,"div",33),g.YNc(1,O,19,10,"mdb-card",34),g.YNc(2,C,19,10,"ng-template",null,35,g.W1O),g.qZA()),2&t){const t=e.$implicit,a=g.MAs(3);g.xp6(1),g.Q6J("ngIf","W"==t.Type)("ngIfElse",a)}}function z(t,e){if(1&t&&(g.TgZ(0,"div"),g._UZ(1,"hr",30),g.TgZ(2,"div",1),g.TgZ(3,"div",22),g.TgZ(4,"b"),g._uU(5,"ID : "),g.qZA(),g.TgZ(6,"h3"),g._uU(7),g.qZA(),g.qZA(),g.TgZ(8,"div",22),g.TgZ(9,"b"),g._uU(10,"NAME : "),g.qZA(),g.TgZ(11,"h3"),g._uU(12),g.qZA(),g.qZA(),g.TgZ(13,"div",22),g.TgZ(14,"b"),g._uU(15,"DEPARTMENT : "),g.qZA(),g.TgZ(16,"h3"),g._uU(17),g.qZA(),g.qZA(),g.TgZ(18,"div",22),g.TgZ(19,"b"),g._uU(20,"DESIGNATION : "),g.qZA(),g.TgZ(21,"h3"),g._uU(22),g.qZA(),g.qZA(),g.qZA(),g._UZ(23,"hr"),g.TgZ(24,"div",31),g.YNc(25,L,4,2,"div",32),g.qZA(),g.qZA()),2&t){const t=e.$implicit;g.xp6(7),g.Oqu(t.Id),g.xp6(5),g.Oqu(t.name),g.xp6(5),g.Oqu(t.Dept),g.xp6(5),g.Oqu(t.Desig),g.xp6(3),g.Q6J("ngForOf",t.info)}}const Y=function(){return[25,50]};function J(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"div"),g.YNc(1,z,26,5,"div",28),g.TgZ(2,"div"),g.TgZ(3,"mat-paginator",29),g.NdJ("page",function(e){g.CHM(t);const a=g.oxw(2);return a.OnPageChange(e,a.attendanceData)}),g.qZA(),g.qZA(),g.qZA()}if(2&t){const t=g.oxw(2);g.xp6(1),g.Q6J("ngForOf",t.pageSlice),g.xp6(2),g.Q6J("length",t.attendanceData.length)("pageSize",50)("pageSizeOptions",g.DdM(4,Y))}}function Q(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",44),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).index,e=g.oxw().$implicit;g.xp6(2),g.Oqu(e.status[t])}}function W(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",45),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).index,e=g.oxw().$implicit;g.xp6(2),g.hij("",e.status[t]," ")}}function j(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",46),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).index,e=g.oxw().$implicit;g.xp6(2),g.hij("",e.status[t]," ")}}function H(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",47),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).index,e=g.oxw().$implicit;g.xp6(2),g.hij("",e.status[t]," ")}}function $(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",48),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).index,e=g.oxw().$implicit;g.xp6(2),g.hij("",e.status[t]," ")}}function k(t,e){if(1&t&&(g.TgZ(0,"mdb-card",36),g.TgZ(1,"mdb-card-body",37),g.TgZ(2,"mdb-card-title",38),g.TgZ(3,"b"),g._uU(4),g.qZA(),g.qZA(),g.TgZ(5,"mdb-card-text"),g.TgZ(6,"div",39),g._uU(7),g.qZA(),g.TgZ(8,"div",40),g._uU(9),g.qZA(),g.TgZ(10,"div",41),g._uU(11),g.qZA(),g.TgZ(12,"div",42),g.TgZ(13,"div",26),g.YNc(14,Q,3,1,"div",27),g.YNc(15,W,3,1,"div",27),g.YNc(16,j,3,1,"div",27),g.YNc(17,H,3,1,"div",27),g.YNc(18,$,3,1,"div",43),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA()),2&t){const t=g.oxw().index,e=g.oxw().$implicit,a=g.oxw(3);g.Q6J("mdbTooltip",e.weekday[t]),g.xp6(4),g.Oqu(a.summaryDateArray[t]),g.xp6(3),g.Oqu(""==e.intime[t]?"?":e.intime[t]),g.xp6(2),g.hij(" ",e.outtime[t],""),g.xp6(2),g.hij(" ",e.total[t]," "),g.xp6(2),g.Q6J("ngSwitch",e.status[t]),g.xp6(1),g.Q6J("ngSwitchCase","A"),g.xp6(1),g.Q6J("ngSwitchCase","P"),g.xp6(1),g.Q6J("ngSwitchCase","P*"),g.xp6(1),g.Q6J("ngSwitchCase","L")}}function B(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",44),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).index,e=g.oxw().$implicit;g.xp6(2),g.hij("",e.status[t]," ")}}function G(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",45),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).index,e=g.oxw().$implicit;g.xp6(2),g.hij("",e.status[t]," ")}}function V(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",46),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).index,e=g.oxw().$implicit;g.xp6(2),g.hij("",e.status[t]," ")}}function X(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",47),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).index,e=g.oxw().$implicit;g.xp6(2),g.hij("",e.status[t]," ")}}function K(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",48),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).index,e=g.oxw().$implicit;g.xp6(2),g.hij("",e.status[t]," ")}}function tt(t,e){if(1&t&&(g.TgZ(0,"mdb-card",49),g.TgZ(1,"mdb-card-body",37),g.TgZ(2,"mdb-card-title",38),g.TgZ(3,"b"),g._uU(4),g.qZA(),g.qZA(),g.TgZ(5,"mdb-card-text"),g.TgZ(6,"div",39),g._uU(7),g.qZA(),g.TgZ(8,"div",40),g._uU(9),g.qZA(),g.TgZ(10,"div",41),g._uU(11),g.qZA(),g.TgZ(12,"div",42),g.TgZ(13,"div",26),g.YNc(14,B,3,1,"div",27),g.YNc(15,G,3,1,"div",27),g.YNc(16,V,3,1,"div",27),g.YNc(17,X,3,1,"div",27),g.YNc(18,K,3,1,"div",43),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA()),2&t){const t=g.oxw().index,e=g.oxw().$implicit,a=g.oxw(3);g.Q6J("mdbTooltip",e.weekday[t]),g.xp6(4),g.Oqu(a.summaryDateArray[t]),g.xp6(3),g.Oqu(e.intime[t]),g.xp6(2),g.hij(" ",e.outtime[t],""),g.xp6(2),g.hij(" ",e.total[t]," "),g.xp6(2),g.Q6J("ngSwitch",e.status[t]),g.xp6(1),g.Q6J("ngSwitchCase","A"),g.xp6(1),g.Q6J("ngSwitchCase","P"),g.xp6(1),g.Q6J("ngSwitchCase","P*"),g.xp6(1),g.Q6J("ngSwitchCase","L")}}function et(t,e){if(1&t&&(g.TgZ(0,"div",33),g.YNc(1,k,19,10,"mdb-card",34),g.YNc(2,tt,19,10,"ng-template",null,35,g.W1O),g.qZA()),2&t){const t=e.index,a=g.MAs(3),i=g.oxw().$implicit;g.xp6(1),g.Q6J("ngIf","W"==i.status[t])("ngIfElse",a)}}function at(t,e){if(1&t&&(g.TgZ(0,"div"),g._UZ(1,"hr",30),g.TgZ(2,"div",1),g.TgZ(3,"div",22),g.TgZ(4,"b"),g._uU(5,"ID : "),g.qZA(),g._uU(6),g.qZA(),g.TgZ(7,"div",22),g.TgZ(8,"b"),g._uU(9,"NAME : "),g.qZA(),g._uU(10),g.qZA(),g.TgZ(11,"div",22),g.TgZ(12,"b"),g._uU(13,"DEPARTMENT : "),g.qZA(),g._uU(14),g.qZA(),g.TgZ(15,"div",22),g.TgZ(16,"b"),g._uU(17,"DESIGNATION : "),g.qZA(),g._uU(18),g.qZA(),g.qZA(),g._UZ(19,"hr"),g.TgZ(20,"div",31),g.YNc(21,et,4,2,"div",32),g.qZA(),g._UZ(22,"hr"),g.TgZ(23,"div",50),g.TgZ(24,"div",51),g._UZ(25,"p-badge",52),g.TgZ(26,"b"),g._uU(27),g.qZA(),g._uU(28," Hrs "),g.qZA(),g.TgZ(29,"div",51),g._UZ(30,"p-badge",53),g.TgZ(31,"b"),g._uU(32),g.qZA(),g.qZA(),g.TgZ(33,"div",51),g._UZ(34,"p-badge",54),g.TgZ(35,"b"),g._uU(36),g.qZA(),g.qZA(),g.TgZ(37,"div",51),g._UZ(38,"p-badge",55),g.TgZ(39,"b"),g._uU(40),g.qZA(),g.qZA(),g.TgZ(41,"div",51),g._UZ(42,"p-badge",56),g.TgZ(43,"b"),g._uU(44),g.qZA(),g.qZA(),g.TgZ(45,"div",51),g._UZ(46,"p-badge",57),g.TgZ(47,"b"),g._uU(48),g.qZA(),g.qZA(),g.TgZ(49,"div",51),g._UZ(50,"p-badge",58),g.TgZ(51,"b"),g._uU(52),g.qZA(),g.qZA(),g.TgZ(53,"div",51),g._UZ(54,"p-badge",59),g.TgZ(55,"b"),g._uU(56),g.qZA(),g.qZA(),g.TgZ(57,"div",51),g._UZ(58,"p-badge",60),g.TgZ(59,"b"),g._uU(60),g.qZA(),g.qZA(),g.TgZ(61,"div",51),g._UZ(62,"p-badge",61),g.TgZ(63,"b"),g._uU(64),g.qZA(),g.qZA(),g.TgZ(65,"div",51),g._UZ(66,"p-badge",62),g.TgZ(67,"b"),g._uU(68),g.qZA(),g.qZA(),g.TgZ(69,"div",51),g._UZ(70,"p-badge",63),g.TgZ(71,"b"),g._uU(72),g.qZA(),g.qZA(),g.TgZ(73,"div",51),g._UZ(74,"p-badge",64),g.TgZ(75,"b"),g._uU(76),g.qZA(),g.qZA(),g.TgZ(77,"div",51),g._UZ(78,"p-badge",65),g.TgZ(79,"b"),g._uU(80),g.qZA(),g.qZA(),g.TgZ(81,"div",51),g._UZ(82,"p-badge",66),g.TgZ(83,"b"),g._uU(84),g.qZA(),g.qZA(),g.TgZ(85,"div",51),g._UZ(86,"p-badge",67),g.TgZ(87,"b"),g._uU(88),g.qZA(),g.qZA(),g.qZA(),g.qZA()),2&t){const t=e.$implicit,a=g.oxw(3);g.xp6(6),g.Oqu(t.id),g.xp6(4),g.Oqu(t.name),g.xp6(4),g.Oqu(t.dept),g.xp6(4),g.Oqu(t.desig),g.xp6(3),g.Q6J("ngForOf",a.counter(a.selectedDays+1)),g.xp6(6),g.hij(" : ",t.totalmformonth,""),g.xp6(5),g.hij(" : ",t.present,""),g.xp6(4),g.hij(" : ",t.absent,""),g.xp6(4),g.hij(" : ",t.holiday,""),g.xp6(4),g.hij(" : ",t.weeklyof,""),g.xp6(4),g.hij(" : ",t.Pendingoff,""),g.xp6(4),g.hij(" : ",t.Nightoff,""),g.xp6(4),g.hij(" : ",t.Valleyoff,""),g.xp6(4),g.hij(" : ",t.leave,""),g.xp6(4),g.hij(" : ",t.LWP,""),g.xp6(4),g.hij(" : ",t.tour,""),g.xp6(4),g.hij(" : ",t.halfDay,""),g.xp6(4),g.hij(" : ",t.late,""),g.xp6(4),g.hij(" : ",t.early,""),g.xp6(4),g.hij(" : ",t.erdays,""),g.xp6(4),g.hij(" : ",t.ltdays,"")}}function it(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"div"),g.YNc(1,at,89,21,"div",28),g.TgZ(2,"div"),g.TgZ(3,"mat-paginator",29),g.NdJ("page",function(e){g.CHM(t);const a=g.oxw(2);return a.OnPageChange(e,a.summarydata)}),g.qZA(),g.qZA(),g.qZA()}if(2&t){const t=g.oxw(2);g.xp6(1),g.Q6J("ngForOf",t.pageSlice),g.xp6(2),g.Q6J("length",t.summarydata.length)("pageSize",50)("pageSizeOptions",g.DdM(4,Y))}}function nt(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",44),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).index,e=g.oxw().$implicit;g.xp6(2),g.Oqu(e.status[t])}}function ot(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",45),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).index,e=g.oxw().$implicit;g.xp6(2),g.hij("",e.status[t]," ")}}function st(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",46),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).index,e=g.oxw().$implicit;g.xp6(2),g.hij("",e.status[t]," ")}}function lt(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",47),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).index,e=g.oxw().$implicit;g.xp6(2),g.hij("",e.status[t]," ")}}function dt(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",48),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).index,e=g.oxw().$implicit;g.xp6(2),g.hij("",e.status[t]," ")}}function rt(t,e){if(1&t&&(g.TgZ(0,"mdb-card",70),g.TgZ(1,"mdb-card-body",37),g.TgZ(2,"mdb-card-title",38),g.TgZ(3,"b"),g._uU(4),g.qZA(),g.qZA(),g.TgZ(5,"mdb-card-text"),g.TgZ(6,"div",42),g.TgZ(7,"div",26),g.YNc(8,nt,3,1,"div",27),g.YNc(9,ot,3,1,"div",27),g.YNc(10,st,3,1,"div",27),g.YNc(11,lt,3,1,"div",27),g.YNc(12,dt,3,1,"div",43),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA()),2&t){const t=g.oxw().index,e=g.oxw().$implicit,a=g.oxw(3);g.xp6(4),g.Oqu(a.summaryDateArray[t]),g.xp6(3),g.Q6J("ngSwitch",e.status[t]),g.xp6(1),g.Q6J("ngSwitchCase","A"),g.xp6(1),g.Q6J("ngSwitchCase","P"),g.xp6(1),g.Q6J("ngSwitchCase","P*"),g.xp6(1),g.Q6J("ngSwitchCase","L")}}function ht(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",44),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).index,e=g.oxw().$implicit;g.xp6(2),g.hij("",e.status[t]," ")}}function gt(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",45),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).index,e=g.oxw().$implicit;g.xp6(2),g.hij("",e.status[t]," ")}}function mt(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",46),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).index,e=g.oxw().$implicit;g.xp6(2),g.hij("",e.status[t]," ")}}function pt(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",47),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).index,e=g.oxw().$implicit;g.xp6(2),g.hij("",e.status[t]," ")}}function ut(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",48),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).index,e=g.oxw().$implicit;g.xp6(2),g.hij("",e.status[t]," ")}}function ct(t,e){if(1&t&&(g.TgZ(0,"mdb-card"),g.TgZ(1,"mdb-card-body",37),g.TgZ(2,"mdb-card-title",38),g.TgZ(3,"b"),g._uU(4),g.qZA(),g.qZA(),g.TgZ(5,"mdb-card-text"),g.TgZ(6,"div",42),g.TgZ(7,"div",26),g.YNc(8,ht,3,1,"div",27),g.YNc(9,gt,3,1,"div",27),g.YNc(10,mt,3,1,"div",27),g.YNc(11,pt,3,1,"div",27),g.YNc(12,ut,3,1,"div",43),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA()),2&t){const t=g.oxw().index,e=g.oxw().$implicit,a=g.oxw(3);g.xp6(4),g.Oqu(a.summaryDateArray[t]),g.xp6(3),g.Q6J("ngSwitch",e.status[t]),g.xp6(1),g.Q6J("ngSwitchCase","A"),g.xp6(1),g.Q6J("ngSwitchCase","P"),g.xp6(1),g.Q6J("ngSwitchCase","P*"),g.xp6(1),g.Q6J("ngSwitchCase","L")}}function Tt(t,e){if(1&t&&(g.TgZ(0,"div",33),g.YNc(1,rt,13,6,"mdb-card",69),g.YNc(2,ct,13,6,"ng-template",null,35,g.W1O),g.qZA()),2&t){const t=e.index,a=g.MAs(3),i=g.oxw().$implicit;g.xp6(1),g.Q6J("ngIf","W"==i.status[t])("ngIfElse",a)}}function Zt(t,e){if(1&t&&(g.TgZ(0,"div"),g._UZ(1,"hr",30),g.TgZ(2,"div",1),g.TgZ(3,"div",22),g.TgZ(4,"b"),g._uU(5,"ID : "),g.qZA(),g._uU(6),g.qZA(),g.TgZ(7,"div",22),g.TgZ(8,"b"),g._uU(9,"NAME : "),g.qZA(),g._uU(10),g.qZA(),g.TgZ(11,"div",22),g.TgZ(12,"b"),g._uU(13,"DEPARTMENT : "),g.qZA(),g._uU(14),g.qZA(),g.TgZ(15,"div",22),g.TgZ(16,"b"),g._uU(17,"DESIGNATION : "),g.qZA(),g._uU(18),g.qZA(),g.qZA(),g._UZ(19,"hr"),g.TgZ(20,"div",31),g.YNc(21,Tt,4,2,"div",32),g.qZA(),g._UZ(22,"hr"),g.TgZ(23,"div",68),g.TgZ(24,"div",51),g._UZ(25,"p-badge",53),g.TgZ(26,"b"),g._uU(27),g.qZA(),g.qZA(),g.TgZ(28,"div",51),g._UZ(29,"p-badge",54),g.TgZ(30,"b"),g._uU(31),g.qZA(),g.qZA(),g.TgZ(32,"div",51),g._UZ(33,"p-badge",55),g.TgZ(34,"b"),g._uU(35),g.qZA(),g.qZA(),g.TgZ(36,"div",51),g._UZ(37,"p-badge",56),g.TgZ(38,"b"),g._uU(39),g.qZA(),g.qZA(),g.TgZ(40,"div",51),g._UZ(41,"p-badge",57),g.TgZ(42,"b"),g._uU(43),g.qZA(),g.qZA(),g.TgZ(44,"div",51),g._UZ(45,"p-badge",58),g.TgZ(46,"b"),g._uU(47),g.qZA(),g.qZA(),g.TgZ(48,"div",51),g._UZ(49,"p-badge",59),g.TgZ(50,"b"),g._uU(51),g.qZA(),g.qZA(),g.TgZ(52,"div",51),g._UZ(53,"p-badge",60),g.TgZ(54,"b"),g._uU(55),g.qZA(),g.qZA(),g.TgZ(56,"div",51),g._UZ(57,"p-badge",61),g.TgZ(58,"b"),g._uU(59),g.qZA(),g.qZA(),g.TgZ(60,"div",51),g._UZ(61,"p-badge",62),g.TgZ(62,"b"),g._uU(63),g.qZA(),g.qZA(),g.TgZ(64,"div",51),g._UZ(65,"p-badge",63),g.TgZ(66,"b"),g._uU(67),g.qZA(),g.qZA(),g.qZA(),g.qZA()),2&t){const t=e.$implicit,a=g.oxw(3);g.xp6(6),g.Oqu(t.id),g.xp6(4),g.Oqu(t.name),g.xp6(4),g.Oqu(t.dept),g.xp6(4),g.Oqu(t.desig),g.xp6(3),g.Q6J("ngForOf",a.counter(a.selectedDays+1)),g.xp6(6),g.hij(" : ",t.present,""),g.xp6(4),g.hij(" : ",t.absent,""),g.xp6(4),g.hij(" : ",t.holiday,""),g.xp6(4),g.hij(" : ",t.weeklyof,""),g.xp6(4),g.hij(" : ",t.Pendingoff,""),g.xp6(4),g.hij(" : ",t.Nightoff,""),g.xp6(4),g.hij(" : ",t.Valleyoff,""),g.xp6(4),g.hij(" : ",t.leave,""),g.xp6(4),g.hij(" : ",t.LWP,""),g.xp6(4),g.hij(" : ",t.tour,""),g.xp6(4),g.hij(" : ",t.halfDay,"")}}function ft(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"div"),g.YNc(1,Zt,68,16,"div",28),g.TgZ(2,"div"),g.TgZ(3,"mat-paginator",29),g.NdJ("page",function(e){g.CHM(t);const a=g.oxw(2);return a.OnPageChange(e,a.musterData)}),g.qZA(),g.qZA(),g.qZA()}if(2&t){const t=g.oxw(2);g.xp6(1),g.Q6J("ngForOf",t.pageSlice),g.xp6(2),g.Q6J("length",t.musterData.length)("pageSize",50)("pageSizeOptions",g.DdM(4,Y))}}function yt(t,e){if(1&t&&(g.TgZ(0,"tr",74),g.TgZ(1,"td"),g._uU(2),g.qZA(),g.TgZ(3,"td"),g._uU(4),g.qZA(),g.TgZ(5,"td"),g._uU(6),g.qZA(),g.TgZ(7,"td"),g._uU(8),g.qZA(),g.TgZ(9,"td"),g._uU(10),g.qZA(),g.TgZ(11,"td"),g._uU(12),g.qZA(),g.TgZ(13,"td"),g._uU(14,"ABSENT"),g.qZA(),g.qZA()),2&t){const t=e.$implicit;g.xp6(2),g.Oqu(t.id),g.xp6(2),g.Oqu(t.name),g.xp6(2),g.Oqu(t.Alfanumeric),g.xp6(2),g.Oqu(t.Dept),g.xp6(2),g.Oqu(t.Desig),g.xp6(2),g.Oqu(t.RealDate)}}function At(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"div"),g.TgZ(1,"div",71),g.TgZ(2,"table",72),g.TgZ(3,"thead"),g.TgZ(4,"tr"),g.TgZ(5,"th"),g._uU(6,"ID"),g.qZA(),g.TgZ(7,"th"),g._uU(8,"NAME"),g.qZA(),g.TgZ(9,"th"),g._uU(10,"ALPHA-NUMERIC"),g.qZA(),g.TgZ(11,"th"),g._uU(12,"DEPARTMENT"),g.qZA(),g.TgZ(13,"th"),g._uU(14,"DESIGNATION"),g.qZA(),g.TgZ(15,"th"),g._uU(16,"DATE"),g.qZA(),g.TgZ(17,"th"),g._uU(18,"ABSENT"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(19,"tbody"),g.YNc(20,yt,15,6,"tr",73),g.qZA(),g.qZA(),g.TgZ(21,"div"),g.TgZ(22,"mat-paginator",29),g.NdJ("page",function(e){g.CHM(t);const a=g.oxw(2);return a.OnPageChange(e,a.absentData)}),g.qZA(),g.qZA(),g.qZA(),g.qZA()}if(2&t){const t=g.oxw(2);g.xp6(20),g.Q6J("ngForOf",t.pageSlice),g.xp6(2),g.Q6J("length",t.absentData.length)("pageSize",50)("pageSizeOptions",g.DdM(4,Y))}}function Dt(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",44),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).$implicit;g.xp6(2),g.Oqu(t.Status)}}function xt(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",45),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).$implicit;g.xp6(2),g.Oqu(t.Status)}}function bt(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",46),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).$implicit;g.xp6(2),g.Oqu(t.Status)}}function qt(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",48),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).$implicit,e=g.oxw(4);g.xp6(2),g.Oqu(e.getValue(t.Status))}}function wt(t,e){if(1&t&&(g.TgZ(0,"mdb-card",70),g.TgZ(1,"mdb-card-body",75),g.TgZ(2,"mdb-card-title",38),g.TgZ(3,"b"),g._uU(4),g.qZA(),g.qZA(),g.TgZ(5,"mdb-card-text"),g.TgZ(6,"div",39),g._uU(7),g.qZA(),g.TgZ(8,"div",40),g._uU(9),g.qZA(),g.TgZ(10,"div",41),g._uU(11),g.qZA(),g.TgZ(12,"div",76),g._uU(13),g.qZA(),g.TgZ(14,"div",77),g._uU(15),g.qZA(),g.TgZ(16,"div",26),g.YNc(17,Dt,3,1,"div",27),g.YNc(18,xt,3,1,"div",27),g.YNc(19,bt,3,1,"div",27),g.YNc(20,qt,3,1,"div",43),g.qZA(),g.qZA(),g.qZA(),g.qZA()),2&t){const t=g.oxw().$implicit,e=g.oxw(4);g.xp6(1),g.Q6J("mdbTooltip",e.getDay(t.InDate)),g.xp6(3),g.Oqu(t.InDate),g.xp6(3),g.Oqu(e.getValue(t.InTime)),g.xp6(2),g.hij(" ",e.getValue(t.OutTime),""),g.xp6(2),g.hij(" ",e.getValue(t.DayTotal),""),g.xp6(2),g.hij(" ",e.getValue(t.BaseHr),""),g.xp6(2),g.hij(" ",e.getValue(t.OT),""),g.xp6(1),g.Q6J("ngSwitch",t.Status),g.xp6(1),g.Q6J("ngSwitchCase","A"),g.xp6(1),g.Q6J("ngSwitchCase","P"),g.xp6(1),g.Q6J("ngSwitchCase","HD")}}function vt(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",44),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).$implicit;g.xp6(2),g.Oqu(t.Status)}}function St(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",45),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).$implicit;g.xp6(2),g.hij("",t.Status," ")}}function Mt(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",46),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).$implicit;g.xp6(2),g.hij("",t.Status," ")}}function Rt(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",48),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).$implicit,e=g.oxw(4);g.xp6(2),g.Oqu(e.getValue(t.Status))}}function _t(t,e){if(1&t&&(g.TgZ(0,"mdb-card"),g.TgZ(1,"mdb-card-body",75),g.TgZ(2,"mdb-card-title",38),g.TgZ(3,"b"),g._uU(4),g.qZA(),g.qZA(),g.TgZ(5,"mdb-card-text"),g.TgZ(6,"div",39),g._uU(7),g.qZA(),g.TgZ(8,"div",40),g._uU(9),g.qZA(),g.TgZ(10,"div",41),g._uU(11),g.qZA(),g.TgZ(12,"div",76),g._uU(13),g.qZA(),g.TgZ(14,"div",77),g._uU(15),g.qZA(),g.TgZ(16,"div",42),g.TgZ(17,"div",26),g.YNc(18,vt,3,1,"div",27),g.YNc(19,St,3,1,"div",27),g.YNc(20,Mt,3,1,"div",27),g.YNc(21,Rt,3,1,"div",43),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA()),2&t){const t=g.oxw().$implicit,e=g.oxw(4);g.xp6(1),g.Q6J("mdbTooltip",e.getDay(t.InDate)),g.xp6(3),g.Oqu(t.InDate),g.xp6(3),g.Oqu(e.getValue(t.InTime)),g.xp6(2),g.hij(" ",e.getValue(t.OutTime),""),g.xp6(2),g.hij(" ",e.getValue(t.DayTotal),""),g.xp6(2),g.hij(" ",e.getValue(t.BaseHr),""),g.xp6(2),g.hij(" ",e.getValue(t.OT),""),g.xp6(2),g.Q6J("ngSwitch",t.Status),g.xp6(1),g.Q6J("ngSwitchCase","A"),g.xp6(1),g.Q6J("ngSwitchCase","P"),g.xp6(1),g.Q6J("ngSwitchCase","HD")}}function Ft(t,e){if(1&t&&(g.TgZ(0,"div",33),g.YNc(1,wt,21,11,"mdb-card",69),g.YNc(2,_t,22,11,"ng-template",null,35,g.W1O),g.qZA()),2&t){const t=e.$implicit,a=g.MAs(3);g.xp6(1),g.Q6J("ngIf","W"==t.Status)("ngIfElse",a)}}function Ot(t,e){if(1&t&&(g.TgZ(0,"div"),g._UZ(1,"hr",30),g.TgZ(2,"div",1),g.TgZ(3,"div",22),g.TgZ(4,"b"),g._uU(5,"ID : "),g.qZA(),g._uU(6),g.qZA(),g.TgZ(7,"div",22),g.TgZ(8,"b"),g._uU(9,"NAME : "),g.qZA(),g._uU(10),g.qZA(),g.TgZ(11,"div",22),g.TgZ(12,"b"),g._uU(13,"DEPARTMENT : "),g.qZA(),g._uU(14),g.qZA(),g.TgZ(15,"div",22),g.TgZ(16,"b"),g._uU(17,"DESIGNATION : "),g.qZA(),g._uU(18),g.qZA(),g.qZA(),g._UZ(19,"hr"),g.TgZ(20,"div",31),g.YNc(21,Ft,4,2,"div",32),g.qZA(),g.qZA()),2&t){const t=e.$implicit;g.xp6(6),g.Oqu(t.id),g.xp6(4),g.Oqu(t.name),g.xp6(4),g.Oqu(t.Dept),g.xp6(4),g.Oqu(t.Desig),g.xp6(3),g.Q6J("ngForOf",t.filo)}}function Pt(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"div"),g.YNc(1,Ot,22,5,"div",28),g.TgZ(2,"div"),g.TgZ(3,"mat-paginator",29),g.NdJ("page",function(e){g.CHM(t);const a=g.oxw(2);return a.OnPageChange(e,a.filoData)}),g.qZA(),g.qZA(),g.qZA()}if(2&t){const t=g.oxw(2);g.xp6(1),g.Q6J("ngForOf",t.pageSlice),g.xp6(2),g.Q6J("length",t.filoData.length)("pageSize",50)("pageSizeOptions",g.DdM(4,Y))}}function It(t,e){if(1&t&&(g.TgZ(0,"td",82),g._uU(1),g.qZA()),2&t){const t=g.oxw().$implicit;g.xp6(1),g.Oqu(t.InPremises)}}function Ut(t,e){if(1&t&&(g.TgZ(0,"td"),g._uU(1),g.qZA()),2&t){const t=g.oxw().$implicit;g.xp6(1),g.Oqu(t.InEnteredFrom)}}function Et(t,e){if(1&t&&(g.TgZ(0,"td",82),g._uU(1),g.qZA()),2&t){const t=g.oxw().$implicit;g.xp6(1),g.Oqu(t.OutPremises)}}function Nt(t,e){if(1&t&&(g.TgZ(0,"td"),g._uU(1),g.qZA()),2&t){const t=g.oxw().$implicit;g.xp6(1),g.Oqu(t.OutEnteredFrom)}}function Ct(t,e){if(1&t&&(g.TgZ(0,"tr"),g.TgZ(1,"td"),g._uU(2),g.qZA(),g.TgZ(3,"td"),g._uU(4),g.qZA(),g.TgZ(5,"td"),g._uU(6),g.qZA(),g.TgZ(7,"td"),g._uU(8),g.qZA(),g.TgZ(9,"td"),g._uU(10),g.qZA(),g.YNc(11,It,2,1,"td",80),g.YNc(12,Ut,2,1,"td",81),g.YNc(13,Et,2,1,"td",80),g.YNc(14,Nt,2,1,"td",81),g.qZA()),2&t){const t=e.$implicit;g.xp6(2),g.Oqu(t.InPunchDate),g.xp6(2),g.Oqu(t.InPunchTime),g.xp6(2),g.Oqu(t.OutPunchDate),g.xp6(2),g.Oqu(t.OutPunchTime),g.xp6(2),g.Oqu(t.Total),g.xp6(1),g.Q6J("ngIf","#"==t.InPremises),g.xp6(1),g.Q6J("ngIf","#"!=t.InPremises),g.xp6(1),g.Q6J("ngIf","#"==t.OutPremises),g.xp6(1),g.Q6J("ngIf","#"!=t.OutPremises)}}function Lt(t,e){if(1&t&&(g.TgZ(0,"div"),g._UZ(1,"hr",30),g.TgZ(2,"div",1),g.TgZ(3,"div",22),g.TgZ(4,"b"),g._uU(5,"ID : "),g.qZA(),g._uU(6),g.qZA(),g.TgZ(7,"div",22),g.TgZ(8,"b"),g._uU(9,"NAME : "),g.qZA(),g._uU(10),g.qZA(),g.TgZ(11,"div",22),g.TgZ(12,"b"),g._uU(13,"DEPARTMENT : "),g.qZA(),g._uU(14),g.qZA(),g.qZA(),g._UZ(15,"hr"),g.TgZ(16,"div",33),g.TgZ(17,"div",78),g.TgZ(18,"table",79),g.TgZ(19,"thead"),g.TgZ(20,"tr"),g.TgZ(21,"th"),g._uU(22,"InPunch Date"),g.qZA(),g.TgZ(23,"th"),g._uU(24,"InPunch Time"),g.qZA(),g.TgZ(25,"th"),g._uU(26,"OutPunch Date"),g.qZA(),g.TgZ(27,"th"),g._uU(28,"OutPunch Time"),g.qZA(),g.TgZ(29,"th"),g._uU(30,"Total"),g.qZA(),g.TgZ(31,"th"),g._uU(32,"Entered From "),g.qZA(),g.TgZ(33,"th"),g._uU(34,"Out From"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(35,"tbody"),g.YNc(36,Ct,15,9,"tr",28),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA()),2&t){const t=e.$implicit;g.xp6(6),g.Oqu(t.Id),g.xp6(4),g.Oqu(t.Name),g.xp6(4),g.Oqu(t.Department),g.xp6(22),g.Q6J("ngForOf",t.MA)}}function zt(t,e){if(1&t&&(g.TgZ(0,"div"),g.YNc(1,Lt,37,4,"div",28),g.qZA()),2&t){const t=g.oxw(2);g.xp6(1),g.Q6J("ngForOf",t.mobileData)}}function Yt(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",44),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).$implicit;g.xp6(2),g.Oqu(t.Type)}}function Jt(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",45),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).$implicit;g.xp6(2),g.Oqu(t.Type)}}function Qt(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",46),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).$implicit;g.xp6(2),g.Oqu(t.Type)}}function Wt(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",47),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).$implicit;g.xp6(2),g.Oqu(t.Type)}}function jt(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",48),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).$implicit;g.xp6(2),g.Oqu(t.Type)}}function Ht(t,e){if(1&t&&(g.TgZ(0,"mdb-card",36),g.TgZ(1,"mdb-card-body",37),g.TgZ(2,"mdb-card-title",38),g.TgZ(3,"b"),g._uU(4),g.qZA(),g.qZA(),g.TgZ(5,"mdb-card-text"),g.TgZ(6,"div",39),g._uU(7),g.qZA(),g.TgZ(8,"div",40),g._uU(9),g.qZA(),g.TgZ(10,"div",41),g._uU(11),g.qZA(),g.TgZ(12,"div",42),g.TgZ(13,"div",26),g.YNc(14,Yt,3,1,"div",27),g.YNc(15,Jt,3,1,"div",27),g.YNc(16,Qt,3,1,"div",27),g.YNc(17,Wt,3,1,"div",27),g.YNc(18,jt,3,1,"div",43),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA()),2&t){const t=g.oxw().$implicit;g.Q6J("mdbTooltip",t.InPunchDay),g.xp6(4),g.Oqu(t.RealDate),g.xp6(3),g.Oqu(t.InTime),g.xp6(2),g.hij(" ",t.OutTime,""),g.xp6(2),g.hij(" ",t.DayTotalMultiple,""),g.xp6(2),g.Q6J("ngSwitch",t.Type),g.xp6(1),g.Q6J("ngSwitchCase","A"),g.xp6(1),g.Q6J("ngSwitchCase","P"),g.xp6(1),g.Q6J("ngSwitchCase","P*"),g.xp6(1),g.Q6J("ngSwitchCase","L")}}function $t(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",44),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).$implicit;g.xp6(2),g.Oqu(t.Type)}}function kt(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",45),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).$implicit;g.xp6(2),g.Oqu(t.Type)}}function Bt(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",46),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).$implicit;g.xp6(2),g.Oqu(t.Type)}}function Gt(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",47),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).$implicit;g.xp6(2),g.Oqu(t.Type)}}function Vt(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"mdb-badge",48),g._uU(2),g.qZA(),g.qZA()),2&t){const t=g.oxw(2).$implicit;g.xp6(2),g.Oqu(t.Type)}}function Xt(t,e){if(1&t&&(g.TgZ(0,"mdb-card",49),g.TgZ(1,"mdb-card-body",37),g.TgZ(2,"mdb-card-title",38),g.TgZ(3,"b"),g._uU(4),g.qZA(),g.qZA(),g.TgZ(5,"mdb-card-text"),g.TgZ(6,"div",39),g._uU(7),g.qZA(),g.TgZ(8,"div",40),g._uU(9),g.qZA(),g.TgZ(10,"div",41),g._uU(11),g.qZA(),g.TgZ(12,"div",42),g.TgZ(13,"div",26),g.YNc(14,$t,3,1,"div",27),g.YNc(15,kt,3,1,"div",27),g.YNc(16,Bt,3,1,"div",27),g.YNc(17,Gt,3,1,"div",27),g.YNc(18,Vt,3,1,"div",43),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA()),2&t){const t=g.oxw().$implicit;g.Q6J("mdbTooltip",t.InPunchDay),g.xp6(4),g.Oqu(t.RealDate),g.xp6(3),g.Oqu(t.InTime),g.xp6(2),g.hij(" ",t.OutTime,""),g.xp6(2),g.hij(" ",t.DayTotalMultiple," "),g.xp6(2),g.Q6J("ngSwitch",t.Type),g.xp6(1),g.Q6J("ngSwitchCase","A"),g.xp6(1),g.Q6J("ngSwitchCase","P"),g.xp6(1),g.Q6J("ngSwitchCase","P*"),g.xp6(1),g.Q6J("ngSwitchCase","L")}}function Kt(t,e){if(1&t&&(g.TgZ(0,"div",33),g.YNc(1,Ht,19,10,"mdb-card",34),g.YNc(2,Xt,19,10,"ng-template",null,35,g.W1O),g.qZA()),2&t){const t=e.$implicit,a=g.MAs(3);g.xp6(1),g.Q6J("ngIf","W"==t.Type)("ngIfElse",a)}}function te(t,e){if(1&t&&(g.TgZ(0,"div"),g._UZ(1,"hr",30),g.TgZ(2,"div",1),g.TgZ(3,"div",22),g.TgZ(4,"b"),g._uU(5,"ID : "),g.qZA(),g._uU(6),g.qZA(),g.TgZ(7,"div",22),g.TgZ(8,"b"),g._uU(9,"NAME : "),g.qZA(),g._uU(10),g.qZA(),g.TgZ(11,"div",22),g.TgZ(12,"b"),g._uU(13,"DEPARTMENT : "),g.qZA(),g._uU(14),g.qZA(),g.TgZ(15,"div",22),g.TgZ(16,"b"),g._uU(17,"DESIGNATION : "),g.qZA(),g._uU(18),g.qZA(),g.qZA(),g._UZ(19,"hr"),g.TgZ(20,"div",31),g.YNc(21,Kt,4,2,"div",32),g.qZA(),g.qZA()),2&t){const t=e.$implicit;g.xp6(6),g.Oqu(t.ID),g.xp6(4),g.Oqu(t.Name),g.xp6(4),g.Oqu(t.dept),g.xp6(4),g.Oqu(t.desig),g.xp6(3),g.Q6J("ngForOf",t.mta)}}function ee(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"div"),g.YNc(1,te,22,5,"div",28),g._UZ(2,"hr"),g.TgZ(3,"div"),g.TgZ(4,"mat-paginator",29),g.NdJ("page",function(e){g.CHM(t);const a=g.oxw(2);return a.OnPageChange(e,a.multiplePunchData)}),g.qZA(),g.qZA(),g.qZA()}if(2&t){const t=g.oxw(2);g.xp6(1),g.Q6J("ngForOf",t.pageSlice),g.xp6(3),g.Q6J("length",t.multiplePunchData.length)("pageSize",50)("pageSizeOptions",g.DdM(4,Y))}}function ae(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"div",21),g.TgZ(1,"h1"),g._uU(2),g.qZA(),g._UZ(3,"br"),g.TgZ(4,"div",1),g.TgZ(5,"div",22),g.TgZ(6,"b"),g._uU(7,"FromDate : "),g.qZA(),g.TgZ(8,"h2"),g._uU(9),g.qZA(),g.qZA(),g.TgZ(10,"div",22),g.TgZ(11,"b"),g._uU(12,"ToDate : "),g.qZA(),g.TgZ(13,"h2"),g._uU(14),g.qZA(),g.qZA(),g.TgZ(15,"div",23),g.TgZ(16,"button",24),g.NdJ("click",function(){return g.CHM(t),g.oxw().genericPdfReport()}),g._UZ(17,"i",25),g._uU(18,"\xa0Download PDF"),g.qZA(),g.qZA(),g.TgZ(19,"div",23),g.TgZ(20,"button",24),g.NdJ("click",function(){return g.CHM(t),g.oxw().genericExcelReport()}),g._UZ(21,"i",25),g._uU(22,"\xa0Download Excel"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(23,"div",26),g.YNc(24,J,4,5,"div",27),g.YNc(25,it,4,5,"div",27),g.YNc(26,ft,4,5,"div",27),g.YNc(27,At,23,5,"div",27),g.YNc(28,Pt,4,5,"div",27),g.YNc(29,zt,2,1,"div",27),g.YNc(30,ee,5,5,"div",27),g.qZA(),g.qZA()}if(2&t){const t=g.oxw();g.xp6(2),g.Oqu(t.reportName),g.xp6(7),g.Oqu(t.fromdatedisplay),g.xp6(5),g.Oqu(t.todatedisplay),g.xp6(9),g.Q6J("ngSwitch",t.selectedReports),g.xp6(1),g.Q6J("ngSwitchCase","Attendance Report"),g.xp6(1),g.Q6J("ngSwitchCase","Summary Report"),g.xp6(1),g.Q6J("ngSwitchCase","Muster Report"),g.xp6(1),g.Q6J("ngSwitchCase","Absent Report"),g.xp6(1),g.Q6J("ngSwitchCase","Time Attendance (FILO) Report"),g.xp6(1),g.Q6J("ngSwitchCase","Mobile Attendance Report"),g.xp6(1),g.Q6J("ngSwitchCase","Multiple Punches Time Attendance Report")}}let ie=(()=>{class t{constructor(t,e,a,i,n){this.reports=t,this.common=e,this.toast=a,this.datepipe=i,this.ngxuiloader=n,this.yearrange="2010:",this.nameerror=!1,this.name1error=!1,this.typeerror=!1,this.dateerror=!1,this.reporterror=!1,this.date1error=!1,this.deptname=[],this.selectedEmployee=[],this.tabledata=[],this.showtable=!1,this.selectedReports="-1",this.DateRange=!1,this.ContractorName=!0,this.DepartmentName=!0,this.SubDepartment=!0,this.Desigination=!0,this.EmployeeType=!0,this.Records=!1,this.Mode=!0,this.Date=!1,this.HeadCount=!1,this.Hanging=!1,this.PPunches=!1,this.hangingPunch=!1,this.multiplePunchData=[],this.p_star_punches=!1,this.summaryDateArray=[],this.dayarray=[],this.contractor_list=[],this.original_dept_list=[],this.showcontractor=!1,this.contractor="",this.RO_Login=!1,this.employees=[],this.ranges=[{value:[new Date,new Date],label:"Today"},{value:[new Date((new Date).setDate((new Date).getDate()-7)),new Date],label:"Last 7 Days"},{value:[new Date((new Date).getFullYear(),(new Date).getMonth(),1),new Date((new Date).setDate((new Date).getDate()-1))],label:"This Month"},{value:[new Date((new Date).getFullYear(),(new Date).getMonth()-1,1),new Date((new Date).getFullYear(),(new Date).getMonth(),0)],label:"Last Month"}],this.reports_list=["Time Attendance (FILO) Report","Summary Report","Mobile Attendance Report"],this.dept_list=[],this.desig_list=[],this.type_list=[],this.cont_list=[],this.sub_list=[],this.attendanceData=[],this.musterData=[],this.filoData=[],this.mobileData=[],this.absentData=[]}ngOnInit(){this.daterangeConfig={containerClass:"theme-dark-blue",showPreviousMonth:!0,isAnimated:!0,rangeInputFormat:"DD/MM/YYYY",maxDateRange:30,showClearButton:!0,clearPosition:"right",selectWeekDateRange:!0,ranges:this.ranges},this.RO_Login="Y"==this.common.getLocalStorage().userdetails.RO||"Y"==this.common.getLocalStorage().userdetails.HR,this.recordtype="M",this.reporttype="express",this.yearrange+=(new Date).getFullYear(),this.designname="-1",this.maxDateValue=new Date,this.maxDateValue.setMonth((new Date).getMonth()),this.maxDateValue.setFullYear((new Date).getFullYear()),this.maxDateValue.setDate((new Date).getDate()-1)}OnPageChange(t,e){const a=t.pageIndex*t.pageSize;let i=a+t.pageSize;i>e.length&&(i=e.length),this.pageSlice=e.slice(a,i)}getSelectedReportName(){if("-1"==this.selectedReports)return this.DateRange=!1,this.Date=!1,this.HeadCount=!1,this.Records=!1,this.PPunches=!1,this.Hanging=!1,void(this.reporterror=!0);this.reporterror=!1,"Employees Inside Premises Report"==this.selectedReports?(this.DateRange=!1,this.Date=!0,this.HeadCount=!0,this.Records=!1):(this.DateRange=!0,this.Date=!1,this.HeadCount=!1,this.Records=!0),this.PPunches="Time Attendance (FILO) Report"==this.selectedReports,"Attendance Report"==this.selectedReports?(this.maxDateValue=new Date,this.maxDateValue.setMonth((new Date).getMonth()),this.maxDateValue.setFullYear((new Date).getFullYear()),this.maxDateValue.setDate((new Date).getDate()-1),this.Records=!1):(this.maxDateValue=new Date,this.maxDateValue.setMonth((new Date).getMonth()),this.maxDateValue.setFullYear((new Date).getFullYear()),this.maxDateValue.setDate((new Date).getDate()-1)),"Edited Muster Report"==this.selectedReports?(this.ContractorName=!1,this.DepartmentName=!1,this.SubDepartment=!1,this.Desigination=!1,this.EmployeeType=!1):(this.ContractorName=!0,this.DepartmentName=!0,this.SubDepartment=!0,this.Desigination=!0,this.EmployeeType=!0),this.Hanging="Multiple Punches Time Attendance Report"==this.selectedReports,this.daterangeConfig.maxDateRange="Absent Report"==this.selectedReports?365:30,this.pageSlice=[],this.showtable=!1}onValueChange(t){this.RO_Login&&this.empsearch.getEmpListRO(),null==t&&(this.deptname=[],this.empsearch.showtable=!1)}contractorSelection(){var t=this;if(this.contractor="",this.deptname=[],this.empsearch.employees=[],0!=this.contractorname.length){this.contractor+=this.contractorname[0];for(let t=1;t<this.contractorname.length;t++)this.contractor+=","+this.contractorname[t];this.common.getDepartmentUnderContractor(this.contractor).subscribe(function(){var e=(0,o.Z)(function*(e){let a=yield e;if(null!=a.data&&0!=a.data.length){t.dept_list=[];for(let e=0;e<a.data.length;e++)for(let i=0;i<t.original_dept_list.length;i++)a.data[e]==t.original_dept_list[i].DeptId&&t.dept_list.push(t.original_dept_list[i])}else t.dept_list=[]});return function(t){return e.apply(this,arguments)}}())}else this.dept_list=this.original_dept_list}showEmployeeByDept(){this.nameerror=0==this.deptname.length,this.designname="-1";let t=this.datepipe.transform(this.daterange[0],"dd/MM/yyyy"),e=this.datepipe.transform(this.daterange[1],"dd/MM/yyyy");if(this.deptname.length==this.dept_list.length)this.empsearch.showEmployeeWithinRange(t,e,"All",this.contractor);else{let a="";for(let t=0;t<this.deptname.length;t++)this.dept_list.filter(e=>{e.DeptId==this.deptname[t]&&(a+=e.DeptId+",")});a=a.slice(0,-1),this.empsearch.showEmployeeWithinRange(t,e,a,this.contractor)}}showEmployeeByDesg(){let t=this.desig_list.filter(t=>t.DesignName==this.designname);this.empsearch.showEmployeeByDesgById(t[0].DesignId)}onCheckDate(){var t=new Date(this.daterange[0]),e=new Date(this.daterange[1]).getTime()-t.getTime();this.selectedDays=Math.floor(e/864e5)}counter(t){return new Array(t)}showReport(){if("-1"==this.selectedReports)return void(this.reporterror=!0);if(this.reporterror=!1,this.dateerror=null==this.daterange||null==this.daterange[0]||null==this.daterange[1],this.nameerror="-1"==this.deptname,this.reporterror||this.dateerror||this.nameerror)return;this.onCheckDate();let t=this.datepipe.transform(this.daterange[0],"dd/MM/yyyy"),e=this.datepipe.transform(this.daterange[1],"dd/MM/yyyy");this.fromdatedisplay=t,this.todatedisplay=e,this.reportName=this.selectedReports,this.common.insertLog("Report/Attendance/seen-"+this.reportName),"Attendance Report"==this.selectedReports?this.getAttendanceReport(t,e):"Multiple Punches Time Attendance Report"==this.selectedReports?this.getMultiplePunchesReport(t,e):"Summary Report"==this.selectedReports?this.getSummaryReport(t,e):"Muster Report"==this.selectedReports?this.getMusterReport(t,e):"Time Attendance (FILO) Report"==this.selectedReports?this.getTimeAttendanceFILOReport(t,e):"Mobile Attendance Report"==this.selectedReports&&this.getMobileAttendaceReport(t,e)}getSummaryReport(t,e){var a=this;return(0,o.Z)(function*(){a.summarydata=[],a.summaryDateArray=[],a.summaryDateArray.push(new Date(a.daterange[0]).getDate());let i=new Date(a.daterange[0]);for(let t=1;t<=a.selectedDays;t++)a.summaryDateArray.push(new Date(i.setDate(i.getDate()+1)).getDate());let n=[];if(a.RO_Login){a.selectedEmployee=a.empsearch.selectedEmployee;for(let t=0;t<a.selectedEmployee.length;t++)n.push(a.selectedEmployee[t].EmployeeId)}else n=[],n.push(a.common.getEmployeeId());let o={CID:a.common.getCid(),EmpId:n,FromDate:t,ToDate:e,ReportType:"summary",ReportMode:"express",RecordType:"M",isTaj:a.common.getLocalStorage().TAJ,LeaveDeduct:a.common.getLocalStorage().LeaveDeduct,LateMarks:a.common.getLocalStorage().LateMarks,ConsiderVIP:a.common.getLocalStorage().VIP};a.ngxuiloader.start();let s=yield a.reports.getSummaryReport(o).toPromise();a.ngxuiloader.stop(),1==s.errorcode&&(0!=s.data.length||null!=s.data?(a.summarydata=s.data,a.showtable=!0,a.pageSlice=a.summarydata.slice(0,50)):(a.tabledata=[],a.showtable=!1))})()}getAttendanceReport(t,e){var a=this;this.attendanceData=[],this.selectedEmployee=this.empsearch.selectedEmployee;let i=[];for(let o=0;o<this.selectedEmployee.length;o++)i.push(this.selectedEmployee[o].EmployeeId);let n=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],s={CID:this.common.getCid(),EmpId:i,FromDate:t,ToDate:e,ReportType:"express",ReportMode:"M"};this.reports.getAttendanceReport(s).subscribe(function(){var t=(0,o.Z)(function*(t){let e,i,o=yield t;if(1==o.errorcode)if(0!=o.data.length||null!=o.data){a.tabledata=o.data;for(let t=0;t<a.tabledata.length;t++){let o=a.tabledata[t].InPunchDate.split("/"),s=new Date(o[2],o[1]-1,o[0]),l=n[s.getDay()];0==t?(e={name:a.tabledata[t].name,Id:a.tabledata[t].Id,Dept:a.tabledata[t].Dept,Desig:a.tabledata[t].Desig,info:[{InPunchDate:a.datepipe.transform(s,"dd"),InPunchDay:l,InPunchTime:""==a.tabledata[t].InPunchTime?"?":a.tabledata[t].InPunchTime,OutPunchTime:""==a.tabledata[t].OutPunchTime?"?":a.tabledata[t].OutPunchTime,DayTotal:a.tabledata[t].DayTotal,Type:a.tabledata[t].Type}]},1==a.tabledata.length?a.attendanceData.push(e):a.tabledata[t].Id!=a.tabledata[t+1].Id&&(a.attendanceData.push(e),e={name:a.tabledata[t+1].name,Id:a.tabledata[t+1].Id,Dept:a.tabledata[t+1].Dept,Desig:a.tabledata[t+1].Desig,info:[]})):t==a.tabledata.length-1?(e.Id==a.tabledata[t].Id?(i={InPunchDate:a.datepipe.transform(s,"dd"),InPunchDay:l,InPunchTime:""==a.tabledata[t].InPunchTime?"?":a.tabledata[t].InPunchTime,OutPunchTime:""==a.tabledata[t].OutPunchTime?"?":a.tabledata[t].OutPunchTime,DayTotal:a.tabledata[t].DayTotal,Type:a.tabledata[t].Type},e.info.push(i)):e={name:a.tabledata[t].name,Id:a.tabledata[t].Id,Dept:a.tabledata[t].Dept,Desig:a.tabledata[t].Desig,info:[{InPunchDate:a.datepipe.transform(s,"dd"),InPunchDay:l,InPunchTime:""==a.tabledata[t].InPunchTime?"?":a.tabledata[t].InPunchTime,OutPunchTime:""==a.tabledata[t].OutPunchTime?"?":a.tabledata[t].OutPunchTime,DayTotal:a.tabledata[t].DayTotal,Type:a.tabledata[t].Type}]},a.attendanceData.push(e)):a.tabledata[t].Id==a.tabledata[t+1].Id?(i={InPunchDate:a.datepipe.transform(s,"dd"),InPunchDay:l,InPunchTime:""==a.tabledata[t].InPunchTime?"?":a.tabledata[t].InPunchTime,OutPunchTime:""==a.tabledata[t].OutPunchTime?"?":a.tabledata[t].OutPunchTime,DayTotal:a.tabledata[t].DayTotal,Type:a.tabledata[t].Type},e.info.push(i)):(i={InPunchDate:a.datepipe.transform(s,"dd"),InPunchDay:l,InPunchTime:""==a.tabledata[t].InPunchTime?"?":a.tabledata[t].InPunchTime,OutPunchTime:""==a.tabledata[t].OutPunchTime?"?":a.tabledata[t].OutPunchTime,DayTotal:a.tabledata[t].DayTotal,Type:a.tabledata[t].Type},e.info.push(i),a.attendanceData.push(e),e={name:a.tabledata[t+1].name,Id:a.tabledata[t+1].Id,Dept:a.tabledata[t+1].Dept,Desig:a.tabledata[t+1].Desig,info:[]})}a.showtable=!0,a.pageSlice=a.attendanceData.slice(0,50)}else a.tabledata=[],a.showtable=!1});return function(e){return t.apply(this,arguments)}}(),t=>{let e={Exception:t.message,id:this.common.getLocalStorage().LoginId,Api:"Attendance Report"};this.common.saveLog(e,"ApiException")})}getMusterReport(t,e){var a=this;this.musterData=[],this.summaryDateArray=[],this.dayarray=[];let i=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];this.summaryDateArray.push(new Date(this.daterange[0]).getDate()),this.dayarray.push(i[new Date(this.daterange[0]).getDay()]);let n=new Date(this.daterange[0]);for(let o=1;o<=this.selectedDays;o++)this.summaryDateArray.push(new Date(n.setDate(n.getDate()+1)).getDate()),this.dayarray.push(i[new Date(n).getDay()]);this.selectedEmployee=this.empsearch.selectedEmployee;let s=[];for(let o=0;o<this.selectedEmployee.length;o++)s.push(this.selectedEmployee[o].EmployeeId);let l={CID:this.common.getCid(),EmpId:s,FromDate:t,ToDate:e,ReportType:"muster",ReportMode:"express",RecordType:"M",isTaj:this.common.getLocalStorage().TAJ,LeaveDeduct:this.common.getLocalStorage().LeaveDeduct,LateMarks:this.common.getLocalStorage().LateMarks,ConsiderVIP:this.common.getLocalStorage().VIP};this.reports.getMusterReport(l).subscribe(function(){var t=(0,o.Z)(function*(t){let e=yield t;1==e.errorcode&&(0!=e.data.length||null!=e.data?(a.musterData=e.data,a.showtable=!0,a.pageSlice=a.musterData.slice(0,50)):(a.musterData=[],a.showtable=!1))});return function(e){return t.apply(this,arguments)}}(),t=>{let e={Exception:t.message,id:this.common.getLocalStorage().LoginId,Api:"Muster Report"};this.common.saveLog(e,"ApiException")})}getMultiplePunchesReport(t,e){var a=this;this.multiplePunchData=[],this.selectedEmployee=this.empsearch.selectedEmployee;let i=[];for(let o=0;o<this.selectedEmployee.length;o++)i.push(this.selectedEmployee[o].EmployeeId);let n={CID:this.common.getCid(),EmpId:i,FromDate:t,ToDate:e,ReportType:"MTA_RPT",ReportMode:"express",WithHanging:this.hangingPunch?"Y":"N"};this.reports.getMultiplePunchesReport(n).subscribe(function(){var t=(0,o.Z)(function*(t){let e=yield t;1==e.errorcode&&(0!=e.data.length||null!=e.data?(a.multiplePunchData=e.data,a.showtable=!0,a.pageSlice=a.multiplePunchData.slice(0,50)):(a.multiplePunchData=[],a.showtable=!1))});return function(e){return t.apply(this,arguments)}}(),t=>{let e={Exception:t.message,id:this.common.getLocalStorage().LoginId,Api:"MTA Report"};this.common.saveLog(e,"ApiException")})}getTimeAttendanceFILOReport(t,e){var a=this;return(0,o.Z)(function*(){a.summarydata=[],a.summaryDateArray=[],a.summaryDateArray.push(new Date(a.daterange[0]).getDate());for(let t=1;t<=a.selectedDays;t++)a.summaryDateArray.push(new Date(a.daterange[0]).getDate()+t);let i=[];if(a.RO_Login){a.selectedEmployee=a.empsearch.selectedEmployee;for(let t=0;t<a.selectedEmployee.length;t++)i.push(a.selectedEmployee[t].EmployeeId)}else i=[],i.push(a.common.getEmployeeId());let n={CID:a.common.getCid(),EmpId:i,FromDate:t,ToDate:e,ReportType:"filo",ReportMode:"express",RecordType:"M"};a.ngxuiloader.start();let o=yield a.reports.getFiloReport(n).toPromise();a.ngxuiloader.stop(),1==o.errorcode&&(0!=o.data.length||null!=o.data?(a.filoData=o.data,a.showtable=!0,a.pageSlice=a.filoData.slice(0,50)):(a.filoData=[],a.showtable=!1))})()}getMobileAttendaceReport(t,e){var a=this;let i=[];if(this.RO_Login){this.selectedEmployee=this.empsearch.selectedEmployee;for(let t=0;t<this.selectedEmployee.length;t++)i.push(this.selectedEmployee[t].EmployeeId)}else i=[],i.push(this.common.getEmployeeId());let n={CID:this.common.getCid(),EmpId:i,FromDate:t,ToDate:e,ReportType:"express",ReportMode:"M"};this.ngxuiloader.start(),this.reports.getMobileAttendanceReport(n).subscribe(function(){var t=(0,o.Z)(function*(t){let e=yield t;a.ngxuiloader.stop(),1==e.errorcode&&(0!=e.data.length||null!=e.data?(a.mobileData=yield e.data,a.showtable=yield!0):(a.mobileData=[],a.showtable=!1))});return function(e){return t.apply(this,arguments)}}(),t=>{let e={Exception:t.message,id:this.common.getLocalStorage().LoginId,Api:"Mobile Attendance Report"};this.common.saveLog(e,"ApiException")})}resetValue(){this.showtable=!1,this.empsearch.selectedEmployee=[],this.empsearch.showtable=!1,this.attendanceData=[],this.contractorname=[],this.empsearch.employees=[],this.selectedReports="-1",this.DateRange=!1,this.Date=!1,this.HeadCount=!1,this.Records=!1,this.PPunches=!1,this.Hanging=!1,this.daterange=void 0,this.deptname=[],this.designname="-1",this.reporttype="express",this.contractor=""}getAbsentReport(t,e){var a=this;this.summaryDateArray=[],this.summaryDateArray.push(new Date(this.daterange[0]).getDate());let i=new Date(this.daterange[0]);for(let o=1;o<=this.selectedDays;o++)this.summaryDateArray.push(new Date(i.setDate(i.getDate()+1)).getDate());this.selectedEmployee=this.empsearch.selectedEmployee;let n=[];for(let o=0;o<this.selectedEmployee.length;o++)n.push(this.selectedEmployee[o].EmployeeId);let s={CID:this.common.getCid(),EmpId:n,FromDate:t,ToDate:e,ReportType:"Absent Report",ReportMode:"express",Records:"M"};this.reports.getAbsentReport(s).subscribe(function(){var t=(0,o.Z)(function*(t){let e=yield t;1==e.errorcode?null!=e.data&&0!=e.data.length?(a.absentData=e.data,a.showtable=!0,a.pageSlice=a.absentData.slice(0,50)):(a.absentData=[],a.showtable=!1):(a.absentData=[],a.showtable=!1,a.toast.info(e.errormessage))});return function(e){return t.apply(this,arguments)}}(),t=>{let e={Exception:t.message,id:this.common.getLocalStorage().LoginId,Api:"Absent Report"};this.common.saveLog(e,"ApiException")})}getValue(t){return""==t?"?":t}getDay(t){let e=t.split("/");return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][new Date(e[2],e[1]-1,e[0]).getDay()]}genericExcelReport(){"Attendance Report"==this.selectedReports?this.attendanceExcelReport():"Summary Report"==this.selectedReports?this.summaryExcelReport():"Muster Report"==this.selectedReports?this.musterExcelReport():"Absent Report"==this.selectedReports?this.absentExcelReport():"Time Attendance (FILO) Report"==this.selectedReports?this.timeAttendanceFILOExcelReport():"Mobile Attendance Report"==this.selectedReports&&this.mobileAttendanceExcelReport()}genericPdfReport(){"Attendance Report"==this.selectedReports?this.attendancePdfReport():"Summary Report"==this.selectedReports?this.summaryPdfReport():"Muster Report"==this.selectedReports?this.musterPdfReport():"Absent Report"==this.selectedReports?this.absentPdfReport():"Time Attendance (FILO) Report"==this.selectedReports?this.timeAttendanceFILOPDFReport():"Mobile Attendance Report"==this.selectedReports&&this.mobileAttendancePDFReport()}timeAttendanceFILOPDFReport(){var t=new d.jsPDF("l","pt","a4");const e=this.datepipe.transform(new Date,"d MMM y, h:mm:ss a"),a=this.datepipe.transform(new Date,"dd/MM/yyyy-h:mm:ss a");var i=t.internal.pageSize.width||t.internal.pageSize.getWidth(),n=t.internal.pageSize.height||t.internal.pageSize.getHeight();t.setFontSize(8),t.text("Time Attendance Report (FILO)",i/2,20,{align:"center"}),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center"}),t.text(""+e,i-20,30,{align:"right"}),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.line(20,40,i-20,40);let o=["Date","Shift","Shift Start Time","Shift End Time","LunchOut","LunchIn","TimeIn","TimeOut","DayTotal","Attendance","Edit Status","Late","Early Go","Base Hour","OT"],s=20;t.setFontSize(8);for(let d of o)t.text(d,s,60,{maxWidth:40}),s+=50;t.line(20,85,i-20,85),t.setFontSize(7);let l=1,r=100;s=30;let h=i/4,g=10;for(let d=0;d<this.filoData.length;d++){if(0==l){s=20,t.setFontSize(8);for(let e of o)t.text(e,s,60,{maxWidth:40}),s+=50;t.line(20,85,i-20,85),t.setFontSize(8),t.text("Time Attendance Report (FILO)",i/2,20,{align:"center",renderingMode:"fill"}).setFillColor("#FFFFFF"),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center",renderingMode:"fill"}),t.text(""+e,i-20,30,{align:"right"}),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.line(20,40,i-20,40),r=100,s=30,h=i/4,g=10}g=10,t.setFontSize(8),t.text("ID : "+this.filoData[d].id,s,r,{align:"left"}),t.text("NAME : "+this.filoData[d].name,s+100,r,{align:"left"}),t.text("DEPARTMENT : "+this.filoData[d].Dept,s+300,r,{align:"left"}),t.text("DESIGNATION : "+this.filoData[d].Desig,s+500,r,{align:"left"}),t.setFontSize(8),t.line(20,r+10,i-20,r+10);let a=20;r+=20;for(let l=0;l<this.filoData[d].filo.length;l++)if(t.text(this.filoData[d].filo[l].InDate.substring(0,5),a,r,{renderingMode:"fill"}),t.text(this.filoData[d].filo[l].ShiftDesc,a+40,r,{renderingMode:"fill",maxWidth:50}),t.text(this.filoData[d].filo[l].ShiftStart.substring(0,5),a+100,r),t.text(this.filoData[d].filo[l].ShiftEnd.substring(0,5),a+150,r),t.text(this.filoData[d].filo[l].LunchOut.substring(0,5),a+200,r),t.text(this.filoData[d].filo[l].LunchIn.substring(0,5),a+250,r),t.text(this.filoData[d].filo[l].InTime,a+300,r),t.text(this.filoData[d].filo[l].OutTime,a+350,r),t.text(this.filoData[d].filo[l].DayTotal,a+400,r),t.text(this.filoData[d].filo[l].Status,a+450,r),t.text("",a+500,r),t.text(this.filoData[d].filo[l].Late,a+550,r),t.text(this.filoData[d].filo[l].Early,a+600,r),t.text(this.filoData[d].filo[l].BaseHr,a+650,r),t.text(this.filoData[d].filo[l].OT,a+700,r),r+=20,r+30>n){t.addPage("a4","l"),s=20,t.setFontSize(8);for(let e of o)t.text(e,s,60,{maxWidth:40}),s+=50;t.line(20,85,i-20,85),t.setFontSize(8),t.text("Time Attendance Report (FILO)",i/2,20,{align:"center",renderingMode:"fill"}).setFillColor("#FFFFFF"),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center",renderingMode:"fill"}),t.text(""+e,i-20,30,{align:"right"}),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.line(20,40,i-20,40),r=100,s=30,h=i/4,g=10}t.line(20,r,i-20,r),r+=10,l+=1,r+100>n&&(t.addPage("a4","l"),l=0)}t.save("Time_Attendance_Report (FILO)-"+a+".pdf")}timeAttendanceFILOExcelReport(){this.ngxuiloader.start();const t=this.common.getLocalStorage().ClientName,e=this.datepipe.transform(new Date,"dd/MM/yyyy");let a=new s.Workbook,i=a.addWorksheet("Time Attendance Filo Report"),n=i.addRow(["Time Attendance Filo Report"]);i.addRow([t]),n.font={name:"Comic Sans MS",family:4,size:16,underline:"double",bold:!0},i.addRow(["Report Generation Date : "+this.datepipe.transform(new Date,"dd MMM yyyy")]);let o="From : "+this.datepipe.transform(this.daterange[0],"dd MMM yyyy"),d="To : "+this.datepipe.transform(this.daterange[1],"dd MMM yyyy");i.addRow([o]),i.addRow([d]),i.addRow([]);let r=i.addRow(["ID","NAME","DEPARTMENT","DESIGNATION","INDATE","SHIFT-ID","SHIFT_DESC","SHIFT_START","SHIFT_END","LUNCHOUT","LUNCHIN","INTIME","INSTATUS","OUT","OUTTIME","OUTSTATUS","TOTAL","STATUS","MANUALEDIT","INGRACE","OUTGRACE","LATEUPTO","EARLYGO","LATE","EARLY","BASEHR","OT","DAYTOTALMULTIPLE","TIMEDIFF","LOCATION_CID","LOCATION_NAME","ALPHANUMERIC","VIP","GRADE","SUB-DEPT-NAME","CONTRACTOR_NAME","TYPE_DESC"]);r.font={size:12,bold:!0},r.eachCell((t,e)=>{t.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"},bgColor:{argb:"FF0000FF"}},t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}});let h=[];for(let s=0;s<this.filoData.length;s++){h=[],h[1]=Number(this.filoData[s].id),h[2]=this.filoData[s].name,h[3]=this.filoData[s].Dept,h[4]=this.filoData[s].Desig;let t=5;for(let e of this.filoData[s].filo){t=5,h[t]=e.InDate,t++,h[t]="",t++,h[t]=e.ShiftDesc,t++,h[t]=e.ShiftStart,t++,h[t]=e.ShiftEnd,t++,h[t]=e.LunchOut,t++,h[t]=e.LunchIn,t++,h[t]=e.InTime,t++,h[t]=e.InStatus,t++,h[t]=e.OutDate,t++,h[t]=e.OutTime,t++,h[t]=e.OutStatus,t++,h[t]=e.Total,t++,h[t]=e.Status,t++,h[t]="",t++,h[t]="",t++,h[t]="",t++,h[t]="",t++,h[t]="",t++,h[t]="",t++,h[t]=e.Late,t++,h[t]=e.Early,t++,h[t]=e.BaseHr,t++,h[t]=e.OT,t++,h[t]=e.TimeDiff,t++,h[t]=e.Location_Cid,t++,h[t]="",t++,h[t]=e.alfanumeric,t++,h[t]=e.vip,t++,h[t]=e.Grade,t++,h[t]=this.filoData[s].Sub_Dept,t++,h[t]="",t++,h[t]="",t++;let a=i.addRow(h);a.alignment={vertical:"middle",horizontal:"center"},a.eachCell(t=>{t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}}i.getColumn(1).width=15,i.getColumn(2).width=20,i.getColumn(3).width=25,i.getColumn(4).width=25,i.getColumn(5).width=12,i.getColumn(14).width=12,i.getColumn(32).width=15,a.xlsx.writeBuffer().then(t=>{let a=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});l.saveAs(a,"TimeAttendance_FILO_Report_"+e+".xlsx")}),this.ngxuiloader.stop()}multiplePunchesPDFReport(){var t=new d.jsPDF("l","pt","a4");const e=this.datepipe.transform(new Date,"d MMM y, h:mm:ss a"),a=this.datepipe.transform(new Date,"dd/MM/yyyy-h:mm:ss a");var i=t.internal.pageSize.width||t.internal.pageSize.getWidth(),n=t.internal.pageSize.height||t.internal.pageSize.getHeight();t.setFontSize(8),t.text("Multiple Punches Time Attendance Report",i/2,20,{align:"center"}),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center"}),t.text(""+e,i-20,30,{align:"right"}),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.line(20,40,i-20,40);let o=["Date","Shift","Shift Start Time","Shift End Time","LunchIn","LunchOut","TimeIn","TimeOut","Total","DayTotal","Attendance","Edit Status","Late","Early Go","Base Hour","OT"],s=20;t.setFontSize(8);for(let d of o)t.text(d,s,60,{maxWidth:45}),s+=50;t.line(20,85,i-20,85),t.setFontSize(8);let l=1,r=100;s=30;let h=i/4,g=10;for(let d=0;d<this.multiplePunchData.length;d++){if(0==l){s=20,t.setFontSize(8);for(let e of o)t.text(e,s,60,{maxWidth:45}),s+=50;t.line(20,85,i-20,85),t.setFontSize(8),t.text("Multiple Punches Time Attendance Report",i/2,20,{align:"center",renderingMode:"stroke"}),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center",renderingMode:"stroke"}),t.text(""+e,i-20,30,{align:"right"}),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.line(20,40,i-20,40),r=100,s=30,h=i/4,g=10}g=10,t.setFontSize(8),t.text("ID : "+this.multiplePunchData[d].ID,s,r,{align:"left"}),t.text("NAME : "+this.multiplePunchData[d].Name,s+100,r,{align:"left"}),t.text("DEPARTMENT : "+this.multiplePunchData[d].dept,s+300,r,{align:"left"}),t.text("DESIGNATION : "+this.multiplePunchData[d].desig,s+500,r,{align:"left"}),t.setFontSize(8),t.line(20,r+10,i-20,r+10);let a=20;r+=20;for(let l=0;l<this.multiplePunchData[d].mta.length;l++)if(t.setTextColor(0,0,255),t.text(this.multiplePunchData[d].mta[l].RealDate.substring(0,5),a,r,{renderingMode:"fill"}),t.text(this.multiplePunchData[d].mta[l].InTime,a+300,r),t.text(this.multiplePunchData[d].mta[l].OutTime,a+350,r),t.text(this.multiplePunchData[d].mta[l].Type,a+500,r),t.setTextColor(0,0,0),t.text(this.multiplePunchData[d].mta[l].Shift,a+50,r,{renderingMode:"fill",maxWidth:50}),t.text(this.multiplePunchData[d].mta[l].ShiftStart.substring(0,5),a+100,r),t.text(this.multiplePunchData[d].mta[l].ShiftEnd.substring(0,5),a+150,r),t.text(this.multiplePunchData[d].mta[l].LunchOut.substring(0,5),a+200,r),t.text(this.multiplePunchData[d].mta[l].LunchIn.substring(0,5),a+250,r),t.text(this.multiplePunchData[d].mta[l].DayTotalMultiple,a+400,r),t.text(this.multiplePunchData[d].mta[l].DayTotalRecurrence,a+450,r),t.text("",a+550,r),t.text(this.multiplePunchData[d].mta[l].Late,a+600,r),t.text(this.multiplePunchData[d].mta[l].Early,a+650,r),t.text(this.multiplePunchData[d].mta[l].BaseHr,a+700,r),t.text(this.multiplePunchData[d].mta[l].OT_MTA,a+750,r),r+=20,r+30>n){t.addPage("a4","l"),s=20,t.setFontSize(8);for(let e of o)t.text(e,s,60,{maxWidth:45}),s+=50;t.line(20,85,i-20,85),t.setFontSize(8),t.text("Multiple Punches Time Attendance Report",i/2,20,{align:"center",renderingMode:"fill"}).setFillColor("#FFFFFF"),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center",renderingMode:"fill"}),t.text(""+e,i-20,30,{align:"right"}),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.line(20,40,i-20,40),r=100,s=30,h=i/4,g=10}t.line(20,r,i-20,r),r+=10,l+=1,r+100>n&&(t.addPage("a4","l"),l=0)}t.save("Multiple Punches Time Attendance Report-"+a+".pdf")}multiplePunchesExcelReport(){this.ngxuiloader.start();const t=this.common.getLocalStorage().ClientName,e=this.datepipe.transform(new Date,"dd/MM/yyyy");let a=new s.Workbook,i=a.addWorksheet("Multiple Punches Time Attendance Report"),n=i.addRow(["Multiple Punches Time Attendance Report"]);i.addRow([t]),n.font={name:"Comic Sans MS",family:4,size:16,underline:"double",bold:!0},i.addRow(["Report Generation Date : "+this.datepipe.transform(new Date,"dd MMM yyyy")]);let o="From : "+this.datepipe.transform(this.daterange[0],"dd MMM yyyy"),d="To : "+this.datepipe.transform(this.daterange[1],"dd MMM yyyy");i.addRow([o]),i.addRow([d]),i.addRow([]);let r=i.addRow(["ID","NAME","DEPARTMENT","DESIGNATION","INDATE","SHIFT-ID","SHIFT_DESC","SHIFT_START","SHIFT_END","LUNCHOUT","LUNCHIN","INTIME","INSTATUS","OUTDATE","OUTTIME","OUTSTATUS","TOTAL","STATUS","MANUALEDIT","INGRACE","OUTGRACE","LATEUPTO","EARLYGO","LATE","EARLY","BASEHR","OT","DAYTOTALMULTIPLE","TIMEDIFF","LOCATION_CID","LOCATION_NAME","ALPHANUMERIC","VIP","GRADE","SUB-DEPT-NAME","CONTRACTOR_NAME","TYPE_DESC"]);r.font={size:12,bold:!0},r.eachCell((t,e)=>{t.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"},bgColor:{argb:"FF0000FF"}},t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}});let h=[];for(let s=0;s<this.multiplePunchData.length;s++){h=[],h[1]=Number(this.multiplePunchData[s].ID),h[2]=this.multiplePunchData[s].Name,h[3]=this.multiplePunchData[s].dept,h[4]=this.multiplePunchData[s].desig;let t=5;for(let e of this.multiplePunchData[s].mta){t=5,h[t]=e.RealDate,t++,h[t]=null==e.ShiftId?"":Number(e.ShiftId),t++,h[t]=e.Shift,t++,h[t]=e.ShiftStart,t++,h[t]=e.ShiftEnd,t++,h[t]=e.LunchOut,t++,h[t]=e.LunchIn,t++,h[t]=e.InTime,t++,h[t]="",t++,h[t]=e.OutDate,t++,h[t]=e.OutTime,t++,h[t]="",t++,h[t]=e.DayTotal,t++,h[t]=e.Type,t++,h[t]=e.ManualEdit,t++,h[t]=null==e.Ingrace?"":Number(e.Ingrace),t++,h[t]=null==e.Outgrace?"":Number(e.Outgrace),t++,h[t]=e.LateUpto,t++,h[t]=e.Earlygo,t++,h[t]=e.Late,t++,h[t]=e.Early,t++,h[t]=e.BaseHr,t++,h[t]=e.OT_MTA,t++,h[t]=e.DayTotalMultiple,t++,h[t]="",t++,h[t]=null==e.Location_Cid?"":Number(e.Location_Cid),t++,h[t]=e.In_Location_Cname,t++,h[t]=this.multiplePunchData[s].Alfanumeric,t++,h[t]=e.Vip,t++,h[t]="",t++,h[t]=this.multiplePunchData[s].Sub_Dept,t++,h[t]="",t++,h[t]="",t++;let a=i.addRow(h);a.alignment={vertical:"middle",horizontal:"center"},a.eachCell(t=>{t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}}i.getColumn(1).width=15,i.getColumn(2).width=20,i.getColumn(3).width=25,i.getColumn(4).width=25,i.getColumn(5).width=12,i.getColumn(14).width=12,i.getColumn(32).width=15,a.xlsx.writeBuffer().then(t=>{let a=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});l.saveAs(a,"Multiple Punches Time Attendance Report_"+e+".xlsx")}),this.ngxuiloader.stop()}attendanceExcelReport(){let t=[];for(let e=0;e<this.tabledata.length;e++)t.push([Number(this.tabledata[e].Id),this.tabledata[e].name,this.tabledata[e].Dept,this.tabledata[e].Sub_Dept,this.tabledata[e].Desig,this.tabledata[e].InPunchDate,this.tabledata[e].InPunchTime,this.tabledata[e].InPunchStatus,this.tabledata[e].OutPunchDate,this.tabledata[e].OutPunchTime,this.tabledata[e].OutPunchStatus,this.tabledata[e].DayTotal,this.tabledata[e].Type]);this.generateExcelReport("Attendance_Report","Attendance Report",["ID","NAME","DEPARTMENT","SUB-DEPARTMENT","DESIGNATION","INDATE","INTIME","INSTATUS","OUTDATE","OUTTIME","OUTSTATUS","DAYTOTAL","DAYSTATUS"],t)}attendancePdfReport(){var t=new d.jsPDF("l","pt","a4");const e=this.datepipe.transform(new Date,"d MMM y, h:mm:ss a"),a=this.datepipe.transform(new Date,"dd/MM/yyyy-h:mm:ss a");var i=t.internal.pageSize.width||t.internal.pageSize.getWidth(),n=t.internal.pageSize.height||t.internal.pageSize.getHeight();t.setFontSize(8),t.text("ATTENDANCE REPORT",i/2,20,{align:"center"}),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center"}),t.text(""+e,i-20,30,{align:"right"}),t.line(20,40,i-20,40),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"});let o=1,s=60,l=30,r=i/4,h=10;for(let d=0;d<this.attendanceData.length;d++){0==o&&(t.setFontSize(8),t.text("ATTENDANCE REPORT",i/2,20,{align:"center",renderingMode:"fill"}).setFillColor("#FFFFFF"),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center",renderingMode:"fill"}),t.text(""+e,i-20,30,{align:"right"}),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.line(20,40,i-20,40),s=60,l=30,r=i/4,h=10),h=10,t.setFontSize(8),t.text("ID : "+this.attendanceData[d].Id,l,s,{align:"left"}),t.text("NAME : "+this.attendanceData[d].name,l+100,s,{align:"left"}),t.text("DEPARTMENT : "+this.attendanceData[d].Dept,l+300,s,{align:"left"}),t.text("DESIGNATION : "+this.attendanceData[d].Desig,l+500,s,{align:"left"}),t.line(20,s+10,i-20,s+10),t.setFontSize(7),t.text("Date",20,s+20),t.text("Day",20,s+h+25),h+=15,t.text("IN",20,s+h+30),h+=15,t.text("OUT",20,s+h+30),h+=15,t.text("TOTAL",20,s+h+30),h+=15,t.text("STATUS",20,s+h+30),h+=15,t.line(20,s+h+20,i-20,s+h+20),t.line(20,s+23,i-20,s+23);let a=60;t.setFontSize(7);for(let e=0;e<this.attendanceData[d].info.length;e++)t.text(this.attendanceData[d].info[e].InPunchDate,a,s+20,{renderingMode:"fill"}),t.text(this.attendanceData[d].info[e].InPunchDay.substring(0,3),a,s+35,{renderingMode:"fill"}),t.text(this.attendanceData[d].info[e].InPunchTime.substring(0,5),a,s+50),t.text(this.attendanceData[d].info[e].OutPunchTime.substring(0,5),a,s+65),t.text(this.attendanceData[d].info[e].DayTotal.substring(0,5),a,s+80),t.text(this.attendanceData[d].info[e].Type,a,s+95),a+=25;s+=120,o+=1,s+100>n&&(t.addPage("a4","l"),o=0)}t.save("Attendance_report-"+a+".pdf")}summaryExcelReport(){this.ngxuiloader.start();let t=["CID","ID","NAME","DEPARTMENT","DESIGNATION","DATE"];for(let s=0;s<this.summaryDateArray.length;s++)t[s+6]=this.summaryDateArray[s];let e=["TotalFilo","Present","Absent","Holiday","Weekly Off","Pending Off","Night Off","Valley Off","Half Day","Policy","Leaves","Tour","Late","Early Go","Late Days","EarlyGo Days","LWP","TotalMTA","ParentCID","Parent Name","Location Name","Effective Date","Alphanumeric Id","Leave Late","LWP Late","Grade","SubDepartment"],a=t.length;for(let s of e)t[a]=s,a++;const i=this.common.getLocalStorage().ClientName,n=this.datepipe.transform(new Date,"dd/MM/yyyy");let o=new s.Workbook,d=o.addWorksheet("Summary Report"),r=d.addRow(["Summary Report"]);d.addRow([i]),r.font={name:"Comic Sans MS",family:4,size:16,underline:"double",bold:!0},d.addRow(["Report Generation Date : "+this.datepipe.transform(new Date,"dd MMM yyyy")]);let h="From : "+this.datepipe.transform(this.daterange[0],"dd MMM yyyy"),g="To : "+this.datepipe.transform(this.daterange[1],"dd MMM yyyy");d.addRow([h]),d.addRow([g]),d.addRow([]);let m=d.addRow(t);m.font={size:12,bold:!0},m.eachCell((t,e)=>{t.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"},bgColor:{argb:"FF0000FF"}},t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}});let p=[];for(let s=0;s<this.summarydata.length;s++){p[1]=Number(this.summarydata[s].cid),p[2]=Number(this.summarydata[s].id),p[3]=this.summarydata[s].name,p[4]=this.summarydata[s].dept,p[5]=this.summarydata[s].desig,p[6]="Day";let t=7;for(let n of this.summarydata[s].weekday)null!=n&&(p[t]=n,t++);p[t]=this.summarydata[s].totalmformonth,t++,p[t]=this.summarydata[s].present,t++,p[t]=this.summarydata[s].absent,t++,p[t]=this.summarydata[s].holiday,t++,p[t]=this.summarydata[s].weeklyof,t++,p[t]=this.summarydata[s].Pendingoff,t++,p[t]=this.summarydata[s].Nightoff,t++,p[t]=this.summarydata[s].Valleyoff,t++,p[t]=this.summarydata[s].halfDay,t++,p[t]=this.summarydata[s].policy,t++,p[t]=this.summarydata[s].leave,t++,p[t]=this.summarydata[s].tour,t++,p[t]=this.summarydata[s].late,t++,p[t]=this.summarydata[s].early,t++,p[t]=this.summarydata[s].ltdays,t++,p[t]=this.summarydata[s].erdays,t++,p[t]=this.summarydata[s].LWP,t++,p[t]="",t++,p[t]=null==this.summarydata[s].ParentCid?"":this.summarydata[s].ParentCid,t++,p[t]=null==this.summarydata[s].ParentName?"":this.summarydata[s].ParentName,t++;let e=0;for(let n of this.summarydata[s].inlocation)null!=n&&""!=n&&("mobile"==n.toLowerCase()&&(n=this.summarydata[s].locationcid[e]+" - "+n),p[t]=n),e++;t++,p[t]=null==this.summarydata[s].EffectiveDate?"":this.summarydata[s].EffectiveDate,t++,p[t]=this.summarydata[s].alfanumeric,t++,p[t]=this.summarydata[s].Leave_Late,t++,p[t]=this.summarydata[s].LWP_Late,t++,p[t]=this.summarydata[s].Grade,t++,p[t]=this.summarydata[s].Subdept,t++;let a=d.addRow(p);a.alignment={vertical:"middle",horizontal:"center"},a.eachCell(t=>{t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}});let i=[];i[6]="IN",t=7;for(let n of this.summarydata[s].intime)null!=n&&(i[t]=n,t++);a=d.addRow(i),a.alignment={vertical:"middle",horizontal:"center"},a.eachCell(t=>{t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),i=[],i[6]="OUT",t=7;for(let n of this.summarydata[s].outtime)null!=n&&(i[t]=n,t++);a=d.addRow(i),a.alignment={vertical:"middle",horizontal:"center"},a.eachCell(t=>{t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),i=[],i[6]="TOTAL",t=7;for(let n of this.summarydata[s].total)null!=n&&(i[t]=n,t++);a=d.addRow(i),a.alignment={vertical:"middle",horizontal:"center"},a.eachCell(t=>{t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),i=[],i[6]="STATUS",t=7;for(let n of this.summarydata[s].status)null!=n&&(i[t]=n,t++);a=d.addRow(i),a.alignment={vertical:"middle",horizontal:"center"},a.eachCell(t=>{t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}d.getColumn(2).width=15,d.getColumn(3).width=25,d.getColumn(4).width=25,d.getColumn(5).width=25,o.xlsx.writeBuffer().then(t=>{let e=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});l.saveAs(e,"Summary_Report_"+n+".xlsx")}),this.ngxuiloader.stop()}summaryPdfReport(){var t=new d.jsPDF("l","pt","a4");const e=this.datepipe.transform(new Date,"d MMM y, h:mm:ss a"),a=this.datepipe.transform(new Date,"dd/MM/yyyy-h:mm:ss a");var i=t.internal.pageSize.width||t.internal.pageSize.getWidth(),n=t.internal.pageSize.height||t.internal.pageSize.getHeight();t.setFontSize(8),t.text("SUMMARY REPORT",i/2,20,{align:"center"}),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center"}),t.text(""+e,i-20,30,{align:"right"}),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.line(20,40,i-20,40);let o=1,s=60,l=30,r=i/4,h=10;for(let d=0;d<this.summarydata.length;d++){0==o&&(t.setFontSize(8),t.text("SUMMARY REPORT",i/2,20,{align:"center",renderingMode:"fill"}).setFillColor("#FFFFFF"),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center",renderingMode:"fill"}),t.text(""+e,i-20,30,{align:"right"}),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.line(20,40,i-20,40),s=60,l=30,r=i/4,h=10),h=10,t.setFontSize(8),t.text("ID : "+this.summarydata[d].id,l,s,{align:"left"}),t.text("NAME : "+this.summarydata[d].name,l+100,s,{align:"left"}),t.text("DEPARTMENT : "+this.summarydata[d].dept,l+300,s,{align:"left"}),t.text("DESIGNATION : "+this.summarydata[d].desig,l+500,s,{align:"left"}),t.line(20,s+10,i-20,s+10),t.setFontSize(7),t.text("Date",20,s+20),t.text("Day",20,s+h+25),h+=12,t.text("IN",20,s+h+30),h+=13,t.text("OUT",20,s+h+30),h+=13,t.text("TOTAL",20,s+h+30),h+=17,t.text("STATUS",20,s+h+30),h+=15,t.line(20,s+h+20,i-20,s+h+20),t.setFontSize(8),t.text("FILO Total : "+this.summarydata[d].totalmformonth+"     Present : "+this.summarydata[d].present+"     Absent : "+this.summarydata[d].absent+"     Holidays : "+this.summarydata[d].holiday+"     WeeklyOff : "+this.summarydata[d].weeklyof+"     Leaves : "+this.summarydata[d].leave+"     LWP : "+this.summarydata[d].LWP+"     Tour : "+this.summarydata[d].tour+"     HalfDays : "+this.summarydata[d].halfDay+"     Late : "+this.summarydata[d].late+"     Early : "+this.summarydata[d].early+"     LateDay : "+this.summarydata[d].ltdays+"     Early Days : "+this.summarydata[d].erdays,20,s+115),t.setFontSize(7),t.line(20,s+120,i-20,s+120);let a=60;for(let e=0;e<this.summarydata[d].intime.length&&null!=this.summarydata[d].intime[e];e++)t.text(this.summaryDateArray[e].toString(),a,s+20,{renderingMode:"fill"}),t.text(this.summarydata[d].weekday[e],a,s+35,{renderingMode:"fill"}),t.text(this.summarydata[d].intime[e].substring(0,5),a,s+50),t.text(this.summarydata[d].outtime[e].substring(0,5),a,s+65),t.text(this.summarydata[d].total[e].substring(0,5),a,s+80),t.text(this.summarydata[d].status[e],a,s+95),a+=25;s+=135,o+=1,s+100>n&&(t.addPage("a4","l"),o=0)}t.save("Summary_report-"+a+".pdf")}musterExcelReport(){this.ngxuiloader.start();let t=["CID","ID","NAME","DEPARTMENT","DESIGNATION","DATE"];for(let s=0;s<this.summaryDateArray.length;s++)t[s+6]=this.summaryDateArray[s];let e=["TotalFilo","Present","Absent","Holiday","Weekly Off","Pending Off","Night Off","Valley Off","Half Day","Policy","Leaves","Tour","Late","Early Go","Late Days","EarlyGo Days","LWP","TotalMTA","ParentCID","Parent Name","Location Name","Effective Date","Alphanumeric Id","Leave Late","LWP Late","Grade","SubDepartment"],a=t.length;for(let s of e)t[a]=s,a++;const i=this.common.getLocalStorage().ClientName,n=this.datepipe.transform(new Date,"dd/MM/yyyy");let o=new s.Workbook,d=o.addWorksheet("Muster Report"),r=d.addRow(["Muster Report"]);d.addRow([i]),r.font={name:"Comic Sans MS",family:4,size:16,underline:"double",bold:!0},d.addRow(["Report Generation Date : "+this.datepipe.transform(new Date,"dd MMM yyyy")]);let h="From : "+this.datepipe.transform(this.daterange[0],"dd MMM yyyy"),g="To : "+this.datepipe.transform(this.daterange[1],"dd MMM yyyy");d.addRow([h]),d.addRow([g]),d.addRow([]);let m=d.addRow(t);m.font={size:12,bold:!0},m.eachCell((t,e)=>{t.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"},bgColor:{argb:"FF0000FF"}},t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}});let p=[];p[6]="Day";let u=7;for(let s of this.dayarray)p[u]=s,u++;let c=d.addRow(p);c.font={size:12,bold:!0},c.alignment={vertical:"middle",horizontal:"center"},c.eachCell(t=>{t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),p=[];for(let s=0;s<this.musterData.length;s++){p[1]=Number(this.musterData[s].cid),p[2]=Number(this.musterData[s].id),p[3]=this.musterData[s].name,p[4]=this.musterData[s].dept,p[5]=this.musterData[s].desig,p[6]="Status";let t=7;for(let a of this.musterData[s].status)null!=a&&(p[t]=a,t++);p[t]=this.musterData[s].totalmformonth,t++,p[t]=this.musterData[s].present,t++,p[t]=this.musterData[s].absent,t++,p[t]=this.musterData[s].holiday,t++,p[t]=this.musterData[s].weeklyof,t++,p[t]=this.musterData[s].Pendingoff,t++,p[t]=this.musterData[s].Nightoff,t++,p[t]=this.musterData[s].Valleyoff,t++,p[t]=this.musterData[s].halfDay,t++,p[t]=this.musterData[s].policy,t++,p[t]=this.musterData[s].leave,t++,p[t]=this.musterData[s].tour,t++,p[t]=this.musterData[s].late,t++,p[t]=this.musterData[s].early,t++,p[t]=this.musterData[s].ltdays,t++,p[t]=this.musterData[s].erdays,t++,p[t]=this.musterData[s].LWP,t++,p[t]="",t++,p[t]=null==this.musterData[s].ParentCid?"":this.musterData[s].ParentCid,t++,p[t]=null==this.musterData[s].ParentName?"":this.musterData[s].ParentName,t++,p[t]=null==this.musterData[s].LocationName?"":this.musterData[s].LocationName,t++,p[t]=null==this.musterData[s].EffectiveDate?"":this.musterData[s].EffectiveDate,t++,p[t]=this.musterData[s].alfanumeric,t++,p[t]=this.musterData[s].Leave_Late,t++,p[t]=this.musterData[s].LWP_Late,t++,p[t]=this.musterData[s].Grade,t++,p[t]=this.musterData[s].Subdept,t++;let e=d.addRow(p);e.alignment={vertical:"middle",horizontal:"center"},e.eachCell(t=>{t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}d.getColumn(2).width=15,d.getColumn(3).width=25,d.getColumn(4).width=25,d.getColumn(5).width=25,o.xlsx.writeBuffer().then(t=>{let e=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});l.saveAs(e,"Muster_Report_"+n+".xlsx")}),this.ngxuiloader.stop()}musterPdfReport(){var t=new d.jsPDF("l","pt","a4");const e=this.datepipe.transform(new Date,"d MMM y, h:mm:ss a"),a=this.datepipe.transform(new Date,"dd/MM/yyyy-h:mm:ss a");var i=t.internal.pageSize.width||t.internal.pageSize.getWidth(),n=t.internal.pageSize.height||t.internal.pageSize.getHeight();t.setFontSize(8),t.text("MUSTER REPORT",i/2,20,{align:"center"}),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center"}),t.text(""+e,i-20,30,{align:"right"}),t.setFontSize(8),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.setFontSize(7),t.line(20,40,i-20,40);let o=1,s=60,l=30,r=i/4,h=10;for(let d=0;d<this.musterData.length;d++){0==o&&(t.setFontSize(8),t.text("MUSTER REPORT",i/2,20,{align:"center",renderingMode:"fill"}).setFillColor("#FFFFFF"),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center",renderingMode:"fill"}),t.text(""+e,i-20,30,{align:"right"}),t.setFontSize(8),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.line(20,40,i-20,40),t.setFontSize(7),s=60,l=30,r=i/4,h=10),h=10,t.setFontSize(8),t.text("ID : "+this.musterData[d].id,l,s,{align:"left"}),t.text("NAME : "+this.musterData[d].name,l+100,s,{align:"left"}),t.text("DEPARTMENT : "+this.musterData[d].dept,l+300,s,{align:"left"}),t.text("DESIGNATION : "+this.musterData[d].desig,l+500,s,{align:"left"}),t.line(20,s+10,i-20,s+10),t.setFontSize(6),t.text("Date",20,s+20),t.text("STATUS",20,s+h+30),t.line(20,s+h+45,i-20,s+h+45),t.setFontSize(8),t.text("Present : "+this.musterData[d].present+"     Absent : "+this.musterData[d].absent+"     Holidays : "+this.musterData[d].holiday+"     WeeklyOff : "+this.musterData[d].weeklyof+"     Leaves : "+this.musterData[d].leave+"     LWP : "+this.musterData[d].LWP+"     Tour : "+this.musterData[d].tour+"     HalfDays : "+this.musterData[d].halfDay,20,s+65),t.setFontSize(7),t.line(20,s+70,i-20,s+70);let a=60;for(let e=0;e<this.musterData[d].status.length&&null!=this.musterData[d].status[e];e++)t.text(this.summaryDateArray[e].toString(),a,s+20,{renderingMode:"fill"}),t.text(this.musterData[d].status[e],a,s+40,{maxWidth:20}),a+=25;s+=80,o+=1,s+100>n&&(t.addPage("a4","l"),o=0)}t.save("Muster_report-"+a+".pdf")}generateExcelReport(t,e,a,i){this.ngxuiloader.start();const n=this.common.getLocalStorage().ClientName,o=i,d=this.datepipe.transform(new Date,"dd/MM/yyyy");let r=new s.Workbook,h=r.addWorksheet(e),g=h.addRow([e]);h.addRow([n]),g.font={name:"Comic Sans MS",family:4,size:16,underline:"double",bold:!0},h.addRow(["Report Generation Date : "+this.datepipe.transform(new Date,"dd MMM yyyy")]);let m="From : "+this.datepipe.transform(this.daterange[0],"dd MMM yyyy"),p="To : "+this.datepipe.transform(this.daterange[1],"dd MMM yyyy");h.addRow([m]),h.addRow([p]),h.addRow([]);let u=h.addRow(a);u.font={size:12,bold:!0},u.eachCell((t,e)=>{t.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"},bgColor:{argb:"FF0000FF"}},t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),o.forEach(t=>{let e=h.addRow(t);e.alignment={vertical:"middle",horizontal:"center"},e.eachCell(t=>{t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}),h.getColumn(1).width=15,h.getColumn(2).width=20,h.getColumn(3).width=12,h.getColumn(4).width=13,h.getColumn(5).width=30,h.getColumn(6).width=13,h.getColumn(7).width=13,h.getColumn(8).width=15,h.getColumn(9).width=13,h.getColumn(10).width=15,h.getColumn(11).width=13,h.getColumn(12).width=15,h.getColumn(13).width=15,h.addRow([]);let c=h.addRow(["This is system generated excel sheet."]);c.getCell(1).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFCCFFE5"}},c.getCell(1).border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},h.mergeCells(`A${c.number}:M${c.number}`),r.xlsx.writeBuffer().then(e=>{let a=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});l.saveAs(a,t+"_"+d+".xlsx")}),this.ngxuiloader.stop()}absentExcelReport(){this.ngxuiloader.start();let t=[];for(let s=0;s<this.absentData.length;s++)t.push([Number(this.absentData[s].id),this.absentData[s].Alfanumeric,this.absentData[s].name,this.absentData[s].Dept,this.absentData[s].Desig,this.absentData[s].RealDate,"ABSENT"]);const e=this.common.getLocalStorage().ClientName,a=t,i=this.datepipe.transform(new Date,"dd/MM/yyyy");let n=new s.Workbook,o=n.addWorksheet("Absent Report"),d=o.addRow(["Absent Report"]);o.addRow([e]),d.font={name:"Comic Sans MS",family:4,size:16,underline:"double",bold:!0},o.addRow(["Report Generation Date : "+this.datepipe.transform(new Date,"dd MMM yyyy")]);let r="From : "+this.datepipe.transform(this.daterange[0],"dd MMM yyyy"),h="To : "+this.datepipe.transform(this.daterange[1],"dd MMM yyyy");o.addRow([r]),o.addRow([h]),o.addRow([]);let g=o.addRow(["ID","ALPHA-NUMERIC ID","NAME","DEPARTMENT","DESIGNATION","DATE","STATUS"]);g.font={size:12,bold:!0},g.eachCell((t,e)=>{t.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"},bgColor:{argb:"FF0000FF"}},t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),a.forEach(t=>{let e=o.addRow(t);e.alignment={vertical:"middle"},e.eachCell(t=>{t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}),o.getColumn(1).width=20,o.getColumn(2).width=20,o.getColumn(3).width=25,o.getColumn(4).width=25,o.getColumn(5).width=25,n.xlsx.writeBuffer().then(t=>{let e=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});l.saveAs(e,"Absent_Report_"+i+".xlsx")}),this.ngxuiloader.stop()}absentPdfReport(){this.ngxuiloader.start();var t=new d.jsPDF("p","pt","a4");let e=[];for(let s=0;s<this.absentData.length;s++)e.push([Number(this.absentData[s].id),this.absentData[s].Alfanumeric,this.absentData[s].name,this.absentData[s].Dept,this.absentData[s].Desig,this.absentData[s].RealDate,"ABSENT"]);const a=this.datepipe.transform(new Date,"d MMM y, h:mm:ss a"),i=this.datepipe.transform(new Date,"dd/MM/yyyy-h:mm:ss a");var n=t.internal.pageSize.width||t.internal.pageSize.getWidth();t.internal.pageSize.height||t.internal.pageSize.getHeight(),t.setFontSize(8),t.text("ABSENT REPORT",n/2,20,{align:"center"}),t.text(this.common.getLocalStorage().ClientName,n/2,30,{align:"center"}),t.text(""+a,n-20,30,{align:"right"}),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.line(20,40,n-20,40);const o=e;h()(t,{startY:70,styles:{cellPadding:5,fontSize:8,valign:"middle",halign:"center"},theme:"striped",head:[["ID","ALPHA-NUMERIC ID","NAME","DEPARTMENT","DESIGNATION","DATE","STATUS"]],body:o,margin:{top:20},headStyles:{fillColor:[255,178,155],textColor:[0,0,0],fontSize:8,cellPadding:2}}),t.save("Absent_report-"+i+".pdf"),this.ngxuiloader.stop()}mobileAttendancePDFReport(){var t=new d.jsPDF("l","pt","a4");const e=this.datepipe.transform(new Date,"d MMM y, h:mm:ss a"),a=this.datepipe.transform(new Date,"dd/MM/yyyy-h:mm:ss a");var i=t.internal.pageSize.width||t.internal.pageSize.getWidth(),n=t.internal.pageSize.height||t.internal.pageSize.getHeight();t.setFontSize(8),t.text("Mobile Attendance Report",i/2,20,{align:"center"}),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center"}),t.text(""+e,i-20,30,{align:"right"}),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.line(20,40,i-20,40);let o=["InPunchDate","InPunchTime","OutPunchDate","OutPunchTime","Total","Entered From","Out From"],s=20;t.setFontSize(8);for(let d of o)"Entered From"==d||"Out From"==d?(t.text(d,s,60,{maxWidth:250}),s+=260):(t.text(d,s,60,{maxWidth:60}),s+=70);t.line(20,70,i-20,70),t.setFontSize(8);let l=1,r=100;s=30;let h=i/4,g=10;for(let d=0;d<this.mobileData.length;d++){if(0==l){s=20,t.setFontSize(8);for(let e of o)"Entered From"==e||"Out From"==e?(t.text(e,s,60,{maxWidth:250}),s+=260):(t.text(e,s,60,{maxWidth:60}),s+=70);t.line(20,70,i-20,70),t.setFontSize(8),t.text("Mobile Attendance Report",i/2,20,{align:"center",renderingMode:"fill"}).setFillColor("#FFFFFF"),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center",renderingMode:"fill"}),t.text(""+e,i-20,30,{align:"right"}),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.line(20,40,i-20,40),r=100,s=30,h=i/4,g=10}g=10,t.setFontSize(8),t.text("ID : "+this.mobileData[d].Id,s,r,{align:"left"}),t.text("NAME : "+this.mobileData[d].Name,s+100,r,{align:"left"}),t.text("DEPARTMENT : "+this.mobileData[d].Department,s+300,r,{align:"left"}),t.setFontSize(7),t.line(20,r+10,i-20,r+10);let a=20;r+=20;for(let l=0;l<this.mobileData[d].MA.length;l++)if(t.text(this.mobileData[d].MA[l].InPunchDate,a,r,{renderingMode:"fill"}),t.text(this.mobileData[d].MA[l].InPunchTime,a+70,r,{renderingMode:"fill"}),t.text(this.mobileData[d].MA[l].OutPunchDate,a+140,r),t.text(this.mobileData[d].MA[l].OutPunchTime,a+210,r),t.text(this.mobileData[d].MA[l].Total,a+280,r),"#"==this.mobileData[d].MA[l].InPremises?(t.setTextColor(255,0,0),t.text(this.mobileData[d].MA[l].InPremises,a+350,r,{maxWidth:230}),t.setTextColor(0,0,0)):t.text(this.mobileData[d].MA[l].InEnteredFrom,a+350,r,{maxWidth:230}),"#"==this.mobileData[d].MA[l].OutPremises?(t.setTextColor(255,0,0),t.text(this.mobileData[d].MA[l].OutPremises,a+590,r,{maxWidth:225}),t.setTextColor(0,0,0)):t.text(this.mobileData[d].MA[l].OutEnteredFrom,a+590,r,{maxWidth:225}),r+=30,r+30>n){t.addPage("a4","l"),s=20,t.setFontSize(8);for(let e of o)"Entered From"==e||"Out From"==e?(t.text(e,s,60,{maxWidth:250}),s+=260):(t.text(e,s,60,{maxWidth:60}),s+=70);t.line(20,70,i-20,70),t.setFontSize(8),t.text("Mobile Attendance Report ",i/2,20,{align:"center",renderingMode:"fill"}).setFillColor("#FFFFFF"),t.text(this.common.getLocalStorage().ClientName,i/2,30,{align:"center",renderingMode:"fill"}),t.text(""+e,i-20,30,{align:"right"}),t.text("FromDate : "+this.fromdatedisplay+"     ToDate : "+this.todatedisplay,20,30,{align:"left"}),t.line(20,40,i-20,40),r=100,s=30,h=i/4,g=10}t.line(20,r,i-20,r),r+=30,l+=1,r+100>n&&(t.addPage("a4","l"),l=0)}t.save("Mobile_Attendance_Report-"+a+".pdf")}mobileAttendanceExcelReport(){this.ngxuiloader.start();const t=this.common.getLocalStorage().ClientName,e=this.datepipe.transform(new Date,"dd/MM/yyyy");let a=new s.Workbook,i=a.addWorksheet("Mobile Attendance Report"),n=i.addRow(["Mobile Attendance Report"]);i.addRow([t]),n.font={name:"Comic Sans MS",family:4,size:16,underline:"double",bold:!0},i.addRow(["Report Generation Date : "+this.datepipe.transform(new Date,"dd MMM yyyy")]);let o="From : "+this.datepipe.transform(this.daterange[0],"dd MMM yyyy"),d="To : "+this.datepipe.transform(this.daterange[1],"dd MMM yyyy");i.addRow([o]),i.addRow([d]),i.addRow([]);let r=i.addRow(["ID","NAME","DEPARTMENT","ALPHANUMERIC","INPUNCH DATE","INPUNCH TIME","OUTPUNCH DATE","OUTPUNCH TIME","TOTAL","ENTERED FROM","OUT FROM","INPREMISES","OUTPREMISES"]);r.font={size:12,bold:!0},r.eachCell((t,e)=>{t.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"},bgColor:{argb:"FF0000FF"}},t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}});let h=[];for(let s=0;s<this.mobileData.length;s++){h=[],h[1]=Number(this.mobileData[s].Id),h[2]=this.mobileData[s].Name,h[3]=this.mobileData[s].Department,h[4]=this.mobileData[s].AlfaNumeric;let t=5;for(let e of this.mobileData[s].MA){t=5,h[t]=e.InPunchDate,t++,h[t]=e.InPunchTime,t++,h[t]=e.OutPunchDate,t++,h[t]=e.OutPunchTime,t++,h[t]=e.Total,t++,h[t]=e.InEnteredFrom,t++,h[t]=e.OutEnteredFrom,t++,h[t]=e.InPremises,t++,h[t]=e.OutPremises,t++;let a=i.addRow(h);a.alignment={vertical:"middle",horizontal:"center"},a.eachCell(t=>{t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}}i.getColumn(1).width=15,i.getColumn(2).width=20,i.getColumn(3).width=25,i.getColumn(4).width=15,i.getColumn(5).width=12,i.getColumn(6).width=12,i.getColumn(7).width=12,i.getColumn(8).width=12,i.getColumn(9).width=12,i.getColumn(10).width=30,i.getColumn(11).width=30,i.getColumn(10).alignment={vertical:"middle",horizontal:"center",wrapText:!0},i.getColumn(11).alignment={vertical:"middle",horizontal:"center",wrapText:!0},a.xlsx.writeBuffer().then(t=>{let a=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});l.saveAs(a,"Mobile Attendance Report_"+e+".xlsx")}),this.ngxuiloader.stop()}generatePDF(){}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(m.F),g.Y36(p.v),g.Y36(u._W),g.Y36(n.uU),g.Y36(c.LA))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-report"]],viewQuery:function(t,e){if(1&t&&g.Gf(b,5),2&t){let t;g.iGM(t=g.CRH())&&(e.empsearch=t.first)}},decls:38,vars:9,consts:[[1,"py-2","container-flex"],[1,"row"],[1,"col-sm-6",2,"border-right","1px solid"],[1,"row","mb-3"],["for","input1",1,"col-sm-4","col-form-label",2,"font-weight","bold"],[2,"color","red"],[1,"col-sm-8"],["name","selectedReports",1,"browser-default","custom-select",3,"ngModel","ngModelChange","change"],["selected","",3,"value"],[3,"value",4,"ngFor","ngForOf"],["class","text-danger","style","color: red;",4,"ngIf"],["for","input2",1,"col-sm-4","col-form-label",2,"font-weight","bold"],["type","text","name","daterange","placeholder","Select Date Range","autocomplete","off","bsDaterangepicker","","inputmode","none",1,"p-3","form-control",3,"ngModel","maxDate","bsConfig","ngModelChange","bsValueChange"],[1,"col-sm-12","d-flex","justify-content-center"],["appHeading","","mdbBtn","","type","button","size","md","mdbWavesEffect","",1,"buttonhover",3,"click"],[1,"col-sm-6"],["component1",""],[1,"col-sm-2","col-form-label"],["class","container-flex p-2",4,"ngIf"],[3,"value"],[1,"text-danger",2,"color","red"],[1,"container-flex","p-2"],[1,"col-sm-3"],[1,"col-sm-3",2,"margin-top","-5px"],["appHeading","","mdbBtn","","type","button","size","sm","mdbWavesEffect","",1,"buttonhover",3,"click"],[1,"fas","fa-download",2,"font-size","20px"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngFor","ngForOf"],["showFirstLastButtons","",3,"length","pageSize","pageSizeOptions","page"],[1,"newemp"],[1,"card-group"],["class","p-1",4,"ngFor","ngForOf"],[1,"p-1"],["placement","top","style","background-color: rgb(197, 226, 243);",3,"mdbTooltip",4,"ngIf","ngIfElse"],["elseBlock",""],["placement","top",2,"background-color","rgb(197, 226, 243)",3,"mdbTooltip"],[2,"width","125px","height","150px"],["mdbTooltip","Date","placement","top"],["mdbTooltip","In Time","placement","right"],["mdbTooltip","Out Time","placement","right"],["mdbTooltip","Total Hours Worked","placement","right"],["mdbTooltip","Status","placement","right"],[4,"ngSwitchDefault"],["pill","true","color","red"],["pill","true","color","green"],["pill","true","color","orange"],["pill","true","color","yellow"],["pill","true","color","blue"],["placement","top",3,"mdbTooltip"],[1,"row","p-4","badges",2,"background-color","rgb(235, 227, 241)"],[1,"col"],["value","FT","severity","success","mdbTooltip","FILO Total","placement","top"],["value","P","severity","success","mdbTooltip","Present","placement","top"],["value","A","severity","danger","mdbTooltip","Absent","placement","top"],["value","H","severity","info","mdbTooltip","Holidays","placement","top"],["value","W","severity","warning","mdbTooltip","Weekly Off","placement","top"],["value","PO","severity","info","mdbTooltip","Pending Off","placement","top"],["value","NO","severity","success","mdbTooltip","Night Off","placement","top"],["value","VO","severity","warning","mdbTooltip","Valley Off","placement","top"],["value","L","severity","success","mdbTooltip","Leaves","placement","top"],["value","LWP","severity","info","mdbTooltip","Leave Without Pay","placement","top"],["value","T","severity","warning","mdbTooltip","Tour","placement","top"],["value","HD","severity","success","mdbTooltip","HalfDays","placement","top"],["value","LT","severity","info","mdbTooltip","Late","placement","top"],["value","ER","severity","warning","mdbTooltip","Early","placement","top"],["value","LTD","severity","info","mdbTooltip","LateDays","placement","top"],["value","ERD","severity","warning","mdbTooltip","EarlyDays","placement","top"],[1,"row","p-2","badges",2,"background-color","rgb(235, 227, 241)"],["style","background-color: rgb(197, 226, 243);",4,"ngIf","ngIfElse"],[2,"background-color","rgb(197, 226, 243)"],[1,"table-responsive"],[1,"table","table-sm","table-hover","aqua-gradient"],["class","text-white",4,"ngFor","ngForOf"],[1,"text-white"],["placement","top",2,"width","125px","height","165px",3,"mdbTooltip"],["mdbTooltip","Base Hour","placement","right"],["mdbTooltip","OT","placement","right"],[1,"table"],[1,"table-responsive","table-hover","table-bordered","table-striped"],["class","p-3",4,"ngIf"],[4,"ngIf"],[1,"p-3"]],template:function(t,e){1&t&&(g.TgZ(0,"div",0),g.TgZ(1,"div",1),g.TgZ(2,"div",2),g.TgZ(3,"form"),g.TgZ(4,"div",3),g.TgZ(5,"label",4),g._uU(6,"Reports "),g.TgZ(7,"sup",5),g._uU(8,"*"),g.qZA(),g.qZA(),g.TgZ(9,"div",6),g.TgZ(10,"select",7),g.NdJ("ngModelChange",function(t){return e.selectedReports=t})("change",function(){return e.getSelectedReportName()}),g.TgZ(11,"option",8),g._uU(12,"--Select Report Type--"),g.qZA(),g.YNc(13,q,2,2,"option",9),g.qZA(),g.YNc(14,w,2,0,"small",10),g.qZA(),g.qZA(),g.TgZ(15,"div",3),g.TgZ(16,"label",11),g._uU(17,"Select Date Range"),g.TgZ(18,"sup",5),g._uU(19,"*"),g.qZA(),g.qZA(),g.TgZ(20,"div",6),g.TgZ(21,"input",12),g.NdJ("ngModelChange",function(t){return e.daterange=t})("bsValueChange",function(t){return e.onValueChange(t)}),g.qZA(),g.YNc(22,v,2,0,"small",10),g.qZA(),g.qZA(),g.TgZ(23,"div",13),g.TgZ(24,"button",14),g.NdJ("click",function(){return e.showReport()}),g._uU(25,"Show"),g.qZA(),g._uU(26,"\xa0 "),g.TgZ(27,"button",14),g.NdJ("click",function(){return e.resetValue()}),g._uU(28,"Reset"),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(29,"div",15),g.TgZ(30,"app-employeesearch",null,16),g._uU(32,"Loading..."),g.qZA(),g.qZA(),g.qZA(),g.TgZ(33,"label",17),g.TgZ(34,"sup",5),g._uU(35,"*"),g.qZA(),g._uU(36," Mandatory field"),g.qZA(),g.YNc(37,ae,31,11,"div",18),g.qZA()),2&t&&(g.xp6(10),g.Q6J("ngModel",e.selectedReports),g.xp6(1),g.Q6J("value","-1"),g.xp6(2),g.Q6J("ngForOf",e.reports_list),g.xp6(1),g.Q6J("ngIf",e.reporterror),g.xp6(7),g.Q6J("ngModel",e.daterange)("maxDate",e.maxDateValue)("bsConfig",e.daterangeConfig),g.xp6(1),g.Q6J("ngIf",e.dateerror),g.xp6(15),g.Q6J("ngIf",e.showtable))},directives:[T._Y,T.JL,T.F,T.EJ,T.JJ,T.On,T.YN,T.Kr,n.sg,n.O5,Z.TB,T.Fj,Z.FR,f.d,y.mT,y.b6,A.r,n.RF,n.n9,D.NW,y.n3,y.i9,y.KS,y.gR,y.kp,n.ED,y.NS,x.Ct],styles:["label[_ngcontent-%COMP%], td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{font-size:small}form[_ngcontent-%COMP%]{padding-left:20px}"]}),t})();var ne=a(68003);const oe=[{path:"",component:ie}];let se=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=g.oAB({type:t}),t.\u0275inj=g.cJS({imports:[[ne.Bz.forChild(oe)],ne.Bz]}),t})();var le=a(37160),de=a(97368),re=a(7436),he=a(42693),ge=a(91709),me=a(52309),pe=a(92871),ue=a(37320);const ce={bgsColor:"blue",bgsType:c.aS.rectangleBouncePulseOut};let Te=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=g.oAB({type:t}),t.\u0275inj=g.cJS({imports:[[n.ez,se,y.yi.forRoot(),T.u5,T.UX,c.Js.forRoot(ce),c.Cz.forRoot({showForeground:!0}),he.JF,le.o,ge._8,me.N6,re.Fk,pe.nD,x.TX,Z.kn.forRoot(),de.q4,D.TU,ue.A0,i.G]]}),t})()}}]);