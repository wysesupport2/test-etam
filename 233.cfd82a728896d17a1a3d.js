(self.webpackChunketam_prime=self.webpackChunketam_prime||[]).push([[233],{54233:(e,t,o)=>{"use strict";o.r(t),o.d(t,{EnrollmentModule:()=>$});var n=o(37160),l=o(52309),i=o(31041),a=o(2619),s=o(61116),r=o(16304),d=o(81888),c=o(62707),g=o(82051),m=o(23651),p=o(52279),h=o.n(p),u=o(35366),y=o(42693),f=o(9017),E=o(53887);let b=(()=>{class e{constructor(e,t){this.common=e,this.http=t,this.URL=E.T7+"Employees/"}getFingerPrintEnrolledList(){let e=this.URL+"Get_Enroll_User?CID="+this.common.getCid();return this.http.get(e)}getTobeFingerPrintEnrolledList(){let e=this.URL+"Get_User_To_Be_Enroll?CID="+this.common.getCid();return this.http.get(e)}getFaceEnrolledList(){let e=this.URL+"Get_Face_Enroll?CID="+this.common.getCid();return this.http.get(e)}getToBeFaceEnrolledList(){let e=this.URL+"Get_Face_To_Be_Enroll?CID="+this.common.getCid();return this.http.get(e)}getEmployeeImage(e){return this.http.get(this.URL+"Get_Employee_Face?EmpId="+e)}getAllEmployeeImage(){let e=this.URL+"Get_All_Employees_Face_Images?CID="+this.common.getCid();return this.http.get(e)}}return e.\u0275fac=function(t){return new(t||e)(u.LFG(f.v),u.LFG(y.eN))},e.\u0275prov=u.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var w=o(3492),Z=o(50236),F=o(92290),v=o(14867),C=o(37456),A=o(58150);function T(e,t){if(1&e&&(u.TgZ(0,"div"),u.TgZ(1,"div"),u._uU(2),u.qZA(),u.qZA()),2&e){const e=t.$implicit;u.xp6(2),u.AsE("",e.EmployeeId," - ",e.EmployeeName,"")}}function x(e,t){1&e&&(u.TgZ(0,"small",36),u._uU(1,"Please select Employee ID "),u.qZA())}function I(e,t){1&e&&(u.TgZ(0,"td"),u._UZ(1,"i",37),u.qZA())}function D(e,t){1&e&&(u.TgZ(0,"td"),u._UZ(1,"i",38),u.qZA())}function S(e,t){1&e&&(u.TgZ(0,"td"),u._uU(1,"Enrollment service is not running/stop/not installed on PC"),u.qZA())}function U(e,t){1&e&&(u.TgZ(0,"td"),u._uU(1,"Enrollment service is running on PC"),u.qZA())}function N(e,t){1&e&&(u.TgZ(0,"td"),u._UZ(1,"i",37),u.qZA())}function L(e,t){1&e&&(u.TgZ(0,"td"),u._UZ(1,"i",38),u.qZA())}function q(e,t){1&e&&(u.TgZ(0,"td"),u._uU(1,"Enrollment Device is not connected or driver not install on PC"),u.qZA())}function _(e,t){1&e&&(u.TgZ(0,"td"),u._uU(1,"Enrollment Device is connected"),u.qZA())}function R(e,t){if(1&e&&(u.TgZ(0,"div",39),u._UZ(1,"img",40),u.qZA()),2&e){const e=u.oxw();u.xp6(1),u.s9C("src","data:image/jpeg;base64,"+e.empImage,u.LSH)}}function M(e,t){if(1&e&&(u.TgZ(0,"tr"),u.TgZ(1,"td"),u._uU(2),u.qZA(),u.TgZ(3,"td"),u._uU(4),u.qZA(),u.TgZ(5,"td",53),u._UZ(6,"img",54),u.qZA(),u.TgZ(7,"td"),u._uU(8),u.qZA(),u.TgZ(9,"td"),u._uU(10),u.qZA(),u.qZA()),2&e){const e=t.$implicit;u.xp6(2),u.hij(" ",e.EmpId," "),u.xp6(2),u.hij(" ",e.Name," "),u.xp6(2),u.s9C("src","data:image/jpg;base64,"+e.FaceImage,u.LSH),u.xp6(2),u.hij(" ",e.ResignStatus," "),u.xp6(2),u.Oqu(e.Status)}}function k(e,t){1&e&&(u.TgZ(0,"div",55),u._uU(1,"Data not found"),u.qZA())}const z=function(){return[5,10]};function B(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"div",41),u.TgZ(1,"div",42),u.TgZ(2,"div",43),u.TgZ(3,"h5",44),u._uU(4,"All Employees Face Images"),u.qZA(),u.TgZ(5,"div",45,46),u.TgZ(7,"table",47),u.TgZ(8,"thead"),u.TgZ(9,"tr"),u.TgZ(10,"th",48),u._uU(11,"Employee Id"),u.qZA(),u.TgZ(12,"th",48),u._uU(13,"Employee Name"),u.qZA(),u.TgZ(14,"th",48),u._uU(15,"Image"),u.qZA(),u.TgZ(16,"th",48),u._uU(17,"Resign Status"),u.qZA(),u.TgZ(18,"th",48),u._uU(19,"Status "),u.qZA(),u.qZA(),u.qZA(),u.TgZ(20,"tbody"),u.YNc(21,M,11,5,"tr",49),u.qZA(),u.qZA(),u.YNc(22,k,2,0,"div",50),u.TgZ(23,"mat-paginator",51),u.NdJ("page",function(t){return u.CHM(e),u.oxw().OnPageChange(t)}),u.qZA(),u.qZA(),u.TgZ(24,"button",52),u.NdJ("click",function(){return u.CHM(e),u.oxw().downloadAllImagePDF()}),u._uU(25,"Download PDF"),u.qZA(),u.TgZ(26,"button",52),u.NdJ("click",function(){return u.CHM(e),u.oxw().downloadAllImageExcel()}),u._uU(27,"Download Excel"),u.qZA(),u.qZA(),u.qZA(),u.qZA()}if(2&e){const e=u.oxw();u.xp6(21),u.Q6J("ngForOf",e.pageSlice),u.xp6(1),u.Q6J("ngIf",0==e.allEmployeesFaceData.length),u.xp6(1),u.Q6J("length",e.allEmployeesFaceData.length)("pageSize",5)("pageSizeOptions",u.DdM(5,z))}}let J=(()=>{class e{constructor(e,t,o,n,l,i){this.http=e,this.common=t,this.enrollment=o,this.datepipe=n,this.toast=l,this.ngxuiloader=i,this.empid=[],this.isServiceConnected=!1,this.isServiceNotConnected=!0,this.isDeviceConnected=!1,this.isDeviceNotConnected=!0,this.employees=[],this.spinner=d.aS,this.filteredEmployees=[],this.showImage=!1,this.allEmployeesFaceData=[],this.items=[],this.activeItem={},this.showImageTable=!1,this.contents=["Fingerprint Enrollment","Face Enrollment","Downloads"]}ngOnInit(){this.displayContent("Fingerprint Enrollment"),this.getEmpList(),this.checkServices(),this.items=[{label:"FingerPrint Enrollment"},{label:"Face Enrollment"},{label:"Download Drivers"}],this.activeItem=this.items[0]}getEmployeeDetails(){}checkServices(){var e=this;this.http.post("http://localhost:7999/values/checkservice","").subscribe(function(){var t=(0,r.Z)(function*(t){"true"==(yield t).errorstring?(e.isServiceConnected=!0,e.isServiceNotConnected=!1):(e.isServiceConnected=!1,e.isServiceNotConnected=!0)});return function(e){return t.apply(this,arguments)}}(),e=>{let t={Exception:e.message,id:this.common.getLocalStorage().LoginId,Api:"Check Enroll Service"};this.common.saveLog(t,"ApiException")}),this.http.post("http://localhost:7999/values/checkdevice","").subscribe(function(){var t=(0,r.Z)(function*(t){"true"==(yield t).errorstring?(e.isDeviceConnected=!0,e.isDeviceNotConnected=!1):(e.isDeviceNotConnected=!0,e.isDeviceConnected=!1)});return function(e){return t.apply(this,arguments)}}(),e=>{let t={Exception:e.message,id:this.common.getLocalStorage().LoginId,Api:"Check Enroll Device"};this.common.saveLog(t,"ApiException")})}getFingerEnrolled(){var e=this;null!=this.empid&&null!=this.empid&&0!=this.empid.length&&""!=this.empid&&this.empid!={}?this.isServiceNotConnected?this.toast.warning("Enrollment service is not running/stop/not installed on PC"):this.isDeviceNotConnected?this.toast.warning("Enrollment Device is not connected or driver not install on PC"):(this.ngxuiloader.startLoader("loader-01"),this.http.post("http://localhost:7999/values/Enroll?empid="+this.empid.EmployeeId,"").subscribe(function(){var t=(0,r.Z)(function*(t){let o=yield t;e.ngxuiloader.stopLoader("loader-01"),"Enrollmet success"==o.errorstring?(e.toast.success("Enrollment success",e.empid.EmployeeId+" - "+e.empid.EmployeeName),e.common.insertLog("Enrollment/Enroll-"+e.empid.EmployeeId)):e.toast.error("Enrollment Failure",e.empid.EmployeeId+" - "+e.empid.EmployeeName)});return function(e){return t.apply(this,arguments)}}(),e=>{let t={Exception:e.message,id:this.common.getLocalStorage().LoginId,Api:"Enroll Finger"};this.common.saveLog(t,"ApiException")})):this.toast.warning("Please select employee!!!")}verifyFingerEnrolled(){var e=this;null!=this.empid&&null!=this.empid&&0!=this.empid.length?(this.ngxuiloader.startLoader("loader-01"),this.http.get("http://localhost:7999/values/GetString?empid="+this.empid.EmployeeId).subscribe(function(){var t=(0,r.Z)(function*(t){let o=yield t;e.ngxuiloader.stopLoader("loader-01"),o.errorstring.includes("Suceess in Verification")?e.toast.success("Verification success",e.empid.EmployeeId+" - "+e.empid.EmployeeName):e.toast.error("Verification Failure",e.empid.EmployeeId+" - "+e.empid.EmployeeName)});return function(e){return t.apply(this,arguments)}}(),e=>{let t={Exception:e.message,id:this.common.getLocalStorage().LoginId,Api:"Verify Finger Enrolled"};this.common.saveLog(t,"ApiException")}),this.common.insertLog("Enrollment/VerifyEnroll-"+this.empid.EmployeeId)):this.toast.warning("Please select employee!!!")}displayContent(e){var t=document.getElementById(e);t&&(this.contents.map(t=>{if(t!=e){var o=document.getElementById(t);o&&(o.style.display="none")}}),t.style.display="block")}getEmpList(){var e=this;this.ngxuiloader.start(),this.common.getEmpList().subscribe(function(){var t=(0,r.Z)(function*(t){e.employees=yield t,e.ngxuiloader.stop(),e.employees=null!=e.employees.data&&0!=e.employees.data.length?e.employees.data:[]});return function(e){return t.apply(this,arguments)}}())}filterEmployees(e){let t=[],o=e.query;for(let n=0;n<this.employees.length;n++){let e=this.employees[n];(0==e.EmployeeName.toLowerCase().indexOf(o.toLowerCase())||e.EmployeeId.includes(o))&&t.push(e)}this.filteredEmployees=t}getFingerPrintEnrolledUserList(){var e=this;this.ngxuiloader.start(),this.enrollment.getFingerPrintEnrolledList().subscribe(function(){var t=(0,r.Z)(function*(t){let o=yield t;if(1==o.errorcode)if(null!=o.data)if(0!=o.data.length){let t=[];o=o.data;for(let e=0;e<o.length;e++)t.push([Number(o[e].EmployeeId),o[e].EmployeeName,o[e].Department]);const n="Fingerprint Enrolled User Report",l=e.common.getLocalStorage().ClientName,i=["ID","NAME","DEPARTMENT"],a=t,s=e.datepipe.transform(new Date,"dd/MM/yyyy");let r=new c.Workbook,d=r.addWorksheet("Enrolled User"),m=d.addRow([n]);d.addRow([l]),m.font={name:"Comic Sans MS",family:4,size:16,underline:"double",bold:!0},d.addRow([]),d.addRow(["Date : "+e.datepipe.transform(new Date,"dd MMM yyyy")]),d.addRow([]);let p=d.addRow(i);p.font={size:12,bold:!0},p.eachCell((e,t)=>{e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"},bgColor:{argb:"FF0000FF"}},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),a.forEach(e=>{let t=d.addRow(e);t.alignment={vertical:"middle",horizontal:"center"},t.eachCell(e=>{e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}),d.getColumn(1).width=20,d.getColumn(2).width=20,d.getColumn(3).width=20,d.addRow([]);let h=d.addRow(["This is system generated excel sheet."]);h.getCell(1).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFCCFFE5"}},h.getCell(1).border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},d.mergeCells(`A${h.number}:D${h.number}`),r.xlsx.writeBuffer().then(e=>{let t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});g.saveAs(t,"FingerPrintEnrolledUserList-"+s+".xlsx")})}else e.toast.warning("There is no data to Download");else e.toast.warning("There is no data to Download");else e.toast.warning("There is no data to Download");e.ngxuiloader.stop()});return function(e){return t.apply(this,arguments)}}(),e=>{let t={Exception:e.message,id:this.common.getLocalStorage().LoginId,Api:"Finger Enrolled List"};this.common.saveLog(t,"ApiException")})}getFingerPrintToBeEnrolledUserList(){var e=this;this.ngxuiloader.start(),this.enrollment.getTobeFingerPrintEnrolledList().subscribe(function(){var t=(0,r.Z)(function*(t){let o=yield t;if(1==o.errorcode)if(null!=o.data)if(0!=o.data.length){let t=[];o=o.data;for(let e=0;e<o.length;e++)t.push([Number(o[e].EmployeeId),o[e].EmployeeName,o[e].Department]);const n="Fingerprint To Be Enrolled User Report",l=e.common.getLocalStorage().ClientName,i=["ID","NAME","DEPARTMENT"],a=t,s=e.datepipe.transform(new Date,"dd/MM/yyyy");let r=new c.Workbook,d=r.addWorksheet("To Be Enrolled User"),m=d.addRow([n]);d.addRow([l]),m.font={name:"Comic Sans MS",family:4,size:16,underline:"double",bold:!0},d.addRow([]),d.addRow(["Date : "+e.datepipe.transform(new Date,"dd MMM yyyy")]),d.addRow([]);let p=d.addRow(i);p.font={size:12,bold:!0},p.eachCell((e,t)=>{e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"},bgColor:{argb:"FF0000FF"}},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),a.forEach(e=>{let t=d.addRow(e);t.alignment={vertical:"middle",horizontal:"center"},t.eachCell(e=>{e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}),d.getColumn(1).width=20,d.getColumn(2).width=20,d.getColumn(3).width=20,d.addRow([]);let h=d.addRow(["This is system generated excel sheet."]);h.getCell(1).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFCCFFE5"}},h.getCell(1).border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},d.mergeCells(`A${h.number}:C${h.number}`),r.xlsx.writeBuffer().then(e=>{let t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});g.saveAs(t,"FingerPrintToBeEnrolledUserList-"+s+".xlsx")})}else e.toast.warning("There is no data to Download");else e.toast.warning("There is no data to Download");else e.toast.warning("There is no data to Download");e.ngxuiloader.stop()});return function(e){return t.apply(this,arguments)}}(),e=>{let t={Exception:e.message,id:this.common.getLocalStorage().LoginId,Api:"Deputed In/Out Locations"};this.common.saveLog(t,"ApiException")})}getFaceEnrolledUserList(){var e=this;this.ngxuiloader.start(),this.enrollment.getFaceEnrolledList().subscribe(function(){var t=(0,r.Z)(function*(t){let o=yield t;if(1==o.errorcode)if(null!=o.data)if(0!=o.data.length){let t=[];o=o.data;for(let e=0;e<o.length;e++)t.push([Number(o[e].EmployeeId),o[e].EmployeeName,o[e].Department]);const n="Face Enrolled User Report",l=e.common.getLocalStorage().ClientName,i=["ID","NAME","DEPARTMENT"],a=t,s=e.datepipe.transform(new Date,"dd/MM/yyyy");let r=new c.Workbook,d=r.addWorksheet("Face Enrolled User"),m=d.addRow([n]);d.addRow([l]),m.font={name:"Comic Sans MS",family:4,size:16,underline:"double",bold:!0},d.addRow([]),d.addRow(["Date : "+e.datepipe.transform(new Date,"dd MMM yyyy")]),d.addRow([]);let p=d.addRow(i);p.font={size:12,bold:!0},p.eachCell((e,t)=>{e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"},bgColor:{argb:"FF0000FF"}},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),a.forEach(e=>{let t=d.addRow(e);t.alignment={vertical:"middle",horizontal:"center"},t.eachCell(e=>{e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}),d.getColumn(1).width=20,d.getColumn(2).width=20,d.getColumn(3).width=20,d.addRow([]);let h=d.addRow(["This is system generated excel sheet."]);h.getCell(1).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFCCFFE5"}},h.getCell(1).border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},d.mergeCells(`A${h.number}:C${h.number}`),r.xlsx.writeBuffer().then(e=>{let t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});g.saveAs(t,"FaceEnrolledUserList-"+s+".xlsx")})}else e.toast.warning("There is no data to Download");else e.toast.warning("There is no data to Download");else e.toast.warning("There is no data to Download");e.ngxuiloader.stop()});return function(e){return t.apply(this,arguments)}}(),e=>{let t={Exception:e.message,id:this.common.getLocalStorage().LoginId,Api:"Face Enroll List"};this.common.saveLog(t,"ApiException")})}getFaceToBeEnrolledUserList(){var e=this;this.ngxuiloader.start(),this.enrollment.getToBeFaceEnrolledList().subscribe(function(){var t=(0,r.Z)(function*(t){let o=yield t;if(1==o.errorcode)if(null!=o.data)if(0!=o.data.length){let t=[];o=o.data;for(let e=0;e<o.length;e++)t.push([Number(o[e].EmployeeId),o[e].EmployeeName,o[e].Department]);const n="Face To Be Enrolled User Report",l=e.common.getLocalStorage().ClientName,i=["ID","NAME","DEPARTMENT"],a=t,s=e.datepipe.transform(new Date,"dd/MM/yyyy");let r=new c.Workbook,d=r.addWorksheet("To Be Enrolled User"),m=d.addRow([n]);d.addRow([l]),m.font={name:"Comic Sans MS",family:4,size:16,underline:"double",bold:!0},d.addRow([]),d.addRow(["Date : "+e.datepipe.transform(new Date,"dd MMM yyyy")]),d.addRow([]);let p=d.addRow(i);p.font={size:12,bold:!0},p.eachCell((e,t)=>{e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"},bgColor:{argb:"FF0000FF"}},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),a.forEach(e=>{let t=d.addRow(e);t.alignment={vertical:"middle",horizontal:"center"},t.eachCell(e=>{e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}),d.getColumn(1).width=20,d.getColumn(2).width=20,d.getColumn(3).width=20,d.addRow([]);let h=d.addRow(["This is system generated excel sheet."]);h.getCell(1).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFCCFFE5"}},h.getCell(1).border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},d.mergeCells(`A${h.number}:C${h.number}`),r.xlsx.writeBuffer().then(e=>{let t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});g.saveAs(t,"FaceToBeEnrolledUserList-"+s+".xlsx")})}else e.toast.warning("There is no data to Download");else e.toast.warning("There is no data to Download");else e.toast.warning("There is no data to Download");e.ngxuiloader.stop()});return function(e){return t.apply(this,arguments)}}(),e=>{let t={Exception:e.message,id:this.common.getLocalStorage().LoginId,Api:"To be face enroll list"};this.common.saveLog(t,"ApiException")})}showSingleEmployeeImageData(){var e=this;null!=this.empid&&null!=this.empid&&0!=this.empid.length?this.enrollment.getEmployeeImage(this.empid.EmployeeId).subscribe(function(){var t=(0,r.Z)(function*(t){let o=yield t;null!=o.data?(e.empImage=o.data[0].FaceImage,e.showImage=!0,e.showImageTable=!1):(e.toast.warning("No Image Found"),e.showImage=!1,e.showImageTable=!1)});return function(e){return t.apply(this,arguments)}}(),e=>{let t={Exception:e.message,id:this.common.getLocalStorage().LoginId,Api:"Enrolled Employee Image"};this.common.saveLog(t,"ApiException")}):this.toast.warning("Please select employee!!!")}OnPageChange(e){const t=e.pageIndex*e.pageSize;let o=t+e.pageSize;o>this.allEmployeesFaceData.length&&(o=this.allEmployeesFaceData.length),this.pageSlice=this.allEmployeesFaceData.slice(t,o)}showAllEmployeeFaceImages(){var e=this;this.ngxuiloader.start(),this.enrollment.getAllEmployeeImage().subscribe(function(){var t=(0,r.Z)(function*(t){let o=yield t;e.ngxuiloader.stop(),null!=o.data&&0!=o.data.length?(e.showImage=!1,e.showImageTable=!0,e.allEmployeesFaceData=o.data,e.pageSlice=e.allEmployeesFaceData.slice(0,5)):(e.showImage=!1,e.showImageTable=!1,e.toast.warning("No data found to display!!!"))});return function(e){return t.apply(this,arguments)}}(),e=>{let t={Exception:e.message,id:this.common.getLocalStorage().LoginId,Api:"All Enrolled Images"};this.common.saveLog(t,"ApiException")})}downloadAllImageExcel(){let e=[];for(let c=0;c<this.allEmployeesFaceData.length;c++)e.push([Number(this.allEmployeesFaceData[c].EmpId),this.allEmployeesFaceData[c].Name,"",this.allEmployeesFaceData[c].ResignStatus,this.allEmployeesFaceData[c].Status]);const t=this.common.getLocalStorage().ClientName,o=e,n=this.datepipe.transform(new Date,"dd/MM/yyyy");let l=new c.Workbook,i=l.addWorksheet("All Employees Face"),a=i.addRow(["All Employees Face Data"]);i.addRow([t]),a.font={name:"Comic Sans MS",family:4,size:16,underline:"double",bold:!0},i.addRow([]),i.addRow(["Date : "+this.datepipe.transform(new Date,"dd MMM yyyy")]),i.addRow([]);let s=i.addRow(["ID","NAME","IMAGE","RESIGN STATUS","STATUS"]);var r;s.font={size:12,bold:!0},s.eachCell((e,t)=>{e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"},bgColor:{argb:"FF0000FF"}},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),o.forEach(e=>{i.addRow(e).eachCell(e=>{e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}),i.getColumn(5).width=20,i.getColumn(1).width=20,i.getColumn(2).width=20,i.getColumn(3).width=30,i.getColumn(4).width=20;for(let c=0;c<this.allEmployeesFaceData.length;c++)i.getRow(c+7).height=120,r=l.addImage({base64:this.allEmployeesFaceData[c].FaceImage,extension:"png"}),i.addImage(r,{tl:{col:2.5,row:c+6.5},ext:{width:120,height:150},editAs:"oneCell"});i.addRow([]);let d=i.addRow(["This is system generated excel sheet."]);d.getCell(1).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFCCFFE5"}},d.getCell(1).border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},i.mergeCells(`A${d.number}:E${d.number}`),l.xlsx.writeBuffer().then(e=>{let t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});g.saveAs(t,"AllEmployeesFaceImages-"+n+".xlsx")})}downloadAllImagePDF(){let e=[];for(let s=0;s<this.allEmployeesFaceData.length;s++)e.push([Number(this.allEmployeesFaceData[s].EmpId),this.allEmployeesFaceData[s].Name,"",this.allEmployeesFaceData[s].ResignStatus,this.allEmployeesFaceData[s].Status]);var t=new m.jsPDF("p","pt","a4");const o=this.datepipe.transform(new Date,"d MMM y, h:mm:ss a"),n=this.datepipe.transform(new Date,"dd/MM/yyyy-h:mm:ss a");var l=t.internal.pageSize.width||t.internal.pageSize.getWidth();t.internal.pageSize.height||t.internal.pageSize.getHeight(),t.setFontSize(10),t.text("EMPLOYEE FACE DATA",l/2,20,{align:"center"}),t.text(this.common.getLocalStorage().ClientName,l/2,30,{align:"center"}),t.text(""+o,l-20,30,{align:"right"}),t.line(20,40,l-20,40);const i=e;let a=0;h()(t,{startY:50,styles:{cellPadding:10,fontSize:10,valign:"middle",halign:"center",minCellHeight:60},theme:"striped",head:[["ID","NAME","IMAGE","RESIGN STATUS","STATUS"]],body:i,margin:{top:20},headStyles:{fillColor:[255,178,155],textColor:[0,0,0],fontSize:11,cellPadding:0},columnStyles:{2:{cellWidth:100}},didDrawCell:e=>{"body"===e.section&&2===e.column.index&&e.row.index>=0&&(t.addImage(this.allEmployeesFaceData[a].FaceImage,"JPEG",e.cell.x+30,e.cell.y+2,60,60),a++)}}),t.save("AllEmployeesFaceImages-"+n+".pdf")}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(y.eN),u.Y36(f.v),u.Y36(b),u.Y36(s.uU),u.Y36(w._W),u.Y36(d.LA))},e.\u0275cmp=u.Xpm({type:e,selectors:[["app-enrollment"]],decls:81,vars:22,consts:[["logoPosition","center-center","logoSize","150","logoUrl","../../../../assets/fingerscanner.gif",3,"loaderId","fgsColor","fgsType"],[3,"fgsColor","fgsType"],[1,"col-sm-12","d-flex","justify-content-center"],[1,"row","mt-3"],["for","input2",1,"col-sm-3","col-form-label"],[2,"color","red"],[1,"col-sm-9"],["autocomplete","off",2,"margin-bottom","-2px"],["type","text","field","EmployeeName","autocomplete","off","value","","emptyMessage","","showEmptyMessage","true","name","fakeusernameremembered",3,"ngModel","suggestions","dropdown","ngModelChange","completeMethod"],["pTemplate","item"],["class","text-danger","style","color: red",4,"ngIf"],[1,"mt-4","p-3"],[3,"justified"],["heading","Fingerprint Enrollment"],[1,"table","table-responsive","col-sm-12","d-flex","justify-content-center","mt-3"],[1,"table-bordered","text-center"],[1,"table-primary"],["scope","row"],[4,"ngIf"],[1,"row","col-sm-12"],[1,"col-sm-5"],["appHeading","","type","button","data-mdb-ripple-color","dark",1,"btn","buttonhover",3,"click"],[1,"col-sm-7"],["appHeading","","type","button","data-mdb-ripple-color","dark",1,"btn","buttonhover",3,"disabled","click"],["fas","","icon","fingerprint","size","lg"],["heading","Face Enrollment"],[1,"col"],["appHeading","","type","button",1,"btn","buttonhover",3,"click"],["class","container col-sm-12 d-flex justify-content-center p-3",4,"ngIf"],["class","container-flex",4,"ngIf"],["heading","Download Drivers"],["appHeading","","mdbBtn","","type","button","href","../../../../assets/DeviceDrivers.zip","data-mdb-ripple-color","dark","download","",1,"buttonhover"],[1,"fas","fa-download","ms-3"],["appHeading","","mdbBtn","","type","button","href","../../../../assets/EnrollmentService.zip","data-mdb-ripple-color","dark","download","",1,"buttonhover"],["appHeading","","mdbBtn","","type","button","href","../../../../assets/EnrollmentExe.zip","data-mdb-ripple-color","dark","download","",1,"buttonhover"],["appHeading","","type","button","mdbBtn","","href","../../../../assets/WebEnrollDocument.pdf","target","_blank","data-mdb-ripple-color","dark",1,"buttonhover","btn-rounded"],[1,"text-danger",2,"color","red"],[1,"fas","fa-circle","fa-3x","red-text"],[1,"fas","fa-circle","fa-3x","green-text"],[1,"container","col-sm-12","d-flex","justify-content-center","p-3"],["width","40%","height","55%",2,"border","2px solid black",3,"src"],[1,"container-flex"],[1,"card","responsive"],[1,"card-body"],[1,"card-title"],["id","content",1,"table-responsive"],["content",""],["id","report",1,"table",2,"text-align","justify"],["scope","col"],[4,"ngFor","ngForOf"],["class","mt-3 p-3","style","text-align:center;font-weight:700;color:red;font-size:24px;",4,"ngIf"],["showFirstLastButtons","",3,"length","pageSize","pageSizeOptions","page"],[1,"btn","btn-outline-primary","card-link",3,"click"],[1,"zoom"],["height","100rem","width","100rem",3,"src"],[1,"mt-3","p-3",2,"text-align","center","font-weight","700","color","red","font-size","24px"]],template:function(e,t){1&e&&(u._UZ(0,"ngx-ui-loader",0),u._UZ(1,"ngx-ui-loader",1),u.TgZ(2,"div"),u.TgZ(3,"div",2),u.TgZ(4,"div",3),u.TgZ(5,"label",4),u._uU(6,"Employee ID"),u.TgZ(7,"sup",5),u._uU(8,"*"),u.qZA(),u.qZA(),u.TgZ(9,"div",6),u.TgZ(10,"form",7),u.TgZ(11,"p-autoComplete",8),u.NdJ("ngModelChange",function(e){return t.empid=e})("completeMethod",function(e){return t.filterEmployees(e)}),u.YNc(12,T,3,2,"ng-template",9),u.qZA(),u.qZA(),u.YNc(13,x,2,0,"small",10),u.qZA(),u.qZA(),u.qZA(),u.TgZ(14,"div",11),u.TgZ(15,"tabset",12),u.TgZ(16,"tab",13),u.TgZ(17,"div",14),u.TgZ(18,"table",15),u.TgZ(19,"tbody"),u.TgZ(20,"tr",16),u.TgZ(21,"th",17),u._uU(22,"Enrollment Service"),u.qZA(),u.YNc(23,I,2,0,"td",18),u.YNc(24,D,2,0,"td",18),u.YNc(25,S,2,0,"td",18),u.YNc(26,U,2,0,"td",18),u.qZA(),u.TgZ(27,"tr",16),u.TgZ(28,"th",17),u._uU(29,"Enrollment Device"),u.qZA(),u.YNc(30,N,2,0,"td",18),u.YNc(31,L,2,0,"td",18),u.YNc(32,q,2,0,"td",18),u.YNc(33,_,2,0,"td",18),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.TgZ(34,"div",19),u.TgZ(35,"div",20),u.TgZ(36,"button",21),u.NdJ("click",function(){return t.getFingerPrintEnrolledUserList()}),u._uU(37," Enrolled User "),u.qZA(),u.TgZ(38,"button",21),u.NdJ("click",function(){return t.getFingerPrintToBeEnrolledUserList()}),u._uU(39," User To Be Enroll "),u.qZA(),u.qZA(),u.TgZ(40,"div",22),u.TgZ(41,"button",23),u.NdJ("click",function(){return t.getFingerEnrolled()}),u._UZ(42,"mdb-icon",24),u._uU(43," To Enroll Fingerprint "),u.qZA(),u.TgZ(44,"button",23),u.NdJ("click",function(){return t.verifyFingerEnrolled()}),u._UZ(45,"mdb-icon",24),u._uU(46," To Verify Fingerprint "),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.TgZ(47,"tab",25),u.TgZ(48,"div",19),u.TgZ(49,"div",26),u.TgZ(50,"button",27),u.NdJ("click",function(){return t.getFaceEnrolledUserList()}),u._uU(51,"Enrolled User"),u.qZA(),u.qZA(),u.TgZ(52,"div",26),u.TgZ(53,"button",27),u.NdJ("click",function(){return t.getFaceToBeEnrolledUserList()}),u._uU(54,"User To Be Enroll"),u.qZA(),u.qZA(),u.TgZ(55,"div",26),u.TgZ(56,"button",27),u.NdJ("click",function(){return t.showSingleEmployeeImageData()}),u._uU(57,"Show Image"),u.qZA(),u.qZA(),u.TgZ(58,"div",26),u.TgZ(59,"button",27),u.NdJ("click",function(){return t.showAllEmployeeFaceImages()}),u._uU(60,"Show All Image Data"),u.qZA(),u.qZA(),u.qZA(),u.YNc(61,R,2,1,"div",28),u.YNc(62,B,28,6,"div",29),u.qZA(),u.TgZ(63,"tab",30),u.TgZ(64,"div",19),u.TgZ(65,"div",26),u.TgZ(66,"a",31),u._uU(67," Device Drivers "),u._UZ(68,"i",32),u.qZA(),u.qZA(),u.TgZ(69,"div",26),u.TgZ(70,"a",33),u._uU(71," Enrollment Service "),u._UZ(72,"i",32),u.qZA(),u.qZA(),u.TgZ(73,"div",26),u.TgZ(74,"a",34),u._uU(75," Enrollment Setup "),u._UZ(76,"i",32),u.qZA(),u.qZA(),u.TgZ(77,"div",26),u.TgZ(78,"a",35),u._uU(79," Web Enroll Document "),u._UZ(80,"i",32),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA()),2&e&&(u.Q6J("loaderId","loader-01")("fgsColor","white")("fgsType",t.spinner.rectangleBouncePulseOut),u.xp6(1),u.Q6J("fgsColor","white")("fgsType",t.spinner.rectangleBouncePulseOut),u.xp6(10),u.Q6J("ngModel",t.empid)("suggestions",t.filteredEmployees)("dropdown",!0),u.xp6(2),u.Q6J("ngIf",t.iderror),u.xp6(2),u.Q6J("justified",!0),u.xp6(8),u.Q6J("ngIf",t.isServiceNotConnected),u.xp6(1),u.Q6J("ngIf",t.isServiceConnected),u.xp6(1),u.Q6J("ngIf",t.isServiceNotConnected),u.xp6(1),u.Q6J("ngIf",t.isServiceConnected),u.xp6(4),u.Q6J("ngIf",t.isDeviceNotConnected),u.xp6(1),u.Q6J("ngIf",t.isDeviceConnected),u.xp6(1),u.Q6J("ngIf",t.isDeviceNotConnected),u.xp6(1),u.Q6J("ngIf",t.isDeviceConnected),u.xp6(8),u.Q6J("disabled",t.isServiceNotConnected||t.isDeviceNotConnected),u.xp6(3),u.Q6J("disabled",t.isServiceNotConnected||t.isDeviceNotConnected),u.xp6(17),u.Q6J("ngIf",t.showImage),u.xp6(1),u.Q6J("ngIf",t.showImageTable))},directives:[d.Jj,i._Y,i.JL,i.F,Z.Qc,i.JJ,i.On,F.jx,s.O5,v.AH,v.wW,C.d,a.Ui,a.XI,a.mT,s.sg,A.NW],styles:[".zoom[_ngcontent-%COMP%]:hover{transform:scale(2)}[_nghost-%COMP%]     .p-autoComplete{width:20vw}@media screen and (max-width:640px){[_nghost-%COMP%]     .p-autoComplete{width:15rem}}"]}),e})();var P=o(68003);const Q=[{path:"",component:J}];let Y=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({imports:[[P.Bz.forChild(Q)],P.Bz]}),e})();var j=o(97388),O=o(27853),W=o(82151),H=o(87064);o(26136),o(55959),o(87570),o(31906),o(87254),o(40878),o(81110),o(99713),o(56238),o(98720),o(25416),o(19861),o(93169),o(99235),o(94720),o(10083);let G=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({imports:[[s.ez,H.BQ,W.eL,H.si,O.Q8,j.rt],H.BQ]}),e})(),$=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({providers:[s.uU],imports:[[s.ez,Y,i.u5,i.UX,d.Js,d.Cz.forRoot({showForeground:!0}),Z.WN,A.TU,G,a.Fq,a.U$,l.N6,v.P4,a.pc,n.o]]}),e})()}}]);